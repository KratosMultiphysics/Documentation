<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: /home/runner/work/Documentation/Documentation/master/kratos/utilities/cutting_utility.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_8fc3e8efef0bfca4a113d719cbd52afb.html">kratos</a></li><li class="navelem"><a class="el" href="../../dir_70f98bb657cca0a872199855cac08757.html">utilities</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cutting_utility.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d0/dca/cutting__utility_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//    |  /           |</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//    &#39; /   __| _` | __|  _ \   __|</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//    . \  |   (   | |   (   |\__ `</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//   _|\_\_|  \__,_|\__|\___/ ____/</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//                   Multi-Physics</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  License:         BSD License</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//                   Kratos default license: kratos/license.txt</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  Main authors:    Pablo Becker</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#if !defined(KRATOS_CUTTING_UTILITY)</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#define  KRATOS_CUTTING_UTILITY</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// System includes</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// External includes</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/matrix.hpp&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/vector.hpp&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/banded.hpp&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/matrix_sparse.hpp&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/triangular.hpp&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/operation.hpp&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;boost/numeric/ublas/lu.hpp&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">// Project includes</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d67/define_8h.html">includes/define.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dfe/model__part_8h.html">includes/model_part.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d77/node_8h.html">includes/node.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4e/dof_8h.html">includes/dof.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dca/variables_8h.html">includes/variables.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d36/array__1d_8h.html">containers/array_1d.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d68/find__nodal__neighbours__process_8h.html">processes/find_nodal_neighbours_process.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d1/d82/data__value__container_8h.html">containers/data_value_container.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d3b/mesh_8h.html">includes/mesh.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d88/math__utils_8h.html">utilities/math_utils.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d9c/split__tetrahedra_8h.html">utilities/split_tetrahedra.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d98/split__triangle_8h.html">utilities/split_triangle.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d60/tetrahedra__3d__4_8h.html">geometries/tetrahedra_3d_4.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/def/triangle__3d__3_8h.html">geometries/triangle_3d_3.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d8f/spatial__containers_8h.html">spatial_containers/spatial_containers.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../db/d66/namespace_kratos.html">Kratos</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html">   64</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html">CuttingUtility</a></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#af009a5be666de3241b197c06147f5325">   70</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ModelPart::NodesContainerType</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#af009a5be666de3241b197c06147f5325">NodesArrayType</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a2997cfd145fb42404e1e702e73905af1">   71</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ModelPart::ElementsContainerType</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a2997cfd145fb42404e1e702e73905af1">ElementsArrayType</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ae702a809d1ba6c372ccb92a88b1eae75">   72</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ModelPart::ConditionsContainerType</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ae702a809d1ba6c372ccb92a88b1eae75">ConditionsArrayType</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aa6e22c293cab9352e29e183f77edd00f">   73</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;Matrix&gt;</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aa6e22c293cab9352e29e183f77edd00f">Matrix_Order_Tensor</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a37eec2b4afd1c280e3a083bbcdcc91f6">   74</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;Vector&gt;</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a37eec2b4afd1c280e3a083bbcdcc91f6">Vector_Order_Tensor</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ae467622309d1a5f21b3f3a54cc578dcd">   75</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;Vector_Order_Tensor&gt;</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ae467622309d1a5f21b3f3a54cc578dcd">Node_Vector_Order_Tensor</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aab0deaa5ff9d4ef1030b5e54bc0c7751">   76</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d5/ddd/class_kratos_1_1_node.html">Node</a> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aab0deaa5ff9d4ef1030b5e54bc0c7751">PointType</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a9134a3aa07de85cffdd62e013af0d82b">   77</a></span>&#160;    <span class="keyword">typedef</span> Node ::Pointer <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a9134a3aa07de85cffdd62e013af0d82b">PointPointerType</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a3e644ccf46ee827297df6ce8bb154a63">   78</a></span>&#160;    <span class="keyword">typedef</span> std::vector&lt;PointType::Pointer&gt; <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a3e644ccf46ee827297df6ce8bb154a63">PointVector</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a169ad45f5d77ad140b472edcb97ee86b">   79</a></span>&#160;    <span class="keyword">typedef</span> PointVector::iterator <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a169ad45f5d77ad140b472edcb97ee86b">PointIterator</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#abb1b29de11524409976338d911de57ab">   86</a></span>&#160;    <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#abb1b29de11524409976338d911de57ab">CuttingUtility</a>()</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        smallest_edge=1.0;   <span class="comment">//</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab44ab0370e5e7eb7b7c9199ee89b11e6">   92</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab44ab0370e5e7eb7b7c9199ee89b11e6">~CuttingUtility</a>() {}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a4f7af69f59bc4f6a25e03ea6deff65b5">  100</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a4f7af69f59bc4f6a25e03ea6deff65b5">FindSmallestEdge</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_model_part)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part = mr_model_part;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ElementsArrayType</a>&amp; rElements = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_begin = rElements.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_end = rElements.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">double</span> dist_node_neigh;             <span class="comment">//distance between the two nodes of the edge</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> node_coord;             <span class="comment">//</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> neigh_coord;             <span class="comment">//</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        smallest_edge = 1000000000000000000000000000.0; <span class="comment">//maybe the mesh is huge, setting a big number just in case</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it = it_begin; it != it_end; ++it) <span class="comment">//looping all the elements</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//geometry of the element</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)  <span class="comment">//edge i</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                node_coord[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                node_coord[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                node_coord[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)  <span class="comment">//edge i</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    neigh_coord[0] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].X();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    neigh_coord[1] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].Y();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    neigh_coord[2] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].Z();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    dist_node_neigh = sqrt( pow((node_coord[0]- neigh_coord[0]),2) + pow((node_coord[1]- neigh_coord[1]),2) + pow((node_coord[2]- neigh_coord[2]),2) ) ; <span class="comment">// distance between node and neighbour</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    <span class="keywordflow">if</span> ((dist_node_neigh&lt;smallest_edge) &amp;&amp; (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>!=<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>)) smallest_edge=dist_node_neigh; <span class="comment">//saving the smallest found up to now</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                }<span class="comment">//closing j loop</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            } <span class="comment">//closing i loop</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        } <span class="comment">//closing element loop</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(smallest_edge);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    } <span class="comment">//closing function</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a3fa3c0298a7c6c0e9ccad84665f97774">  144</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a3fa3c0298a7c6c0e9ccad84665f97774">GenerateCut</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_new_model_part, <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; versor, <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; Xp, <span class="keywordtype">int</span> plane_number ,<span class="keywordtype">double</span> tolerance_factor)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Generating Cutting plane with the following data:&quot;</span>)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(versor);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(Xp);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (!mr_new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>().<a class="code" href="../../dd/d77/class_kratos_1_1_variables_list.html#ad3ac4ea69689c41239ff2af18d9f2653">Has</a>(FATHER_NODES) ||</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            !mr_new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>().<a class="code" href="../../dd/d77/class_kratos_1_1_variables_list.html#ad3ac4ea69689c41239ff2af18d9f2653">Has</a>(WEIGHT_FATHER_NODES) )</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a> &lt;&lt; <span class="stringliteral">&quot;The cut model part was not initialized. &quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                            <span class="stringliteral">&quot;Please call AddVariablesToCutModelPart before GenerateCut.&quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;array_1d&lt;int, 2 &gt;</a> &gt; Position_Node;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a> List_New_Nodes;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        boost::numeric::ublas::compressed_matrix&lt;int&gt; Coord;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part = mr_model_part;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part = mr_new_model_part;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a>  Elems_In_Plane( this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>().size());          <span class="comment">//our (int) vector, where we write 1 when the element is cut by the cutting plane. when it is 2, it means we have 2 triangles (4 cutting points)</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">int</span> number_of_triangles = 0;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">double</span> tolerance = tolerance_factor*smallest_edge; <span class="comment">//if Find_Smallest_Edge is not run , then the tolerance is absolute</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">//finished creating the variables and vector/matrix needed. now we have to call the subroutines.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a833343517767f4ff9ad2070136f902c7">CSR_Row_Matrix_Mod</a>(this_model_part, Coord);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a701c71c3e815b0f8ef705becd6e113a3">FirstLoop</a>(this_model_part, Coord, versor, Xp, number_of_triangles, Elems_In_Plane, tolerance);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a77a8db1b1d775ffc7503f4d066a14ff0">Create_List_Of_New_Nodes_Mod</a>(this_model_part,  new_model_part, Coord, List_New_Nodes, Position_Node);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a039aae249bcea2925fdf26817a81d38f">Calculate_Coordinate_And_Insert_New_Nodes_Mod</a>(this_model_part, new_model_part, Position_Node, List_New_Nodes, versor, Xp, tolerance);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab247746453cd2ee99b87ef3b9b21d9e4">GenerateElements</a> (this_model_part, new_model_part, Elems_In_Plane, Coord, versor, plane_number);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Finished generating cutting plane&quot;</span>)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aea1e4b5af4e47156f294da3a11af3517">  196</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aea1e4b5af4e47156f294da3a11af3517">AddSkinConditions</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_new_model_part, <span class="keywordtype">int</span> plane_number )</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part = mr_model_part;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> it_begin_node_old = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().ptr_begin();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part = mr_new_model_part;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        std::cout &lt;&lt;<span class="stringliteral">&quot;Adding Skin Conditions to the new model part, added in layer:&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(plane_number)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a>  Condition_Nodes( this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size());          <span class="comment">//our (int) vector, where we write -1 when the node is part of the condition faces</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordtype">int</span> number_of_triangles = 0; <span class="comment">//we set it to zero to start</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordtype">int</span> number_of_nodes = 0; <span class="comment">//same as above</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordtype">int</span> number_of_previous_nodes = 0; <span class="comment">// nodes from the previous conditions (planes) created</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordtype">int</span> number_of_conditions = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">if</span> (!new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>().<a class="code" href="../../dd/d77/class_kratos_1_1_variables_list.html#ad3ac4ea69689c41239ff2af18d9f2653">Has</a>(FATHER_NODES) ||</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            !new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>().<a class="code" href="../../dd/d77/class_kratos_1_1_variables_list.html#ad3ac4ea69689c41239ff2af18d9f2653">Has</a>(WEIGHT_FATHER_NODES) )</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <a class="code" href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a> &lt;&lt; <span class="stringliteral">&quot;The cut model part was not initialized. &quot;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            <span class="stringliteral">&quot;Please call AddVariablesToCutModelPart before AddSkinConditions.&quot;</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                         &lt;&lt; std::endl;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ConditionsArrayType</a>&amp; rConditions = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ConditionsArrayType::iterator</a> cond_it_begin = rConditions.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ConditionsArrayType::iterator</a> cond_it_end = rConditions.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ConditionsArrayType</a>&amp; rConditions_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ConditionsArrayType::iterator</a> cond_it_end_new = rConditions_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ConditionsArrayType::iterator</a> cond_it_begin_new = rConditions_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        number_of_conditions = cond_it_end - cond_it_begin;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size()!=0)  <span class="comment">//it means this is not the first plane that has to be created</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">NodesArrayType</a>&amp; rNodes_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();        <span class="comment">//i need the model part just to check the id of the new nodes.</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> it_end_node_new = rNodes_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> it_begin_node_new = rNodes_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            number_of_previous_nodes=(it_end_node_new-it_begin_node_new);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            number_of_triangles=cond_it_end_new - cond_it_begin_new ;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;           <span class="comment">// KRATOS_WATCH(number_of_triangles)</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">//KRATOS_WATCH(number_of_previous_nodes)</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">//KRATOS_CATCH(&quot;&quot;)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">else</span> <span class="comment">//nothing. number of triangles and nodes already set to 0</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            std::cout &lt;&lt;<span class="stringliteral">&quot;First Cutting Plane&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">if</span> (number_of_conditions!=0)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0 ; index != this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size() ; ++index) Condition_Nodes[index]=0; <span class="comment">//initializing in zero the whole vector (meaning no useful nodes for the condition layer)</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ModelPart::ConditionsContainerType::iterator</a> i_condition = rConditions.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#aaba01bc27b154ddfb13c4875a1ee2cfb">begin</a>() ; i_condition != rConditions.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#acc410959c998f861779d4e180822b78b">end</a>() ; i_condition++)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = i_condition-&gt;GetGeometry();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; i_condition-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <span class="comment">//int position = (geom[i].Id()) - 1; //the id of the node minus one is the position in the Condition_Node array (position0 = node1)</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    <span class="keywordtype">int</span> position = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Id()) - it_begin_node_old; <span class="comment">//probably there-s a better way to do this, i only need the position in the array, (not the ID)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                    Condition_Nodes[position] =  -1 ; <span class="comment">//a -1 means we need this node!</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }<span class="comment">//done. now we know all the nodes that will have to be added to the new model part.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="comment">//we loop all the nodes in the old model part and copy the ones used by conditions to the new model part:</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0 ; index != this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size() ; ++index)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">if</span> (Condition_Nodes[index]==-1)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    ++number_of_nodes; <span class="comment">//one new node!</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    Condition_Nodes[index] = number_of_nodes + number_of_previous_nodes; <span class="comment">//we give this node consecutives ids. now we create the new node</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ModelPart::NodesContainerType::iterator</a> it_node = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().begin()+index;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    Node ::Pointer pnode = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">CreateNewNode</a>(number_of_nodes+number_of_previous_nodes, it_node-&gt;X(), it_node-&gt;Y(), it_node-&gt;Z());  <span class="comment">//recordar que es el nueevo model part!!</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    pnode-&gt;SetBufferSize(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>()-&gt;GetBufferSize());</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    pnode-&gt;GetValue(FATHER_NODES).resize(0);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node.base() ) );       <span class="comment">// we keep the same size despite we only need one. to have everyhing with the same size</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node.base() ) );</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    pnode-&gt; <a class="code" href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">GetValue</a>(WEIGHT_FATHER_NODES) = 1.0;  <span class="comment">//since both father node 1 and 2 are the same, any value between 0 and one would be ok.</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    pnode-&gt;X0() = it_node-&gt;X0();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    pnode-&gt;Y0() = it_node-&gt;Y0();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    pnode-&gt;Z0() = it_node-&gt;Z0();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }<span class="comment">//finished the list of nodes to be added.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="comment">//now to the conditions!</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a>  triangle_nodes(3); <span class="comment">//here we&#39;ll save the nodes&#39; ids with the new node names</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html">Condition</a> <span class="keyword">const</span>&amp; rReferenceCondition = <a class="code" href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">KratosComponents&lt;Condition&gt;::Get</a>(<span class="stringliteral">&quot;SurfaceCondition3D3N&quot;</span>);         <span class="comment">//condition type</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            Properties::Pointer properties = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">GetMesh</a>().<a class="code" href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">pGetProperties</a>(plane_number);        <span class="comment">//this will allow us later to turn this layer on/off in GID</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ModelPart::ConditionsContainerType::iterator</a> i_condition = rConditions.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#aaba01bc27b154ddfb13c4875a1ee2cfb">begin</a>() ; i_condition != rConditions.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#acc410959c998f861779d4e180822b78b">end</a>() ; i_condition++) <span class="comment">//looping all the conditions</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = i_condition-&gt;GetGeometry(); <span class="comment">//current condition(nodes, etc)</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; i_condition-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)         <span class="comment">//looping the nodes</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    <span class="keywordtype">int</span> position = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Id()) - it_begin_node_old;  <span class="comment">//the id of the node minus one is the position in the Condition_Node array (position0 = node1)</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    triangle_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]=Condition_Nodes[position]; <span class="comment">// saving the i nodeId</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                } <span class="comment">//nodes id saved. now we have to create the element.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geometry(</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(triangle_nodes[0]),  <span class="comment">//condition to be added</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(triangle_nodes[1]),</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(triangle_nodes[2])</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                );</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1, geometry, properties); <span class="comment">//está bien? acá la verdad ni idea. sobre todo number_of_triangles (la posición). o debe ser un puntero de elemento en vez de un entero?</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                ++number_of_triangles;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Finished copying conditions surfaces&quot;</span>)</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a9465720710034d7e9dde1f541c535cb3">  312</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a9465720710034d7e9dde1f541c535cb3">AddVariablesToCutModelPart</a>(</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; rNewModelPart)<span class="keyword"> const</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        rNewModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>() = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        rNewModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(FATHER_NODES);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        rNewModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(WEIGHT_FATHER_NODES);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">//LIST OF SUBROUTINES</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a833343517767f4ff9ad2070136f902c7">  329</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a833343517767f4ff9ad2070136f902c7">CSR_Row_Matrix_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, boost::numeric::ublas::compressed_matrix&lt;int&gt;&amp; Coord)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">NodesArrayType</a>&amp; pNodes = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        Coord.resize(pNodes.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a510c92d5ebe9a4beeb063269530ef31a">size</a>(), pNodes.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a510c92d5ebe9a4beeb063269530ef31a">size</a>());</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> i_begin = pNodes.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> i_end = pNodes.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        std::vector&lt;unsigned int&gt; aux(10000);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = i_begin; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> != i_end; ++<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordtype">int</span> index_i = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>-&gt;Id() - 1;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">GlobalPointersVector&lt; Node &gt;</a>&amp; neighb_nodes = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            Coord.push_back(index_i, index_i, -1);        <span class="comment">//only modification added, now the diagonal is filled with -1 too.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a> = 0;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a04db5b3969fe3a11463c561a3cae856a">GlobalPointersVector&lt; Node &gt;::iterator</a> inode = neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a599125ad0e25d62480de5e84477b5f20">begin</a>();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    inode != neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#aecf3bbe94f6105274d86e19e7bbe3631">end</a>(); inode++)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordtype">int</span> index_j = inode-&gt;Id() - 1;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">if</span> (index_j &gt; index_i)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    aux[<a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>] = index_j;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>++;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            std::sort(aux.begin(), aux.begin() + <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                Coord.push_back(index_i, aux[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>], -1);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">//************************************************************************************************</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a701c71c3e815b0f8ef705becd6e113a3">  367</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a701c71c3e815b0f8ef705becd6e113a3">FirstLoop</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, boost::numeric::ublas::compressed_matrix&lt;int&gt;&amp; Coord, <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; versor, <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; Xp,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                   <span class="keywordtype">int</span> number_of_triangles, <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a>&amp;  Elems_In_Plane, <span class="keywordtype">double</span> tolerance)<span class="comment">//</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">//Xp is a random point that belongs to the cutting plane</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">//versor is a vector normal to the plane</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ElementsArrayType</a>&amp; rElements = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_begin = rElements.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_end = rElements.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordtype">double</span> dist_node_point;          <span class="comment">// node to closest point in the plane</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordtype">double</span> dist_neigh_point;        <span class="comment">//other node of the edge (neighbour) to closest point in the plane</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">//double dist_node_neigh;             //distance between the two nodes of the edge</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_dist;               <span class="comment">//aux segment</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> node_coord;             <span class="comment">//</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> neigh_coord;             <span class="comment">//</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;unsigned int, 4 &gt;</a> list_matching_nodes;             <span class="comment">// used to save the new nodes that match exactly old nodes  (very unlikely, but might be 4 for very plane elements)</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> exact_nodes=0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        number_of_triangles =  0;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordtype">int</span> current_element= 0; <span class="comment">//current element. it&#39;s a position. NOT ID!</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordtype">int</span> number_of_cuts= 0; <span class="comment">//this is the counter explained in the following lines</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it = it_begin; it != it_end; ++it) <span class="comment">//looping all the elements</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            ++current_element;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            number_of_cuts = 0 ;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            exact_nodes = 0 ;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//geometry of the element</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <span class="comment">//when we have a triangle inside a thetraedra, its edges (or nodes) must be cut 3 times by the plane. if we loop all 2 times we can have a counter. when it&#39;s = 6 then we have a triangle. when tetraedras are cutted 8 times then we have 2 triangles (or a cuatrilateral, the same)</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                node_coord[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                node_coord[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                node_coord[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) = node_coord;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) -= Xp;             <span class="comment">//temp_dist =node_coord-Xpoint</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                dist_node_point = <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_dist,versor);     <span class="comment">// dist = (xnode-xp)*versor closest point-plane distance</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)          <span class="comment">//  looping on the neighbours</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> != <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>)  <span class="comment">//(cant link node with itself)</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        neigh_coord[0] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].X();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        neigh_coord[1] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].Y();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        neigh_coord[2] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].Z();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) = neigh_coord;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) -= Xp;             <span class="comment">//temp_dist =node_coord-Xpoint</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        dist_neigh_point = <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_dist,versor);     <span class="comment">// dist = (xnode-xp)*versor closest point-plane distance</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="comment">//        dist_node_neigh = sqrt( pow((node_coord[0]- neigh_coord[0]),2) + pow((node_coord[1]- neigh_coord[1]),2) + pow((node_coord[2]- neigh_coord[2]),2) ); // looks ugly, doesn&#39;t it? it&#39;s supposed to calculate the distance</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                        <span class="comment">//now that we have the two points of the edge defined we can check whether it is cut by the plane or not</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        <span class="keywordtype">bool</span> isovernode=<span class="keyword">false</span>;   <span class="comment">// if true, then it can&#39;t be between the nodes</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        <span class="keywordflow">if</span> (fabs(dist_node_point) &lt; (tolerance)) <span class="comment">//then our node is part of the plane (this should have been done before the loop on neighbours, but this way it is easier to read .</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() -1 ; <span class="comment">// i node id</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                            Coord(index_i, index_i) = -2;                 <span class="comment">//saving a -2 in the diagonal</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                            isovernode=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            number_of_cuts += 2; <span class="comment">//since its neighbour wont take this case as a cut, we must save 2 cuts instead of one. (to reach number_of_cuts=6),</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                            ++exact_nodes;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                            list_matching_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]= geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        <span class="comment">//check this last condition, used to avoid talking points that belong to other node. might cause some problems when the plane is almost paralel to an edge. to be improved! (it seems to be working correcly even when the edge is part of the plane.)</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <span class="keywordflow">if</span> ((dist_node_point*dist_neigh_point) &lt; 0.0 &amp;&amp; isovernode==<span class="keyword">false</span> &amp;&amp; (fabs(dist_neigh_point)&gt;(tolerance))) <span class="comment">// this means one is on top of the plane and the other on the bottom, no need to do more checks, it&#39;s in between!</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                        {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//j node id</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                            <span class="keywordflow">if</span> (index_j &gt; index_i)  Coord(index_i, index_j) = -2;    <span class="comment">//saving a -2 in the upper side of the matrix</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                            <span class="keywordflow">else</span> Coord(index_j, index_i) = -2;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                            number_of_cuts += 1;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    } <span class="comment">//closing the i!=j if</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                } <span class="comment">//closing the neighbour loop</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            } <span class="comment">//closing the nodes loop</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <span class="comment">//now we have to save the data. we should get a list with the elements that will genereate triangles and the total number of triangles</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            Elems_In_Plane[current_element-1] = 0 ; <span class="comment">//we initialize as 0</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">if</span> (exact_nodes!=3)   <span class="comment">//this means at least one new node has to be generated</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">if</span> (number_of_cuts == 6)     <span class="comment">//it can be 8, in that case we have 2 triangles (the cut generates a square)</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    number_of_triangles +=1;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    Elems_In_Plane[current_element-1] = 1 ; <span class="comment">//i still don&#39;t know the number of the node so i&#39;ll have to do another loop later to assign to define node id&#39;s of each triangular element</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (number_of_cuts == 8 ) <span class="comment">// 2 triangles in the element!</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    number_of_triangles +=2;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                    Elems_In_Plane[ current_element-1] = 2 ;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">else</span>   <span class="comment">//ok, now we&#39;ll only add the element if the normal of the plane matches the one of the triangle (created poiting towards the fourth node of the tetraedra)</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <span class="keywordtype">bool</span> found_fourth_node=<span class="keyword">true</span>; <span class="comment">//this is the node that defines the normal of the element</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                {</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    found_fourth_node=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> aux_index=0; aux_index!=4; ++aux_index)  <span class="comment">// we define our plane now</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        <span class="keywordflow">if</span> (geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Id()==list_matching_nodes[aux_index] &amp;&amp; list_matching_nodes[aux_index]!=0)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                            found_fourth_node=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                            <span class="comment">//break;   //ok, we have the coordinates of the new node. now we have to mame sure</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <span class="keywordflow">if</span> (found_fourth_node==<span class="keyword">true</span>)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        node_coord[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        node_coord[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        node_coord[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="comment">//now we check if the point has a positive distance to the plane. if true we will add a new triangle (property of the element). otherwise not</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="comment">//not that this means that this triangle should be added by the neighbour tetraedra( which would return a positive distance)</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="comment">//so if we&#39;re in a boundary of the domain, make sure that the (normal of) the cutting plane points towards the model. otherwise you&#39;ll have missing triangles</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) = node_coord;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) -= Xp;             <span class="comment">//temp_dist =node_coord-Xpoint</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                dist_node_point = <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_dist,versor);     <span class="comment">// dist = (xnode-xp)*versor closest point-plane distance</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <span class="keywordflow">if</span>  (dist_node_point&gt;=0.0)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    <span class="keywordflow">if</span> (number_of_cuts == 6)    <span class="comment">//this should not be necessary, but it&#39;s kept just in case (almost plain elements?)</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        number_of_triangles +=1;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        Elems_In_Plane[current_element-1] = 1 ;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (number_of_cuts == 8 )</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                    {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                        number_of_triangles +=2;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                        Elems_In_Plane[ current_element-1] = 2 ;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        } <span class="comment">//closing the elem loop</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_triangles);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    } <span class="comment">//closing &quot;FirstLoop&quot;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a77a8db1b1d775ffc7503f4d066a14ff0">  510</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a77a8db1b1d775ffc7503f4d066a14ff0">Create_List_Of_New_Nodes_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, boost::numeric::ublas::compressed_matrix&lt;int&gt;&amp; Coord, <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a> &amp;List_New_Nodes,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                      <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector</a>&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 2 &gt;</a> &gt;&amp; Position_Node) <span class="comment">//plane number = 1 -- inf (but the first one should be always one!</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> number_of_new_nodes = 0;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">//NodesArrayType&amp; pNodes = this_model_part.Nodes();</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keyword">typedef</span> boost::numeric::ublas::compressed_matrix&lt;int&gt;::iterator1 i1_t;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keyword">typedef</span> boost::numeric::ublas::compressed_matrix&lt;int&gt;::iterator2 i2_t;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">for</span> (i1_t i1 = Coord.begin1(); i1 != Coord.end1(); ++i1)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">for</span> (i2_t i2 = i1.begin(); i2 != i1.end(); ++i2)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordflow">if</span> (Coord(i2.index1(), i2.index2()) == -2)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    number_of_new_nodes++;                          <span class="comment">//this should work without any change</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        List_New_Nodes.<a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(number_of_new_nodes);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="comment">//int total_node = pNodes.size();</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span> (new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size()!=0)  <span class="comment">//it means this is not the first plane that has to be created</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">NodesArrayType</a>&amp; rNodes_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();        <span class="comment">//i need the model part just to check the id of the new nodes.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> it_end_node_new = rNodes_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">NodesArrayType::iterator</a> it_begin_node_new = rNodes_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            List_New_Nodes[0]=(it_end_node_new-it_begin_node_new)+1;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;New Cutting Plane&quot;</span>)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            first_cutting_plane = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">if</span> (List_New_Nodes.size() &gt; 0)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                List_New_Nodes[0]=1;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Plane&quot;</span>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                first_cutting_plane = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 1; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; number_of_new_nodes; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            List_New_Nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = List_New_Nodes[0] + <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;      <span class="comment">//just a list. necessary because other cutting planes might have been generated before</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        Position_Node.resize(number_of_new_nodes);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">for</span> (i1_t i1 = Coord.begin1(); i1 != Coord.end1(); ++i1)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">for</span> (i2_t i2 = i1.begin(); i2 != i1.end(); ++i2)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                <span class="keywordflow">if</span> (Coord(i2.index1(), i2.index2()) == -2)</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    Coord(i2.index1(), i2.index2()) = List_New_Nodes[index];</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                    Position_Node[index][0] = i2.index1() + 1;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    Position_Node[index][1] = i2.index2() + 1;                     <span class="comment">//in the diagonal terms both indexes should point to the same node but still should work i guess</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    index++;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a039aae249bcea2925fdf26817a81d38f">  579</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a039aae249bcea2925fdf26817a81d38f">Calculate_Coordinate_And_Insert_New_Nodes_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector</a>&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 2 &gt;</a> &gt;&amp; Position_Node,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a> &amp;List_New_Nodes,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; versor, <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; Xp, <span class="keywordtype">double</span> tolerance)<span class="comment">//,</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_1;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_2;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_dist;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Xp_1;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Xp_2;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> intersection;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordtype">double</span> dist_node_point;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">//        double dist_node_neigh;</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="comment">//double dist_neigh_point;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">double</span> dist_node_intersect;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordtype">double</span> weight;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt; array_1d&lt;double, 3 &gt;</a> &gt; Coordinate_New_Node;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        Coordinate_New_Node.<a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(Position_Node.size());</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">//unsigned int step_data_size = this_model_part.GetNodalSolutionStepDataSize();</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">//Node ::DofsContainerType&amp; reference_dofs = (this_model_part.NodesBegin())-&gt;GetDofs();</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; Position_Node.size(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++) <span class="comment">//looping the new nodes</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; node_i = Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; node_j = Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keyword">auto</span> it_node1 = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(node_i);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="comment">//std::size_t pos1 = it_node1 - this_model_part.NodesBegin();</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(Coord_Node_1) = it_node1-&gt;Coordinates();</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keyword">auto</span> it_node2 = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(node_j);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="comment">//std::size_t pos2 = it_node2 - this_model_part.NodesBegin();</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(Coord_Node_2) = it_node2-&gt;Coordinates();</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="comment">//ok, now we have both coordinates. now we must define a weight coefficient based on the distance.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="comment">//this coeff will be =node_plane_distance/node_neigh_distance (linear interpolation)</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) = Coord_Node_1;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_dist) -= Xp;             <span class="comment">//temp_dist =node_coord-Xpoint</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            dist_node_point = <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_dist,versor);     <span class="comment">// dist = (xnode-xp)*versor closest point-plane distance</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            dist_node_point = fabs (dist_node_point);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            Xp_1 = Xp - Coord_Node_1;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            Xp_2 = Coord_Node_2 - Coord_Node_1;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            dist_node_intersect = (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(versor,Xp_1)) / (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(versor,Xp_2)) ; <span class="comment">//line-plane interesection, this is a RELATIVE distance. ====&gt;   point= Node1 + (Node2-Node1)*dist_node_intersect</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">//            dist_node_neigh = sqrt( pow((Coord_Node_1[0]- Coord_Node_2[0]),2) + pow((Coord_Node_1[1]- Coord_Node_2[1]),2) + pow((Coord_Node_1[2]- Coord_Node_2[2]),2) ) ; // distance between node and neighbour</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">if</span> (dist_node_point&lt;=(tolerance))  dist_node_intersect=0.0;  <span class="comment">// if it&#39;s too close to the first node then we just set the weight as 1</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            weight = (1.0 - dist_node_intersect) ;  <span class="comment">// dist_node_neigh;</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="comment">//weight = dist_node_point / dist_node_neigh ; MAL!</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="comment">//noalias(Weight_New_Nodes[i]) = weight;</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">if</span> (weight &gt; 1.05) <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;**** something&#39;s wrong! weight higher than 1! ****&quot;</span>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="comment">//KRATOS_WATCH(i); KRATOS_WATCH(weight);</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0; index!=3; ++index) <span class="comment">//we loop the 3 coordinates)</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="keywordflow">if</span> (Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0]!=Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1])</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                    Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][index] = Coord_Node_1[index] + (dist_node_intersect) * (Coord_Node_2[index] - Coord_Node_1[index]);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][index] = Coord_Node_1[index]; <span class="comment">//when both nodes are the same it doesnt make any sense to interpolate</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            temp_dist= Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] - Xp;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            dist_node_point = <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(versor,temp_dist);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            Node ::Pointer pnode = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">CreateNewNode</a>(List_New_Nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2]);  <span class="comment">//recordar que es el nueevo model part!!</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            pnode-&gt;SetBufferSize(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>()-&gt;GetBufferSize());</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="comment">//it_node1 = this_model_part.NodesBegin() + pos1;</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="comment">//it_node2 = this_model_part.NodesBegin() + pos2;</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            pnode-&gt;GetValue(FATHER_NODES).resize(0);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( it_node1 ) );       <span class="comment">//saving data about fathers in the model part</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( it_node2 ) );</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            pnode-&gt; <a class="code" href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">GetValue</a>(WEIGHT_FATHER_NODES) = weight;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            pnode-&gt;X0() = weight * (it_node1-&gt;X0())  +  (1.0 - weight) * it_node2-&gt;X0();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            pnode-&gt;Y0() = weight * (it_node1-&gt;Y0())  +  (1.0 - weight) * it_node2-&gt;Y0();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            pnode-&gt;Z0() = weight * (it_node1-&gt;Z0())  +  (1.0 - weight) * it_node2-&gt;Z0();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab247746453cd2ee99b87ef3b9b21d9e4">  659</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab247746453cd2ee99b87ef3b9b21d9e4">GenerateElements</a> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">DenseVector&lt;int&gt;</a> Elems_In_Plane, boost::numeric::ublas::compressed_matrix&lt;int&gt;&amp; Coord, <span class="keyword">const</span> <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a>&amp; versor, <span class="keywordtype">int</span> plane_number)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector1;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector2;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector3;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector4;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector5;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 6 &gt;</a> nodes_for_2triang; <span class="comment">//to be used when there are 2 triangles</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordtype">double</span> dist2; <span class="comment">//to be used when there are 2 triangles in the tetraedra</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordtype">double</span> dist3;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../dd/d7b/namespacecontrol.html">control</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> temp_int;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> first_element=0;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ElementsArrayType</a>&amp; rElements_old = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_begin_old = rElements_old.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_end_old = rElements_old.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">ElementsArrayType</a>&amp; rElements_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_begin_new = rElements_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">ptr_begin</a>();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it_end_new = rElements_new.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">ptr_end</a>();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="keywordflow">if</span> (first_cutting_plane == <span class="keyword">false</span>)  <span class="comment">//it means this is not the first plane that has to be created</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            first_element=(it_end_new-it_begin_new);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;New Cutting Plane&quot;</span>)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(first_element)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            first_element=0;                      <span class="comment">//or we&#39;re creating the first elements of the model part</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Plane&quot;</span>);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html">Condition</a> <span class="keyword">const</span>&amp; rReferenceCondition = <a class="code" href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">KratosComponents&lt;Condition&gt;::Get</a>(<span class="stringliteral">&quot;SurfaceCondition3D3N&quot;</span>);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        Properties::Pointer properties = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">GetMesh</a>().<a class="code" href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">pGetProperties</a>(plane_number);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordtype">int</span> number_of_triangles =  0;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordtype">int</span> current_element= 0;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triangle_nodes= 0;  <span class="comment">// number of nodes already saved (of the current element)</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordtype">bool</span> new_node = false ; <span class="comment">//used to check whether the current node has been saved or not</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 4 &gt;</a> TriangleNodesArray; <span class="comment">//nodes of the element to be generated. 4 in case they&#39;re 2 triangles</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>=0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>!=4; ++<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            TriangleNodesArray[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>] = -1;   <span class="comment">//initializing in -1, meaning we have no nodes yet</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ElementsArrayType::iterator</a> it = it_begin_old; it != it_end_old; ++it)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            ++current_element;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            triangle_nodes = 0; <span class="comment">//starting, no nodes yet</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (Elems_In_Plane[current_element-1] == 1 ) <span class="comment">//do not forget than can be both 1 or 2 triangles per tetraedra. this is the simplest case. no need to check anything, we just create an element with the 3 nodes</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                <span class="comment">//checking element conectivities</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//i node of the element</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++) <span class="comment">//j node of the element</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                        new_node= <span class="keyword">true</span>; <span class="comment">//by default it&#39;s a new node</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                        <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>=0; <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>!=3; ++<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>)</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                        {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                            <span class="keywordflow">if</span>(TriangleNodesArray[<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>]==Coord(index_i, index_j) <span class="comment">//if we have already saved this node or it has not been cutted, then we have no new node to add (coord(i,j)=-1)</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                    || Coord(index_i, index_j) &lt;1 )</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                new_node=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        <span class="comment">//if it&#39;s a new node and the indexes are correct:</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        <span class="keywordflow">if</span> (new_node &amp;&amp; index_i&lt;=index_j)</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                            TriangleNodesArray[triangle_nodes]=Coord(index_i, index_j) ;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                            triangle_nodes++;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        <span class="keywordflow">if</span> (triangle_nodes ==3) <span class="keywordflow">break</span>;               <span class="comment">//if we have already found 3 nodes then we can exit</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                    } <span class="comment">//closing j node loop</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                    <span class="keywordflow">if</span> (triangle_nodes ==3) <span class="keywordflow">break</span>;               <span class="comment">//egal</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                } <span class="comment">//closing j node loop</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="comment">//now we have to check that the normal of the element matches the one of the plane (they could have opposite directions)</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ModelPart::NodesContainerType::iterator</a> it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[0]);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = it_node1-&gt;Coordinates(); <span class="comment">//node 1</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                it_node1 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[1]);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = it_node1-&gt;Coordinates(); <span class="comment">//node 2</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                it_node1 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[2]);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = it_node1-&gt;Coordinates(); <span class="comment">//nodo 3</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                temp_vector3 -=temp_vector1; <span class="comment">//first edge</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                temp_vector2 -=temp_vector1; <span class="comment">//second edge</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, temp_vector2 , temp_vector3) ; <span class="comment">//multiplying the 2 edges gives us a normal vector to the element</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector4,versor)&lt;0.0) <span class="comment">//if the signs do not match then they have opposite directions</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                    temp_int= TriangleNodesArray[2];</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                    TriangleNodesArray[2] =  TriangleNodesArray[1];</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    TriangleNodesArray[1] =  temp_int;              <span class="comment">//we switch 2 nodes and ready</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="comment">//generate new Elements</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geom(</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[0]),</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[1]),</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[2])</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                );</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1+first_element, geom, properties); <span class="comment">//creating the element using the reference element. notice we are using the first element to avoid overriting nodes created by other cutting planes</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                ++number_of_triangles;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=4; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>) TriangleNodesArray[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            }<span class="comment">//closing if elems_in_plane==6 (1 triangle)</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordflow">if</span> (Elems_In_Plane[current_element-1] == 2)  <span class="comment">//now we have 2 elements. we cant just create 2 elements with a random node order because they might overlap and not cover the whole area defined by the trapezoid</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="comment">//to fix this we&#39;ll first create a plane. see below</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="comment">//checking conectivities to find nodes</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++) <span class="comment">//nodo i</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++) <span class="comment">//nodo j</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                        new_node= <span class="keyword">true</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                        <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>=0; <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>!=3; ++<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                        {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                            <span class="keywordflow">if</span>(TriangleNodesArray[<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>]==Coord(index_i, index_j) <span class="comment">//same as the part with only one triangle (look above)</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                    || Coord(index_i, index_j) &lt; 1 )</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                            {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                new_node=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                            }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                        }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                        <span class="keywordflow">if</span> (new_node &amp;&amp; index_i&lt;index_j)</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                        {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                            TriangleNodesArray[triangle_nodes]=Coord(index_i, index_j) ;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                            triangle_nodes++;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                        <span class="keywordflow">if</span> (triangle_nodes ==4) <span class="keywordflow">break</span>;               <span class="comment">//once we&#39;ve found the 4 nodes we can exit</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                    } <span class="comment">//closing i loop</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                    <span class="keywordflow">if</span> (triangle_nodes ==4) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="comment">//now we have to start checking the angles. the easiest way (i think) is creating a new plane using the original plane and a segment created by 2 nodes</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="comment">// using crossproduct we get a perpendicular plane. (either point can be used as origin).</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                <span class="comment">//since the cuadrilateral is created by the cut of teatraedra,</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                <span class="comment">//none of its internal angles can exceed 180 degrees and hence our new plane divides the cuadrilateral into 2 triangles if the distances to the other points have different signs (one on top and the other on the bottom of this new plane)</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                <span class="comment">//otherwise this edge is just an edge of the cuadrilateral and we have to look for another.</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="comment">//so let&#39;s begin! (we&#39;ll keep an origin node and we&#39;ll loop different nodes as the end of the segment till we find one that satisfies our criteria)</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ModelPart::NodesContainerType::iterator</a> it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[0]);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = it_node1-&gt;Coordinates(); <span class="comment">//nodo 1 (origin)</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordtype">int</span> jjj;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordtype">int</span> kkk;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iii=1; iii!=4; ++iii)     <span class="comment">//end node of the segment that will be used to create the plane (will be contained too)</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                    <span class="comment">//  KRATOS_WATCH(iii);</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                    it_node1=new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[iii]); <span class="comment">//i node. we always keep node 0 as origin</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = it_node1-&gt;Coordinates(); <span class="comment">//node2 (end)</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = temp_vector2 - temp_vector1; <span class="comment">//segment 1-2</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    <span class="comment">//now i have to create the new plane</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, versor , temp_vector3); <span class="comment">//done. now temp_vector4 is the (normal to the) new plane, perpendicular to the one containing the triangles</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    <span class="comment">//the origin of the plane is temp_vector1 (temp_vector2 could also be used)</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                    <span class="comment">//now we need to check distances to the other nodes (i+2 (let&#39;s call them jjj and i+3=kkk since we can&#39;t go futher than i=3)</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                    <span class="keywordflow">if</span> (iii==1)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                    {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                        jjj=2;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        kkk=3;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iii==2)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                    {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        jjj=3;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        kkk=1;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                        jjj=2;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                        kkk=1;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                    }</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                    it_node1=new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[jjj]);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = it_node1-&gt;Coordinates(); <span class="comment">//one of the remaining nodes;</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    it_node1=new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[kkk]);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = it_node1-&gt;Coordinates(); <span class="comment">//the other remaining node;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) -=temp_vector1;   <span class="comment">// minus origin point of the plane</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) -=temp_vector1;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                    dist2= <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector2,temp_vector4);  <span class="comment">// dot product</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    dist3= <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector3,temp_vector4);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    <a class="code" href="../../dd/d7b/namespacecontrol.html">control</a>=dist2*dist3;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    <span class="comment">//and that&#39;s it. we now have to check if the distance have different signs. to do so we multiply :</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7b/namespacecontrol.html">control</a>&lt;0.0) <span class="comment">//we have the right one! one node on each side of the plane generated by nodes 0 and iii</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                    {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                        nodes_for_2triang[0] = TriangleNodesArray[0] ;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                        nodes_for_2triang[1] = TriangleNodesArray[jjj];</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        nodes_for_2triang[2] = TriangleNodesArray[iii]; <span class="comment">//finish first triangle</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        nodes_for_2triang[3] = TriangleNodesArray[iii];</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                        nodes_for_2triang[4] = TriangleNodesArray[kkk];</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                        nodes_for_2triang[5] = TriangleNodesArray[0]; <span class="comment">//finish 2nd triangle</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                        <span class="comment">//  KRATOS_WATCH(nodes_for_2triang);</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                        <span class="keywordflow">break</span>; <span class="comment">//no need to keep looking, we can exit the loop</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                    } <span class="comment">//closing the if</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                }<span class="comment">//by the time this finishes i should already have TriangleNodesArray</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                <span class="comment">//checking if the normal to our element is oriented correctly, just as we did when we had only 1 triangle (not commented here)</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> index=0 ; index !=2 ; ++index) <span class="comment">//for triangle 1 and 2</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                    it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+0]);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = it_node1-&gt;Coordinates(); <span class="comment">//node 1</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                    it_node1 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+1]);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = it_node1-&gt;Coordinates(); <span class="comment">//node 2</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                    it_node1 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+2]);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = it_node1-&gt;Coordinates(); <span class="comment">//node 3</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                    temp_vector3 -=temp_vector1;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                    temp_vector2 -=temp_vector1;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                    <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, temp_vector2 , temp_vector3) ;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector4,versor)&lt;0.0)</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                    {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                        temp_int= nodes_for_2triang[index*3+2];</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                        nodes_for_2triang[index*3+2] =  nodes_for_2triang[index*3+1];</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                        nodes_for_2triang[index*3+1] =  temp_int;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geom(</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+0]),</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+1]),</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+2])</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                    );</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                    Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1+first_element, geom, properties);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    ++number_of_triangles;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=4; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>) TriangleNodesArray[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                }<span class="comment">//cierro el index</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            }<span class="comment">//closing if elems_in_plane=2</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        }<span class="comment">//closing element loops</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno"><a class="line" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ad49ab4f82b189c6d7af28e779e8b2a6d">  930</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ad49ab4f82b189c6d7af28e779e8b2a6d">UpdateCutData</a>( <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; old_model_part)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Updating Cut Data&quot;</span>);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordtype">int</span> step_data_size = old_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a23d16a9ecf3f68f5f7bcdc1c50146b36">GetNodalSolutionStepDataSize</a>();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="comment">//looping the nodes, no data is assigned to elements</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">ModelPart::NodesContainerType::iterator</a> it = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>(); it != new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#adddcc5bbc4b0acc4aeb81953d900c42a">NodesEnd</a>(); it++)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            <span class="keywordtype">double</span>* node0_data = it-&gt;GetValue(FATHER_NODES)[0].SolutionStepData().Data(0); <span class="comment">//current step only, (since we&#39;ll call this every timestep</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <span class="keywordtype">double</span>* node1_data = it-&gt;GetValue(FATHER_NODES)[1].SolutionStepData().Data(0);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <span class="keywordtype">double</span>    weight   = it-&gt;GetValue(WEIGHT_FATHER_NODES);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordtype">double</span>* step_data = (it)-&gt;SolutionStepData().Data(0);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            <span class="comment">//now we only have to copy the information from node_data to step_data</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>= 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>&lt; step_data_size; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)  <span class="comment">//looping all the variables and interpolating using weight</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                step_data[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = weight*node0_data[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] + (1.0-weight)*node1_data[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>];</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        }<span class="comment">//closing node loop</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }<span class="comment">//closing subroutine</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordtype">double</span> smallest_edge; <span class="comment">//</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">bool</span> first_cutting_plane; <span class="comment">// to avoid checking again if we&#39;re working on the new cutting plane or if some have already been created</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;};</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aarray__1d_8h_html"><div class="ttname"><a href="../../d9/d36/array__1d_8h.html">array_1d.h</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_condition_html"><div class="ttname"><a href="../../d1/d6e/class_kratos_1_1_condition.html">Kratos::Condition</a></div><div class="ttdoc">Base class for all Conditions.</div><div class="ttdef"><b>Definition:</b> condition.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_condition_html_a0c821c1542b62403c675b4dd16cc74c9"><div class="ttname"><a href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Kratos::Condition::Create</a></div><div class="ttdeci">virtual Pointer Create(IndexType NewId, NodesArrayType const &amp;ThisNodes, PropertiesType::Pointer pProperties) const</div><div class="ttdoc">It creates a new condition pointer.</div><div class="ttdef"><b>Definition:</b> condition.h:205</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html">Kratos::CuttingUtility</a></div><div class="ttdoc">CUTTING UTILITY.</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:65</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a039aae249bcea2925fdf26817a81d38f"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a039aae249bcea2925fdf26817a81d38f">Kratos::CuttingUtility::Calculate_Coordinate_And_Insert_New_Nodes_Mod</a></div><div class="ttdeci">void Calculate_Coordinate_And_Insert_New_Nodes_Mod(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, const DenseVector&lt; array_1d&lt; int, 2 &gt; &gt; &amp;Position_Node, const DenseVector&lt; int &gt; &amp;List_New_Nodes, const array_1d&lt; double, 3 &gt; &amp;versor, const array_1d&lt; double, 3 &gt; &amp;Xp, double tolerance)</div><div class="ttdoc">‍************************************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:579</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a169ad45f5d77ad140b472edcb97ee86b"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a169ad45f5d77ad140b472edcb97ee86b">Kratos::CuttingUtility::PointIterator</a></div><div class="ttdeci">PointVector::iterator PointIterator</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:79</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a2997cfd145fb42404e1e702e73905af1"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a2997cfd145fb42404e1e702e73905af1">Kratos::CuttingUtility::ElementsArrayType</a></div><div class="ttdeci">ModelPart::ElementsContainerType ElementsArrayType</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:71</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a37eec2b4afd1c280e3a083bbcdcc91f6"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a37eec2b4afd1c280e3a083bbcdcc91f6">Kratos::CuttingUtility::Vector_Order_Tensor</a></div><div class="ttdeci">DenseVector&lt; Vector &gt; Vector_Order_Tensor</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:74</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a3e644ccf46ee827297df6ce8bb154a63"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a3e644ccf46ee827297df6ce8bb154a63">Kratos::CuttingUtility::PointVector</a></div><div class="ttdeci">std::vector&lt; PointType::Pointer &gt; PointVector</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:78</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a3fa3c0298a7c6c0e9ccad84665f97774"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a3fa3c0298a7c6c0e9ccad84665f97774">Kratos::CuttingUtility::GenerateCut</a></div><div class="ttdeci">void GenerateCut(ModelPart &amp;mr_model_part, ModelPart &amp;mr_new_model_part, const array_1d&lt; double, 3 &gt; &amp;versor, const array_1d&lt; double, 3 &gt; &amp;Xp, int plane_number, double tolerance_factor)</div><div class="ttdoc">This function Creates cutting planes by creating nodes and conditions (to define the conectivities) i...</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:144</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a4f7af69f59bc4f6a25e03ea6deff65b5"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a4f7af69f59bc4f6a25e03ea6deff65b5">Kratos::CuttingUtility::FindSmallestEdge</a></div><div class="ttdeci">void FindSmallestEdge(ModelPart &amp;mr_model_part)</div><div class="ttdoc">This function Creates cutting planes by creating nodes and conditions (to define the conectivities) i...</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:100</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a701c71c3e815b0f8ef705becd6e113a3"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a701c71c3e815b0f8ef705becd6e113a3">Kratos::CuttingUtility::FirstLoop</a></div><div class="ttdeci">void FirstLoop(ModelPart &amp;this_model_part, boost::numeric::ublas::compressed_matrix&lt; int &gt; &amp;Coord, const array_1d&lt; double, 3 &gt; &amp;versor, const array_1d&lt; double, 3 &gt; &amp;Xp, int number_of_triangles, DenseVector&lt; int &gt; &amp;Elems_In_Plane, double tolerance)</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:367</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a77a8db1b1d775ffc7503f4d066a14ff0"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a77a8db1b1d775ffc7503f4d066a14ff0">Kratos::CuttingUtility::Create_List_Of_New_Nodes_Mod</a></div><div class="ttdeci">void Create_List_Of_New_Nodes_Mod(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, boost::numeric::ublas::compressed_matrix&lt; int &gt; &amp;Coord, DenseVector&lt; int &gt; &amp;List_New_Nodes, DenseVector&lt; array_1d&lt; int, 2 &gt; &gt; &amp;Position_Node)</div><div class="ttdoc">‍************************************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:510</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a833343517767f4ff9ad2070136f902c7"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a833343517767f4ff9ad2070136f902c7">Kratos::CuttingUtility::CSR_Row_Matrix_Mod</a></div><div class="ttdeci">void CSR_Row_Matrix_Mod(ModelPart &amp;this_model_part, boost::numeric::ublas::compressed_matrix&lt; int &gt; &amp;Coord)</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:329</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a9134a3aa07de85cffdd62e013af0d82b"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a9134a3aa07de85cffdd62e013af0d82b">Kratos::CuttingUtility::PointPointerType</a></div><div class="ttdeci">Node ::Pointer PointPointerType</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_a9465720710034d7e9dde1f541c535cb3"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#a9465720710034d7e9dde1f541c535cb3">Kratos::CuttingUtility::AddVariablesToCutModelPart</a></div><div class="ttdeci">void AddVariablesToCutModelPart(const ModelPart &amp;rModelPart, ModelPart &amp;rNewModelPart) const</div><div class="ttdoc">Initialize the solution step data container for the cut model part.</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:312</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_aa6e22c293cab9352e29e183f77edd00f"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aa6e22c293cab9352e29e183f77edd00f">Kratos::CuttingUtility::Matrix_Order_Tensor</a></div><div class="ttdeci">DenseVector&lt; Matrix &gt; Matrix_Order_Tensor</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:73</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_aab0deaa5ff9d4ef1030b5e54bc0c7751"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aab0deaa5ff9d4ef1030b5e54bc0c7751">Kratos::CuttingUtility::PointType</a></div><div class="ttdeci">Node PointType</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:76</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_ab247746453cd2ee99b87ef3b9b21d9e4"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab247746453cd2ee99b87ef3b9b21d9e4">Kratos::CuttingUtility::GenerateElements</a></div><div class="ttdeci">void GenerateElements(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, DenseVector&lt; int &gt; Elems_In_Plane, boost::numeric::ublas::compressed_matrix&lt; int &gt; &amp;Coord, const array_1d&lt; double, 3 &gt; &amp;versor, int plane_number)</div><div class="ttdoc">‍**********************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:659</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_ab44ab0370e5e7eb7b7c9199ee89b11e6"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ab44ab0370e5e7eb7b7c9199ee89b11e6">Kratos::CuttingUtility::~CuttingUtility</a></div><div class="ttdeci">virtual ~CuttingUtility()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:92</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_abb1b29de11524409976338d911de57ab"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#abb1b29de11524409976338d911de57ab">Kratos::CuttingUtility::CuttingUtility</a></div><div class="ttdeci">CuttingUtility()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:86</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_ad49ab4f82b189c6d7af28e779e8b2a6d"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ad49ab4f82b189c6d7af28e779e8b2a6d">Kratos::CuttingUtility::UpdateCutData</a></div><div class="ttdeci">void UpdateCutData(ModelPart &amp;new_model_part, ModelPart &amp;old_model_part)</div><div class="ttdoc">UPDATECUTDATA: THIS FUNCTION UPDATES THE DATA OF THE NEW MODEL PART READING FROM THE DATA OF THE FATH...</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:930</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_ae467622309d1a5f21b3f3a54cc578dcd"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ae467622309d1a5f21b3f3a54cc578dcd">Kratos::CuttingUtility::Node_Vector_Order_Tensor</a></div><div class="ttdeci">DenseVector&lt; Vector_Order_Tensor &gt; Node_Vector_Order_Tensor</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:75</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_ae702a809d1ba6c372ccb92a88b1eae75"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#ae702a809d1ba6c372ccb92a88b1eae75">Kratos::CuttingUtility::ConditionsArrayType</a></div><div class="ttdeci">ModelPart::ConditionsContainerType ConditionsArrayType</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:72</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_aea1e4b5af4e47156f294da3a11af3517"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#aea1e4b5af4e47156f294da3a11af3517">Kratos::CuttingUtility::AddSkinConditions</a></div><div class="ttdeci">void AddSkinConditions(ModelPart &amp;mr_model_part, ModelPart &amp;mr_new_model_part, int plane_number)</div><div class="ttdoc">ADDSKINCONDITIONS: THIS FUNCTION ADDS TO THE NEW MODEL PART THE DATA OF THE CONDITIONS BELONGING TO T...</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:196</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting_utility_html_af009a5be666de3241b197c06147f5325"><div class="ttname"><a href="../../d0/de1/class_kratos_1_1_cutting_utility.html#af009a5be666de3241b197c06147f5325">Kratos::CuttingUtility::NodesArrayType</a></div><div class="ttdeci">ModelPart::NodesContainerType NodesArrayType</div><div class="ttdef"><b>Definition:</b> cutting_utility.h:70</div></div>
<div class="ttc" id="aclass_kratos_1_1_geometry_html"><div class="ttname"><a href="../../dc/dea/class_kratos_1_1_geometry.html">Kratos::Geometry</a></div><div class="ttdoc">Geometry base class.</div><div class="ttdef"><b>Definition:</b> geometry.h:71</div></div>
<div class="ttc" id="aclass_kratos_1_1_geometry_html_a6a78c4a94b491bfa7e9b79795ad8e42b"><div class="ttname"><a href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Kratos::Geometry::Id</a></div><div class="ttdeci">IndexType const  &amp; Id() const</div><div class="ttdoc">Id of this Geometry.</div><div class="ttdef"><b>Definition:</b> geometry.h:964</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">Kratos::GlobalPointersVector</a></div><div class="ttdoc">This class is a vector which stores global pointers.</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:61</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_a04db5b3969fe3a11463c561a3cae856a"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a04db5b3969fe3a11463c561a3cae856a">Kratos::GlobalPointersVector::iterator</a></div><div class="ttdeci">boost::indirect_iterator&lt; typename TContainerType::iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:79</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_a599125ad0e25d62480de5e84477b5f20"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a599125ad0e25d62480de5e84477b5f20">Kratos::GlobalPointersVector::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:221</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_aecf3bbe94f6105274d86e19e7bbe3631"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#aecf3bbe94f6105274d86e19e7bbe3631">Kratos::GlobalPointersVector::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:229</div></div>
<div class="ttc" id="aclass_kratos_1_1_internals_1_1_matrix_html"><div class="ttname"><a href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Kratos::Internals::Matrix</a></div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:41</div></div>
<div class="ttc" id="aclass_kratos_1_1_internals_1_1_matrix_html_a3d36c583d63e7eeda493a7abdc97d874"><div class="ttname"><a href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">Kratos::Internals::Matrix::resize</a></div><div class="ttdeci">void resize(std::size_t NewSize1, std::size_t NewSize2, bool preserve=0)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:224</div></div>
<div class="ttc" id="aclass_kratos_1_1_kratos_components_html_adfcf332737a38d483a5e234ac4691390"><div class="ttname"><a href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">Kratos::KratosComponents::Get</a></div><div class="ttdeci">static const TComponentType &amp; Get(const std::string &amp;rName)</div><div class="ttdoc">Retrieves a component with the specified name.</div><div class="ttdef"><b>Definition:</b> kratos_components.h:114</div></div>
<div class="ttc" id="aclass_kratos_1_1_math_utils_html_a3f3809a3e2d5bbf26534499077572992"><div class="ttname"><a href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">Kratos::MathUtils::CrossProduct</a></div><div class="ttdeci">static T CrossProduct(const T &amp;a, const T &amp;b)</div><div class="ttdoc">Performs the vector product of the two input vectors a,b.</div><div class="ttdef"><b>Definition:</b> math_utils.h:807</div></div>
<div class="ttc" id="aclass_kratos_1_1_mesh_html_aac143337e8147241402a40934847e1f5"><div class="ttname"><a href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">Kratos::Mesh::pGetProperties</a></div><div class="ttdeci">PropertiesType::Pointer pGetProperties(IndexType PropertiesId)</div><div class="ttdef"><b>Definition:</b> mesh.h:394</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html">Kratos::ModelPart</a></div><div class="ttdoc">This class aims to manage meshes for multi-physics simulations.</div><div class="ttdef"><b>Definition:</b> model_part.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a1b106932da453f761af9799eb3b2ae22"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">Kratos::ModelPart::CreateNewNode</a></div><div class="ttdeci">NodeType::Pointer CreateNewNode(int Id, double x, double y, double z, VariablesList::Pointer pNewVariablesList, IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.cpp:270</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a23d16a9ecf3f68f5f7bcdc1c50146b36"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a23d16a9ecf3f68f5f7bcdc1c50146b36">Kratos::ModelPart::GetNodalSolutionStepDataSize</a></div><div class="ttdeci">SizeType GetNodalSolutionStepDataSize()</div><div class="ttdef"><b>Definition:</b> model_part.h:571</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a59e727cef5f608c3006f87356bd9bdcd"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">Kratos::ModelPart::NodesBegin</a></div><div class="ttdeci">NodeIterator NodesBegin(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:487</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a6754ddb1e657c4efba0705a341de0294"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Kratos::ModelPart::Conditions</a></div><div class="ttdeci">ConditionsContainerType &amp; Conditions(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1381</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a71ce386b94d94c11741419d9ca34e87f"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">Kratos::ModelPart::AddNodalSolutionStepVariable</a></div><div class="ttdeci">void AddNodalSolutionStepVariable(VariableData const &amp;ThisVariable)</div><div class="ttdef"><b>Definition:</b> model_part.h:532</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a885a2e1a9dd829e9cc23dad49e8ad72e"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">Kratos::ModelPart::NodeIterator</a></div><div class="ttdeci">MeshType::NodeIterator NodeIterator</div><div class="ttdef"><b>Definition:</b> model_part.h:134</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a94dfb23c46340061bd57e9b9c4e317c8"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Kratos::ModelPart::Elements</a></div><div class="ttdeci">ElementsContainerType &amp; Elements(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1189</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_adddcc5bbc4b0acc4aeb81953d900c42a"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#adddcc5bbc4b0acc4aeb81953d900c42a">Kratos::ModelPart::NodesEnd</a></div><div class="ttdeci">NodeIterator NodesEnd(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:497</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aea4c0a93255ea7669a0c10e185386dc3"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">Kratos::ModelPart::GetMesh</a></div><div class="ttdeci">MeshType &amp; GetMesh(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1791</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aeeaebc841dc1351f20b650c6497d6323"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Kratos::ModelPart::Nodes</a></div><div class="ttdeci">NodesContainerType &amp; Nodes(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:507</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_af32f65f012a53e237a2c1aa6b074b5b1"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">Kratos::ModelPart::GetNodalSolutionStepVariablesList</a></div><div class="ttdeci">VariablesList &amp; GetNodalSolutionStepVariablesList()</div><div class="ttdef"><b>Definition:</b> model_part.h:549</div></div>
<div class="ttc" id="aclass_kratos_1_1_node_html"><div class="ttname"><a href="../../d5/ddd/class_kratos_1_1_node.html">Kratos::Node</a></div><div class="ttdoc">This class defines the node.</div><div class="ttdef"><b>Definition:</b> node.h:65</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">Kratos::PointerVectorSet</a></div><div class="ttdoc">A sorted associative container similar to an STL set, but uses a vector to store pointers to its data...</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:72</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a3e3061ba89e3e5ba034a316fde4635b2"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a3e3061ba89e3e5ba034a316fde4635b2">Kratos::PointerVectorSet::ptr_end</a></div><div class="ttdeci">ptr_iterator ptr_end()</div><div class="ttdoc">Returns an iterator pointing to the end of the underlying data container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:404</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a4d86d2359054ebdf0b7e941d8b50f857"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4d86d2359054ebdf0b7e941d8b50f857">Kratos::PointerVectorSet::iterator</a></div><div class="ttdeci">boost::indirect_iterator&lt; typename TContainerType::iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:95</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a4e4998c693d7262809d3a818c9995311"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a4e4998c693d7262809d3a818c9995311">Kratos::PointerVectorSet::ptr_begin</a></div><div class="ttdeci">ptr_iterator ptr_begin()</div><div class="ttdoc">Returns an iterator pointing to the beginning of the underlying data container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:386</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a510c92d5ebe9a4beeb063269530ef31a"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a510c92d5ebe9a4beeb063269530ef31a">Kratos::PointerVectorSet::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">Returns the number of elements in the container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:502</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_aaba01bc27b154ddfb13c4875a1ee2cfb"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#aaba01bc27b154ddfb13c4875a1ee2cfb">Kratos::PointerVectorSet::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdoc">Returns an iterator pointing to the beginning of the container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:278</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_acc410959c998f861779d4e180822b78b"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#acc410959c998f861779d4e180822b78b">Kratos::PointerVectorSet::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Returns an iterator pointing to the end of the container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:314</div></div>
<div class="ttc" id="aclass_kratos_1_1_triangle3_d3_html"><div class="ttname"><a href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Kratos::Triangle3D3</a></div><div class="ttdoc">A three node 3D triangle geometry with linear shape functions.</div><div class="ttdef"><b>Definition:</b> triangle_3d_3.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_variables_list_html_ad3ac4ea69689c41239ff2af18d9f2653"><div class="ttname"><a href="../../dd/d77/class_kratos_1_1_variables_list.html#ad3ac4ea69689c41239ff2af18d9f2653">Kratos::VariablesList::Has</a></div><div class="ttdeci">bool Has(const VariableData &amp;rThisVariable) const</div><div class="ttdef"><b>Definition:</b> variables_list.h:372</div></div>
<div class="ttc" id="aclass_kratos_1_1array__1d_html"><div class="ttname"><a href="../../d4/ddc/class_kratos_1_1array__1d.html">Kratos::array_1d&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="adata__value__container_8h_html"><div class="ttname"><a href="../../d1/d82/data__value__container_8h.html">data_value_container.h</a></div></div>
<div class="ttc" id="adefine_8h_html"><div class="ttname"><a href="../../df/d67/define_8h.html">define.h</a></div></div>
<div class="ttc" id="adefine_8h_html_a5eac541f5e39bf0360a12f51f0248513"><div class="ttname"><a href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a></div><div class="ttdeci">#define KRATOS_CATCH(MoreInfo)</div><div class="ttdef"><b>Definition:</b> define.h:110</div></div>
<div class="ttc" id="adefine_8h_html_a6135b00508a42f0e8f91d1369644cbc1"><div class="ttname"><a href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a></div><div class="ttdeci">#define KRATOS_WATCH(variable)</div><div class="ttdef"><b>Definition:</b> define.h:836</div></div>
<div class="ttc" id="adefine_8h_html_ab9c29d6a0d19ff26bbc4e45e3181fb3f"><div class="ttname"><a href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div><div class="ttdeci">#define KRATOS_TRY</div><div class="ttdef"><b>Definition:</b> define.h:109</div></div>
<div class="ttc" id="adof_8h_html"><div class="ttname"><a href="../../d1/d4e/dof_8h.html">dof.h</a></div></div>
<div class="ttc" id="afind__nodal__neighbours__process_8h_html"><div class="ttname"><a href="../../db/d68/find__nodal__neighbours__process_8h.html">find_nodal_neighbours_process.h</a></div></div>
<div class="ttc" id="agroup___kratos_core_html_ga376e02451bc7cc3a5fd77b57f0549e6b"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a></div><div class="ttdeci">#define KRATOS_ERROR</div><div class="ttdef"><b>Definition:</b> exception.h:161</div></div>
<div class="ttc" id="amath__utils_8h_html"><div class="ttname"><a href="../../d8/d88/math__utils_8h.html">math_utils.h</a></div></div>
<div class="ttc" id="amesh_8h_html"><div class="ttname"><a href="../../d8/d3b/mesh_8h.html">mesh.h</a></div></div>
<div class="ttc" id="amodel__part_8h_html"><div class="ttname"><a href="../../dd/dfe/model__part_8h.html">model_part.h</a></div></div>
<div class="ttc" id="anamespace_kratos_1_1_python_html_afdd2f70c75c8e7c828cbab4a370a6d35"><div class="ttname"><a href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">Kratos::Python::GetValue</a></div><div class="ttdeci">Parameters GetValue(Parameters &amp;rParameters, const std::string &amp;rEntry)</div><div class="ttdef"><b>Definition:</b> add_kratos_parameters_to_python.cpp:53</div></div>
<div class="ttc" id="anamespace_kratos_html"><div class="ttname"><a href="../../db/d66/namespace_kratos.html">Kratos</a></div><div class="ttdoc">REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.</div><div class="ttdef"><b>Definition:</b> mesh_condition.cpp:21</div></div>
<div class="ttc" id="anamespace_kratos_html_a656fecfa2a6cca4ac7b95d43ee8ef0b2"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">Kratos::inner_prod</a></div><div class="ttdeci">TExpression1Type::data_type inner_prod(AMatrix::MatrixExpression&lt; TExpression1Type, TCategory1 &gt; const &amp;First, AMatrix::MatrixExpression&lt; TExpression2Type, TCategory2 &gt; const &amp;Second)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:592</div></div>
<div class="ttc" id="anamespace_kratos_html_aaff3672cc52b90ee3d84713de272e1b5"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">Kratos::noalias</a></div><div class="ttdeci">T &amp; noalias(T &amp;TheMatrix)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:484</div></div>
<div class="ttc" id="anamespacecontrol_html"><div class="ttname"><a href="../../dd/d7b/namespacecontrol.html">control</a></div><div class="ttdef"><b>Definition:</b> control.py:1</div></div>
<div class="ttc" id="anamespacegenerate__frictionless__components__mortar__condition_html_ace75554ee1af2aeb69b2a0fc4fb6f8e2"><div class="ttname"><a href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">generate_frictionless_components_mortar_condition.active</a></div><div class="ttdeci">active</div><div class="ttdef"><b>Definition:</b> generate_frictionless_components_mortar_condition.py:175</div></div>
<div class="ttc" id="anamespacequadrature_html_a56123f01f0d1e776d9a6d85aa0f27caa"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">quadrature.k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> quadrature.py:595</div></div>
<div class="ttc" id="anamespacequadrature_html_aae897447319c4634b1dcef7634fe5876"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">quadrature.j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> quadrature.py:648</div></div>
<div class="ttc" id="anamespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t_html_a37fe67255f2e1d30f90f0f02ceb60616"><div class="ttname"><a href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">script_THERMAL_CORRECT.counter</a></div><div class="ttdeci">int counter</div><div class="ttdef"><b>Definition:</b> script_THERMAL_CORRECT.py:218</div></div>
<div class="ttc" id="anamespacetensors_html_a15a1da80aa773e2015eba781cababe05"><div class="ttname"><a href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">tensors::i</a></div><div class="ttdeci">integer i</div><div class="ttdef"><b>Definition:</b> TensorModule.f:17</div></div>
<div class="ttc" id="anamespacetensors_html_a77b97b9c700f4d4697e0e623ce693eeb"><div class="ttname"><a href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">tensors::l</a></div><div class="ttdeci">integer l</div><div class="ttdef"><b>Definition:</b> TensorModule.f:17</div></div>
<div class="ttc" id="anode_8h_html"><div class="ttname"><a href="../../d1/d77/node_8h.html">node.h</a></div></div>
<div class="ttc" id="aspatial__containers_8h_html"><div class="ttname"><a href="../../db/d8f/spatial__containers_8h.html">spatial_containers.h</a></div></div>
<div class="ttc" id="asplit__tetrahedra_8h_html"><div class="ttname"><a href="../../d0/d9c/split__tetrahedra_8h.html">split_tetrahedra.h</a></div></div>
<div class="ttc" id="asplit__triangle_8h_html"><div class="ttname"><a href="../../df/d98/split__triangle_8h.html">split_triangle.h</a></div></div>
<div class="ttc" id="atetrahedra__3d__4_8h_html"><div class="ttname"><a href="../../da/d60/tetrahedra__3d__4_8h.html">tetrahedra_3d_4.h</a></div></div>
<div class="ttc" id="atriangle__3d__3_8h_html"><div class="ttname"><a href="../../d9/def/triangle__3d__3_8h.html">triangle_3d_3.h</a></div></div>
<div class="ttc" id="avariables_8h_html"><div class="ttname"><a href="../../de/dca/variables_8h.html">variables.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 11 2024 03:20:40 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
