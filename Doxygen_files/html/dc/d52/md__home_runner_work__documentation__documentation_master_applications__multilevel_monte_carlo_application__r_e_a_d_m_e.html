<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: Multilevel Monte Carlo Application</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Multilevel Monte Carlo Application </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="../../dd/db0/namespace_multilevel_monte_carlo_application.html">MultilevelMonteCarloApplication</a> provides different algorithms, belonging to the Monte Carlo (MC) family, to estimate statistics of scalar and field quantities of interest. The application is designed for running on distributed and high performance computing systems, exploiting both OpenMP and MPI parallel strategies. The application contains several interfaces with external libraries.</p>
<h1>Getting started</h1>
<p>This application is part of the <a class="el" href="../../db/d66/namespace_kratos.html" title="REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.">Kratos</a> Multiphysics Platform. Instructions on how to download, install and run the software in your local machine for development and testing purposes are available for both <a href="https://github.com/KratosMultiphysics/Kratos/wiki/Linux-Build">Linux</a> and <a href="https://github.com/KratosMultiphysics/Kratos/wiki/Windows-Install">Windows</a> systems.</p>
<h2>Prerequisites</h2>
<p>Build <a href="https://github.com/KratosMultiphysics/Kratos/wiki">Kratos</a> and make sure to have </p><div class="fragment"><div class="line">add_app ${KRATOS_APP_DIR}/MultilevelMonteCarloApplication</div>
</div><!-- fragment --><p> in the compilation configuration, in order to compile the <code><a class="el" href="../../dd/db0/namespace_multilevel_monte_carlo_application.html">MultilevelMonteCarloApplication</a></code> application.</p>
<h1>Hierarchical Monte Carlo methods</h1>
<ul>
<li>Repeatedly generate the random input and solve the associated deterministic problem.</li>
<li>Convergence to the exact statistics as the number of realizations grows.</li>
<li>Problem under consideration considered as a black-box.</li>
<li>Convergence rate independent from stochastic space dimension.</li>
</ul>
<h2>Monte Carlo</h2>
<ul>
<li>Monte Carlo (MC) is the reference method in the stochastic analysis of multiphysics problems with uncertainties in the data parameters.</li>
<li>Levels of parallelism:<ul>
<li>Between samples,</li>
<li>On each sample at solver level.</li>
</ul>
</li>
<li>Hierarchy update:<ul>
<li>Deterministic,</li>
<li>Adaptive.</li>
</ul>
</li>
</ul>
<h2>Multilevel Monte Carlo</h2>
<ul>
<li>Multilevel Monte Carlo (MLMC) requires a hierarchy of levels with increasing accuracy to solve the statistical problem. Convergence rate is faster with respect to MC if MLMC hypotheses are satisfied.</li>
<li>Computation of a large number of cheap and lower accuracy realizations, while only few expensive high accuracy realizations are run.<ul>
<li>Low accuracy levels: capture statistical variability,</li>
<li>High accuracy levels: capture discretization error.</li>
</ul>
</li>
<li> align="center"Example of hierarchy of computational grids, showing increasing accuracy levels (by decreasing mesh size): </li>
</ul>
<p><img src="https://raw.githubusercontent.com/KratosMultiphysics/Documentation/master/Readme_files/MultilevelMonteCarloApplication/mesh012.PNG" alt="Solution" style="width: 600px;" class="inline"/> </p>
<ul>
<li>Levels of parallelism:<ul>
<li>Between levels,</li>
<li>Between samples,</li>
<li>On each sample at solver level.</li>
</ul>
</li>
<li>Hierarchy update:<ul>
<li>Deterministic,</li>
<li>Adaptive.</li>
</ul>
</li>
</ul>
<h2>Asynchronous Monte Carlo</h2>
<ul>
<li>This algorithm is equivalent to MC, but designed for running in distributed environments. It avoids idle times and keeps at maximum the computational efficiency.</li>
<li>Levels of parallelism:<ul>
<li>Between batches,</li>
<li>Between samples,</li>
<li>On each sample at solver level.</li>
</ul>
</li>
<li>Hierarchy update:<ul>
<li>Deterministic.</li>
</ul>
</li>
</ul>
<h2>Asynchronous Multilevel Monte Carlo</h2>
<ul>
<li>This algorithm is equivalent to MLMC, but designed for running in distributed environments. It avoids idle times and keeps at maximum the computational efficiency.</li>
<li>Levels of parallelism:<ul>
<li>Between batches,</li>
<li>Between levels,</li>
<li>Between samples,</li>
<li>On each sample at solver level.</li>
</ul>
</li>
<li>Hierarchy update:<ul>
<li>Deterministic.</li>
</ul>
</li>
</ul>
<h2>Continuation Multilevel Monte Carlo</h2>
<ul>
<li>A set of decreasing tolerances is used and updated on the fly to adaptively estimate the hierarchy and run MLMC.</li>
<li>Levels of parallelism:<ul>
<li>Between levels,</li>
<li>Between samples,</li>
<li>On each sample at solver level.</li>
</ul>
</li>
<li>Hierarchy update:<ul>
<li>Adaptive.</li>
</ul>
</li>
</ul>
<h1>Statistical tools</h1>
<h2>Power sums</h2>
<ul>
<li>Update on the fly of power sums.</li>
<li> align="center"A power sum of order p is defined as: </li>
</ul>
<p><img src="https://render.githubusercontent.com/render/math?math=S_p^N:=\sum_{i=1}^{N}(Q(w^{(i)}))^p" alt="" class="inline"/> . </p>
<h2>h-statistics</h2>
<ul>
<li>The h-statistic of order p is the unbiased estimator with minimal variance of the central moment of order p.</li>
<li> align="center"h-statistic dependencies are </li>
</ul>
<p><img src="https://render.githubusercontent.com/render/math?math=h_P:=f(S_p,N),p\in[1,P]" alt="" class="inline"/> . </p>
<h1>Convergence criteria</h1>
<ul>
<li>Convergence is achieved if the estimator of interest reaches a desired tolerance with respect to the true estimator with a given confidence.</li>
<li> align="center"The failure probability to satisfy (for expected value and MC) is </li>
</ul>
<p><img src="https://render.githubusercontent.com/render/math?math=\mathbb{P}[\left|\mathbb{E}^{MC}[Q_H]-\mathbb{E}[Q]\right|&gt;\varepsilon]&lt;\phi" alt="" class="inline"/> . </p>
<ul>
<li>Other convergence criteria available:<ul>
<li>Mean square error,</li>
<li>Sample variance criteria (MC only),</li>
<li>Higher order (up to the fourth) moments criteria (MC only).</li>
</ul>
</li>
</ul>
<h1>Hierarchy</h1>
<ul>
<li>Hierarchy strategies:<ul>
<li>stochastic adaptive refinement: hierarchy of levels built refining in space, performing solution-oriented adaptive space refinement. The coarsest mesh is shared between all realizations, and for each realization different meshes are generated, accordingly to the random variable. Requires compiling <code>MESHING_APPLICATION</code>.</li>
<li>deterministic adaptive refinement: hierarchy of levels built refining in space, performing solution-oriented adaptive space refinement. All meshes are shared between all realizations, and adaptive refinement is done at pre-process, exploiting a user-defined random variable. Requires compiling <code>MESHING_APPLICATION</code>.</li>
<li>standard: the user takes care of building the hierarchy, using the strategy he prefers (such as uniform refinement).</li>
</ul>
</li>
<li>Metric strategies:<ul>
<li>geometric error estimate: the analysis of the hessian of the numerical solution controls the mesh refinement.</li>
<li>divergence-free error estimate: the analysis of the mass conservation controls the mesh refinement (suitable only for CFD cases). Requires compiling <code>EXAQUTE_SANDBOX_APPLICATION</code>. <em>In progress</em>.</li>
</ul>
</li>
</ul>
<h1>External Libraries</h1>
<p><a class="el" href="../../dd/db0/namespace_multilevel_monte_carlo_application.html">MultilevelMonteCarloApplication</a> makes use of third part libraries. Information about these libraries can be found in their respective pages, which are listed below.</p>
<h2>XMC</h2>
<p><a href="https://gitlab.com/RiccardoRossi/exaqute-xmc">XMC</a> [3] is a Python library, with BSD 4 license, designed for hierarchical Monte Carlo methods. The library develops the above-mentioned algorithms, statistical tools and convergence criteria. The library presents a natural integration with <a class="el" href="../../db/d66/namespace_kratos.html" title="REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.">Kratos</a>, which is XMC default solver. By default, an internal version of the library is used. If one wants to use an external version of the library, the environment variable <code>XMC_BACKEND=external</code> should be set.</p>
<h2>PyCOMPSs</h2>
<p>PyCOMPSs is the Python library required in order to use task-based programming software <a href="https://www.bsc.es/research-and-development/software-and-apps/software-list/comp-superscalar">COMPSs</a> in a Python environment. By default PyCOMPSs is not required in order to run the application. In case one wants to run using this library, the environment variable <code>EXAQUTE_BACKEND=pycompss</code> must be set. The current version is able to run several thousands of samples at once exploiting PyCOMPSs in distributed systems, maximizing parallelism and computational efficiency. Optimal scalability up to 128 working nodes (6144 CPUs) has been demonstrated with both OpenMP and MPI parallelisms.</p>
<p>Instructions for the installation can be found in the <a href="https://github.com/KratosMultiphysics/Kratos/wiki/How-to-run-multiple-cases-using-PyCOMPSs">Kratos wiki</a>. To run with <code>runcompss</code>, the environment variable <code>EXAQUTE_BACKEND=pycompss</code> must be set to use the distributed computing capabilities. Additionally, running with <code>runcompss</code> requires to add to the <code>PYTHONPATH</code> the path of the XMC library, that is <code>/path/to/Kratos/applications/MultilevelMonteCarloApplication/external_libraries/XMC</code>. You can add the library to the <code>PYTHONPATH</code> either in the <code>.bashrc</code> file, or directly when running the code using the <code>runcompss</code> key <code>--pythonpath</code>. We refer to the <a href="https://github.com/KratosMultiphysics/Kratos/wiki/How-to-run-multiple-cases-using-PyCOMPSs#running-with-pycompss">Kratos wiki</a> for details.</p>
<h2>Mmg and ParMmg</h2>
<p><a href="https://www.mmgtools.org/">Mmg</a> is an open source software for simplicial remeshing. It provides 3 applications and 4 libraries. Instructions for installing Mmg can be found in the <a href="https://github.com/KratosMultiphysics/Kratos/wiki/%5BUtilities%5D-MMG-Process">Kratos wiki</a>. ParMmg is the MPI parallel version of the remeshing library Mmg. Instructions for installing ParMmg can be found in the <a href="https://github.com/KratosMultiphysics/Kratos/wiki/%5BUtilities%5D-ParMmg-Process">Kratos wiki</a>.</p>
<h1>Scalability</h1>
<p>&lt;figure&gt; <img src="https://github.com/KratosMultiphysics/Documentation/blob/master/Readme_files/MultilevelMonteCarloApplication/scalability.png" alt="" class="inline"/> &lt;figcaption style="text-align: justify"&gt; AMC and AMLMC denote the asynchronous Monte Carlo and the asynchronous Multilevel Monte Carlo methods, respectively. Sources: [1] and [4].&lt;/figcaption&gt; &lt;/figure&gt;</p>
<h1>Examples</h1>
<p>Many examples can be found in the <a href="https://github.com/KratosMultiphysics/Examples/tree/master/multilevel_monte_carlo">Kratos Multiphysics Examples repository</a>.</p>
<h1>License</h1>
<p>The <a class="el" href="../../dd/db0/namespace_multilevel_monte_carlo_application.html">MultilevelMonteCarloApplication</a> is OPEN SOURCE. The main code and program structure are available and aimed to grow with the need of any user willing to expand it. The BSD (Berkeley Software Distribution) licence allows to use and distribute the existing code without any restriction, but with the possibility to develop new parts of the code on an open or close basis depending on the developers.</p>
<h1>Main References</h1>
<p>[1] Tosi, R., Amela, R., Badia, R. M. &amp; Rossi, R. (2021). A Parallel Dynamic Asynchronous Framework for Uncertainty Quantification by Hierarchical Monte Carlo Algorithms. Journal of Scientific Computing. <a href="https://doi.org/10.1007/s10915-021-01598-6">https://doi.org/10.1007/s10915-021-01598-6</a></p>
<p>[2] Tosi, R., Núñez, M., Pons-Prats, J., Principe, J. &amp; Rossi, R. (2022). On the use of ensemble averaging techniques to accelerate the Uncertainty Quantification of CFD predictions in wind engineering. Journal of Wind Engineering and Industrial Aerodynamics. <a href="https://doi.org/10.1016/j.jweia.2022.105105">https://doi.org/10.1016/j.jweia.2022.105105</a></p>
<p>[3] Amela, R., Ayoul-Guilmard, Q., Badia, R. M., Ganesh, S., Nobile, F., Rossi, R., &amp; Tosi, R. (2019). ExaQUte XMC. <a href="https://doi.org/10.5281/zenodo.3235833">https://doi.org/10.5281/zenodo.3235833</a></p>
<p>[4] Ejarque, J., Böhm, S., Tosi, R., Núñez, M., &amp; Badia, R. M. (2021). D4.5 Framework development and release. ExaQUte consortium.</p>
<h1>Contact</h1>
<ul>
<li><b>Riccardo Rossi</b> - <em>Group Leader</em> - <a href="#" onclick="location.href='mai'+'lto:'+'rro'+'ss'+'i@c'+'im'+'ne.'+'up'+'c.e'+'du'; return false;">rrossi@cimne.upc.edu</a></li>
<li><b>Riccardo Tosi</b> - <em>Developer</em> - <a href="#" onclick="location.href='mai'+'lto:'+'rto'+'si'+'@ci'+'mn'+'e.u'+'pc'+'.ed'+'u'; return false;">rtosi@cimne.upc.edu</a></li>
<li><b>Marc Núñez</b> - <em>Developer</em> - <a href="#" onclick="location.href='mai'+'lto:'+'mnu'+'ne'+'z@c'+'im'+'ne.'+'up'+'c.e'+'du'; return false;">mnunez@cimne.upc.edu</a></li>
<li><b>Ramon Amela</b> - <em>Developer</em> - <a href="#" onclick="location.href='mai'+'lto:'+'ram'+'on'+'.am'+'el'+'a@b'+'sc'+'.es'; return false;">ramon.amela@bsc.es</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jun 2 2023 02:34:30 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
