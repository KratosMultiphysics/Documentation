<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: Geomechanics Time Integration Schemes</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Geomechanics Time Integration Schemes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Introduction</h1>
<p>The <code>Scheme</code> class in <a class="el" href="../../db/d66/namespace_kratos.html" title="REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.">Kratos</a> is used to create time integration schemes. It is a base class, for which Geomechanics has implemented a number of flavors, subdivided in the Backward Euler and the Generalized Newmark families.</p>
<h1>Code Structure</h1>
<p>The bulk of the functionality is implemented in the <code>GeoMechanicsTimeIntegrationScheme</code> class. It contains two lists of variables that are used in the time integration schemes. A list of first order scalar variables (such as water pressure or temperature) and a list of second order vector variables (such as displacements or rotations). For the first order time derivatives, only the first time derivative is taken into account, while for the second order time derivatives, both the first and the second time derivatives are considered. These lists are filled in the constructor by derived classes that specify which variables are used in the time integration scheme.</p>
<p>The functions that the <code>GeoMechanicsTimeIntegrationScheme</code> class implements are mostly dictated by the <code>Scheme</code> interface and include functionality like checking if all variables are allocated in the modelpart, getting <em>DofLists, EquationIds</em> and calling different flavors of the Initialize/Finalize/CalculateSystemContributions functions on elements and conditions.</p>
<p>It also has a general <code>Update</code> step, which calls the <code>UpdateVariablesDerivatives</code> function. This is a purely virtual function that has to be implemented by the derived classes. This is because the actual updating of the derivatives, defines a time integration scheme. The derived classes then use the lists of variables to update the derivatives. In our structure (see the class diagram), only the <code>BackwardEulerScheme</code> and the <code>GeneralizedNewmarkScheme</code> classes implement this function. Similarly the <code>SetTimeFactors</code> function, updates the delta time, but also the time coefficients, for which the overrides are found in the derived classes. For the specific equations, see sections <a href="../../#backward-euler">Backward Euler</a> and <a href="../../#generalized-newmark">Generalized Newmark</a>.</p>
<p><img src="../../SchemeStructure.svg" alt="SchemeStructure.svg" style="pointer-events: none;" class="inline"/> <em>Class structure of the schemes generated using the SchemeStructure.puml file with PlantUML. Note that the class diagram is simplified and only shows the functions that need emphasis.</em></p>
<p>The child classes which actually specify which variables are used in the time integration scheme (e.g. the <code>BackwardEulerUPwScheme</code> or the <code>GeneralizedNewmarkTScheme</code>), only fill the lists of first/second order variables.</p>
<p>The exceptions are the <code>NewmarkQuasistaticUPwScheme</code>, which has functionality for nodal smoothing (this should be moved to another location) and the damped and dynamic UPw schemes. More info on these can be found in the <a href="../../#dynamic-and-damped-schemes">Dynamic and damped schemes</a> section.</p>
<h1>Backward Euler</h1>
<p>The most straight-forward scheme type is called Backward Euler. The functionality described in this section can be found in the <code>BackwardEulerScheme</code> class. The first and second time derivatives are simply calculated by dividing the difference in their integrated variables by the time step. This results in the following equations for the scalar and vector derivatives.</p>
<p>First order scalar derivatives, in <code>UpdateScalarTimeDerivative</code>: $$</p><div class="dotgraph">
<div class="caption">
{x} _{t + \Delta t} = (x_{t + \Delta t} - x_{t} ) / \Delta t$$</div>
</div>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 11 2024 03:21:26 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
