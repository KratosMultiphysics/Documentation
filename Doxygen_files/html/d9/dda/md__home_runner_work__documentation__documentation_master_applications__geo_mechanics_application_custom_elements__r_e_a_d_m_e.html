<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: Transient Thermal Element</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Transient Thermal Element </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Introduction</h1>
<p>The calculation of geothermal processes relies on a profound understanding of heat transport mechanisms within the Earth's subsurface. Central to this understanding is the heat transport equation. In this context, the heat transport equation becomes a linchpin for designing sustainable and efficient geothermal systems.</p>
<h1>Governing Equations</h1>
<p>The primary governing equation for heat transport in geothermal applications is the heat convection-conduction equation, which describes how heat flows through a porous medium.</p>
<p>$$ \left(n S \rho^w c^w + (1- n) \rho^s c^s \right) \frac{\partial T}{\partial t} = -\rho^w c^w q_i \frac{\partial T}{\partial x_i} + \frac{\partial}{\partial x_i} \left( D_{ij} \frac{\partial T}{\partial x_j} \right) \qquad \text{on} \quad \Omega $$</p>
<p>where,</p>
<ul>
<li>$c^w$ = specific heat capacity liquid phase $\mathrm{[J/kg ^{\circ}C]}$</li>
<li>$c^s$ = specific heat capacity solid phase $\mathrm{[J/kg ^{\circ}C]}$</li>
<li>$D_{ij}$ = hydrodynamic thermal dispersion $\mathrm{[W/m ^{\circ}C]}$</li>
<li>$T$ = temperature $\mathrm{[ ^{\circ}C]}$</li>
<li>$\rho^s$ = density solid phase $\mathrm{[kg/m^3]}$</li>
<li>$\rho^w$ = water density $\mathrm{[kg/m^3]}$</li>
<li>$q$ = specific discharge $\mathrm{[m/s]}$</li>
<li>$S$ = degree of saturation $\mathrm{[-]}$</li>
<li>$n$ = porosity $\mathrm{[-]}$</li>
</ul>
<p>The hydrodynamic thermal dispersion is defined as:</p>
<p>$$ D_{ij}= nS \lambda^w \delta_{ij} + \left(1-n\right) \lambda_{ij}^s + c^w \rho^w \left( (\alpha_l - \alpha_t) \frac{q_i q_j}{q} + \delta_{ij} \alpha_t q \right) $$</p>
<p>where</p>
<ul>
<li>$\alpha_l$ = longitudinal dispersivity $\mathrm{[m]}$</li>
<li>$\alpha_t$ = transverse dispersivity $\mathrm{[m]}$</li>
<li>$\delta_{ij}$ = Kronecker delta $\mathrm{[-]}$</li>
<li>$\lambda^w$ = thermal conductivity water $\mathrm{[W/m ^{\circ}C]}$</li>
<li>$\lambda^s$ = thermal conductivity solid matrix $\mathrm{[W/m ^{\circ}C]}$</li>
</ul>
<p>In the absence of ground water flow, these equations are simplified to,</p>
<p>$$ \left(n S \rho^w c^w + (1- n) \rho^s c^s \right) \frac{\partial T}{\partial t} = \frac{\partial}{\partial x_i} \left( D_{ij} \frac{\partial T}{\partial x_j} \right) \qquad \text{on} \quad \Omega $$</p>
<p>$$ D_{ij}= nS \lambda^w \delta_{ij} + \left(1-n\right) \lambda_{ij}^s $$</p>
<h1>Boundary Conditions</h1>
<h2>Dirichlet Boundary Condition</h2>
<p>$$ T = \overline T \qquad \text{on} \quad \Gamma_{1}^T $$</p>
<p>where $\overline T$ $\mathrm{\left[ ^{\circ}C \right]}$ is a prescribed temperature</p>
<h2>Neumann Boundary Condition</h2>
<p>$$ D_{ij} \frac{\partial T}{\partial x_j} n_i = \overline{f} \qquad \text{on} \quad \Gamma_{2}^T $$</p>
<p>where $\overline f$ $\mathrm{\left[ W/m^2 \right]}$ is a prescribed conductive heat flux.</p>
<h2>Robin Boundary Condition</h2>
<p>$$ D_{ij} \frac{\partial T}{\partial x_j} n_i = \overline{g} - \rho^w c^w q_n T \qquad \text{on} \quad \Gamma_{3}^T $$</p>
<p>where $\overline g$ $\mathrm{\left[ W/m^2 \right]}$ is a prescribed convective-conductive heat flux and $q_n$ is the specific discharge $\mathrm{\left[ m/s \right]}$ at the boundary.</p>
<h1>Derived Properties</h1>
<p>The density of the porous media $\rho$ $\mathrm{\left[ kg/m^3 \right]}$ is calculated as,</p>
<p>$$ \rho = n S \rho^w + \left( 1 - n \right) \rho^s $$</p>
<p>And the heat capacity of the porous media $C$ $\mathrm{\left[ J/m^{3 \circ}C \right]}$ is:</p>
<p>$$ C = n S \rho^w c^w + \left( 1 - n \right) \rho^s c^s $$</p>
<p>The thermal conductivity of the porous media $\lambda$ $\mathrm{\left[ W/m ^{\circ}C \right]}$</p>
<p>$$ \lambda = n S \lambda^w + \left( 1 - n \right) \lambda^s $$</p>
<p>dynamic viscosity $\mu$ $[\mathrm {Pas}$] of pure water as a function of temperature is given by:</p>
<p>$$ \mu = 2.4318 \cdot 10^{-5} \cdot 10^{{247.8} / {\left(T+133.0\right]}} $$</p>
<p>density of water $\rho^w$ $[\mathrm {kg/m^3}]$ is a function of temperature and Diersch (2014) proposes a sixth order Taylor expansion which is approximated here by:</p>
<p>$$ \rho^w = 9.998396 \cdot 10^2 + 6.764771 \cdot 10^{-2} \cdot T - 8.993699 \cdot 10^{-3} \cdot T^2 + 9.143518 \cdot 10^{-5} \cdot T^3 - 8.907391 \cdot 10^{-7} \cdot T^4 + 5.291959 \cdot 10^{-9} \cdot T^5 - 1.359813 \cdot 10^{-11} \cdot T^6 $$</p>
<p>Note: the dependency of water density and viscosity to temperature is user defined and the user can turn this feature on or off in the JSON file.</p>
<h1>Finite Element Formulation</h1>
<p><a class="el" href="../../db/d66/namespace_kratos.html" title="REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.">Kratos</a> solves the equations based on an incremental method. In the frame of Generalized Newmark method (GN11), the fully implicit incremental temperature formulation read as,</p>
<p>$$ \left(\frac{1}{\theta \Delta t} \boldsymbol{S} + \boldsymbol{A} + \boldsymbol{H} + \boldsymbol{W}^l \right) \boldsymbol{\Delta T} = \left( \frac{1}{\theta} - 1 \right) \boldsymbol{S} \frac{dT^n}{dt} - \left(\boldsymbol{A} + \boldsymbol{H} + \boldsymbol{W}^l \right) \boldsymbol{T}^{n} + \left( \boldsymbol{V} + \boldsymbol{W}^r \right) $$</p>
<p>with $\theta = 1$ this formulation leads to backward Euler formulation. It reads,</p>
<p>$$ \left(\frac{1}{\Delta t} \boldsymbol{S} + \boldsymbol{A} + \boldsymbol{H} + \boldsymbol{W}^l \right) \boldsymbol{\Delta T} = - \left(\boldsymbol{A} + \boldsymbol{H} + \boldsymbol{W}^l \right) \boldsymbol{T}^{n} + \left( \boldsymbol{V} + \boldsymbol{W}^r \right) $$</p>
<p>Note: the user can choose either Newmark or backward Euler from the JSON file.</p>
<p><em><b>Compressibility matrix</b></em></p>
<p>$$ \boldsymbol{S} = \int_{\Omega^e} \left( n S \rho^w c^w + \left(1-n\right) \rho^s c^s \right)^{n+1} \boldsymbol{N}^T \boldsymbol{N} d \Omega $$</p>
<p><em><b>Convectivity matrix</b></em></p>
<p>$$ \boldsymbol{A} = \int_{\Omega^e} \left(\rho^w c^w\right)^{n+1} \boldsymbol{N}^T \boldsymbol{q}^{T,n+1} \boldsymbol{\nabla N} d \Omega $$</p>
<p><em><b>Conductivity matrix</b></em></p>
<p>$$ \boldsymbol{H} = \int_{\Omega^e} \boldsymbol{\nabla N}^T \boldsymbol{D}^{n+1} \boldsymbol{\nabla N} d \Omega $$</p>
<p><em><b>Neumann condition (conductive boundary)</b></em></p>
<p>$$ \boldsymbol{V} = \int_{\Gamma_2^{ep}} f^{n+1} \boldsymbol{N}^T d \Gamma $$</p>
<p><em><b>Robin condition (convective boundary)</b></em></p>
<p>$$ \boldsymbol{W^r} = \int_{\Gamma_3^{ep}} g^{n+1} \boldsymbol{N}^T d \Gamma $$</p>
<p>$$ \boldsymbol{W^l} = \int_{\Gamma_3^{ep}} \left( \rho^w c^w q_n \right)^{n+1} \boldsymbol{N}^T \boldsymbol{I} d \Gamma $$</p>
<p>where</p>
<ul>
<li>$\Delta t$ = time step $\mathrm{\left[s \right]}$</li>
<li>$\Delta T$ = temperature increment $T^{n+1} - T^n$ $\mathrm{\left[^\circ C \right]}$</li>
<li>$\boldsymbol N$ = shape function array $\mathrm{\left[ - \right]}$</li>
<li>$\theta$ = a coefficient in Newmark time integration $\mathrm{\left[ - \right]}$</li>
<li>$\Omega$ = domain region</li>
<li>$\Gamma$ = boundary region</li>
</ul>
<p>The superscripts $^l$ and $^r$ for Robin boundary condition indicate the left hands side (matrix) and right hand side (vector), respectively. The superscripts $^e$ and $^{ep}$ for $\Omega$ and $\Gamma$ indicate values in the element volume and perpendicular to element boundaries, respectively. <br  />
</p>
<h1>Bibliography</h1>
<p>Diersch, H.-J. G., 2014. FEFLOW; Finite Element Modeling of Flow, Mass and Heat Transport in Porous and Fractured Media. Springer. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 10 2024 02:52:26 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
