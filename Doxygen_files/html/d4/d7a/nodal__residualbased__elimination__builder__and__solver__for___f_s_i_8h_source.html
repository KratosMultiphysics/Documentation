<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: /home/runner/work/Documentation/Documentation/master/applications/PfemFluidDynamicsApplication/custom_strategies/builders_and_solvers/nodal_residualbased_elimination_builder_and_solver_for_FSI.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_77f11c234ba493b7b4b1588a3dc15f04.html">PfemFluidDynamicsApplication</a></li><li class="navelem"><a class="el" href="../../dir_c3e133ab6d88e8e18053390906efbe84.html">custom_strategies</a></li><li class="navelem"><a class="el" href="../../dir_48e518adbd9164925cb2b448a83576b7.html">builders_and_solvers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">nodal_residualbased_elimination_builder_and_solver_for_FSI.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d7a/nodal__residualbased__elimination__builder__and__solver__for___f_s_i_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//    |  /           |</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//    &#39; /   __| _` | __|  _ \   __|</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//    . \  |   (   | |   (   |\__ `</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//   _|\_\_|  \__,_|\__|\___/ ____/</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//                   Multi-Physics</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  License:       BSD License</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//                Kratos default license: kratos/license.txt</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  Main authors:    Riccardo Rossi, Alessandro Franci</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#if !defined(KRATOS_NODAL_RESIDUAL_BASED_ELIMINATION_BUILDER_AND_SOLVER_FOR_FSI)</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#define KRATOS_NODAL_RESIDUAL_BASED_ELIMINATION_BUILDER_AND_SOLVER_FOR_FSI</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">/* System includes */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/* External includes */</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// #define USE_GOOGLE_HASH</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifdef USE_GOOGLE_HASH</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;sparsehash/dense_hash_set&quot;</span> <span class="comment">//included in external libraries</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;unordered_set&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/* Project includes */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/dd0/timer_8h.html">utilities/timer.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d67/define_8h.html">includes/define.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/d48/key__hash_8h.html">includes/key_hash.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/da7/builder__and__solver_8h.html">solving_strategies/builder_and_solvers/builder_and_solver.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dfe/model__part_8h.html">includes/model_part.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/ddd/nodal__residualbased__elimination__builder__and__solver_8h.html">nodal_residualbased_elimination_builder_and_solver.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d6b/pfem__fluid__dynamics__application__variables_8h.html">pfem_fluid_dynamics_application_variables.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../db/d66/namespace_kratos.html">Kratos</a></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">class </span>TSparseSpace,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keyword">class </span>TDenseSpace,  <span class="comment">//= DenseSpace&lt;double&gt;,</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keyword">class </span>TLinearSolver <span class="comment">//= LinearSolver&lt;TSparseSpace,TDenseSpace&gt;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            &gt;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html">   80</a></span>&#160;  <span class="keyword">class </span><a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html">NodalResidualBasedEliminationBuilderAndSolverForFSI</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html">NodalResidualBasedEliminationBuilderAndSolver</a>&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">public</span>:</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a38ba6062d38e541932ef27871f27d809">   85</a></span>&#160;    <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a38ba6062d38e541932ef27871f27d809">KRATOS_CLASS_POINTER_DEFINITION</a>(<a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html">NodalResidualBasedEliminationBuilderAndSolverForFSI</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1e9eaba95d182df50bcc8146d27cb17c">   87</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html">NodalResidualBasedEliminationBuilderAndSolver&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1e9eaba95d182df50bcc8146d27cb17c">BaseType</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1c4a0c09ee68fc475090afd691b44f63">   89</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d1/da3/class_kratos_1_1_scheme.html">BaseType::TSchemeType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1c4a0c09ee68fc475090afd691b44f63">TSchemeType</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae9f9fa5aa1a15f1996e9a9dd4c8c6f50">   91</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3ff99928e183457c245f57952f1707c">BaseType::TDataType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae9f9fa5aa1a15f1996e9a9dd4c8c6f50">TDataType</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a90429a66a5247c0817286a244177b6f5">   93</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">BaseType::DofsArrayType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a90429a66a5247c0817286a244177b6f5">DofsArrayType</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae2b0f7d8efc5b3a9d80ded8bd20c50fc">   95</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">BaseType::TSystemMatrixType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae2b0f7d8efc5b3a9d80ded8bd20c50fc">TSystemMatrixType</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">   97</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">BaseType::TSystemVectorType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">TSystemVectorType</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">   99</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">BaseType::LocalSystemVectorType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">LocalSystemVectorType</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">  101</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">BaseType::LocalSystemMatrixType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">LocalSystemMatrixType</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af0e05a6a19c238e4f51972c7e7c5929f">  103</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ad7cf31210f73d447ba2969921bf30065">BaseType::TSystemMatrixPointerType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af0e05a6a19c238e4f51972c7e7c5929f">TSystemMatrixPointerType</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aaa29a2d5739f8c5923e09083e5711a83">  104</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">BaseType::TSystemVectorPointerType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aaa29a2d5739f8c5923e09083e5711a83">TSystemVectorPointerType</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac50df92d3663e24c6bc9d1c34a360d84">  106</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d5/ddd/class_kratos_1_1_node.html">Node</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac50df92d3663e24c6bc9d1c34a360d84">NodeType</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a98795f4131971a9731c0e4823775eb76">  108</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a33b83c3e857167ce8816b2425ef07364">BaseType::NodesArrayType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a98795f4131971a9731c0e4823775eb76">NodesArrayType</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae1a9a1694c4529f69f559f3eaabdbea2">  109</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae8971ea9fbe6bfb776a4e3cb86b4b66e">BaseType::ElementsArrayType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae1a9a1694c4529f69f559f3eaabdbea2">ElementsArrayType</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76ebf318e314cd1dab24aed1cae2cdb1">  110</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a5e418b9a6309ffa92898291532bdeba4">BaseType::ConditionsArrayType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76ebf318e314cd1dab24aed1cae2cdb1">ConditionsArrayType</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae96724250229bcf10a03fd47f81e7b8a">  112</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">BaseType::ElementsContainerType</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae96724250229bcf10a03fd47f81e7b8a">ElementsContainerType</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aba2d8f5bbe4b55366ee8fac411bb3477">  114</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Vector</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aba2d8f5bbe4b55366ee8fac411bb3477">VectorType</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a67261ff0a40c8a6cef7bcdb89e26920a">  115</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">GlobalPointersVector&lt;Node&gt;</a> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a67261ff0a40c8a6cef7bcdb89e26920a">NodeWeakPtrVectorType</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aa44d52cdb8c4882076d8ff48be5d753c">  123</a></span>&#160;    <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aa44d52cdb8c4882076d8ff48be5d753c">NodalResidualBasedEliminationBuilderAndSolverForFSI</a>(</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">typename</span> TLinearSolver::Pointer pNewLinearSystemSolver)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        : <a class="code" href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html">NodalResidualBasedEliminationBuilderAndSolver</a>&lt;TSparseSpace, TDenseSpace, TLinearSolver&gt;(pNewLinearSystemSolver)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">//         KRATOS_INFO(&quot;NodalResidualBasedEliminationBuilderAndSolverForFSI&quot;) &lt;&lt; &quot;Using the standard builder and solver &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a45c58cfc63cf813a8eff6f4c7ebcd82a">  132</a></span>&#160;    <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a45c58cfc63cf813a8eff6f4c7ebcd82a">~NodalResidualBasedEliminationBuilderAndSolverForFSI</a>()<span class="keyword"> override</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a65f8f6bc7aaecb99468e45ac16e77b46">  144</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a65f8f6bc7aaecb99468e45ac16e77b46">SetMaterialPropertiesToSolid</a>(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> itNode,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordtype">double</span> &amp;<a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a>,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">double</span> &amp;deviatoricCoeff,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">double</span> &amp;volumetricCoeff,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">double</span> timeInterval,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordtype">double</span> nodalVolume)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> = itNode-&gt;FastGetSolutionStepValue(SOLID_DENSITY);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="keywordtype">double</span> youngModulus = itNode-&gt;FastGetSolutionStepValue(YOUNG_MODULUS);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">double</span> poissonRatio = itNode-&gt;FastGetSolutionStepValue(POISSON_RATIO);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      deviatoricCoeff = timeInterval * youngModulus / (1.0 + poissonRatio) * 0.5;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      volumetricCoeff = timeInterval * poissonRatio * youngModulus / ((1.0 + poissonRatio) * (1.0 - 2.0 * poissonRatio)) + 2.0 * deviatoricCoeff / 3.0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76986c43775354f16f4009d1156bf549">  161</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76986c43775354f16f4009d1156bf549">BuildSolidNodally</a>(</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordtype">double</span> hybridCoeff)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a>(!pScheme) &lt;&lt; <span class="stringliteral">&quot;No scheme provided!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// contributions to the system</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">LocalSystemMatrixType</a> solidLHS_Contribution = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">LocalSystemMatrixType</a>(0, 0);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">LocalSystemVectorType</a> solidRHS_Contribution = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">LocalSystemVectorType</a>(0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="comment">// vector containing the localization in the system of the different terms</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> solidEquationId;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a> &amp;CurrentProcessInfo = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a020aafc9231da6da0aaa7c49b89ad8d9">ElementsBegin</a>()-&gt;GetGeometry().WorkingSpaceDimension();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> timeInterval = CurrentProcessInfo[DELTA_TIME];</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> FourThirds = 4.0 / 3.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> nTwoThirds = -2.0 / 3.0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordtype">double</span> theta = 1.0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> Acc(3, 0.0);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordtype">double</span> dNdXi = 0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordtype">double</span> dNdYi = 0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordtype">double</span> dNdZi = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordtype">double</span> dNdXj = 0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordtype">double</span> dNdYj = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordtype">double</span> dNdZj = 0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstRow = 0;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstCol = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> = 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="keywordtype">double</span> deviatoricCoeff = 0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordtype">double</span> volumetricCoeff = 0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordtype">double</span> dynamics = 1.0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">/* #pragma omp parallel */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">//    {</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> NodesBegin;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> NodesEnd;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a9fc68ec4d0fa71f7bdbb95bf636ef8f3">OpenMPUtils::PartitionedIterators</a>(rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>(), NodesBegin, NodesEnd);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordtype">double</span> numNodesForExternalForce = 0;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordtype">double</span> nodalExternalForce = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordtype">bool</span> belytsckoCase = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordtype">bool</span> cooksMembraneCase = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordflow">if</span> (cooksMembraneCase == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> itNode = NodesBegin; itNode != NodesEnd; ++itNode)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <span class="keywordtype">double</span> posX = itNode-&gt;X0();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordflow">if</span> (posX &gt; 47.999 &amp;&amp; posX &lt; 48.001)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            numNodesForExternalForce += 1.0;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span> (numNodesForExternalForce &gt; 0)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;          nodalExternalForce = 1.0 / numNodesForExternalForce;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">if</span> (belytsckoCase == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> itNode = NodesBegin; itNode != NodesEnd; ++itNode)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;          <span class="keywordtype">double</span> posX = itNode-&gt;X0();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          <span class="keywordflow">if</span> (posX &gt; 24.999 &amp;&amp; posX &lt; 25.001)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            numNodesForExternalForce += 1.0;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;          }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">if</span> (numNodesForExternalForce &gt; 0)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          nodalExternalForce = 40.0 / numNodesForExternalForce;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> itNode = NodesBegin; itNode != NodesEnd; ++itNode)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span> (itNode-&gt;Is(SOLID))</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">NodeWeakPtrVectorType</a> &amp;neighb_nodes = itNode-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Vector</a> solidNodalSFDneighboursId = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS_ORDER);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighSize = solidNodalSFDneighboursId.size();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> nodalVolume = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_VOLUME);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;          <span class="keywordflow">if</span> (neighSize &gt; 1 &amp;&amp; nodalVolume &gt; 0)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> localSize = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS).size();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">if</span> (solidLHS_Contribution.size1() != localSize)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;              solidLHS_Contribution.<a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(localSize, localSize, <span class="keyword">false</span>); <span class="comment">// false says not to preserve existing storage!!</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (solidRHS_Contribution.size() != localSize)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;              solidRHS_Contribution.resize(localSize, <span class="keyword">false</span>); <span class="comment">// false says not to preserve existing storage!!</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">if</span> (solidEquationId.size() != localSize)</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;              solidEquationId.resize(localSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(solidLHS_Contribution) = <a class="code" href="../../db/d66/namespace_kratos.html#a358df20da9726efb77013692eb628f08">ZeroMatrix</a>(localSize, localSize);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(solidRHS_Contribution) = <a class="code" href="../../db/d66/namespace_kratos.html#a0060702fbd6c7d45c773436101c9ded3">ZeroVector</a>(localSize);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            this-&gt;<a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a65f8f6bc7aaecb99468e45ac16e77b46">SetMaterialPropertiesToSolid</a>(itNode, <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a>, deviatoricCoeff, volumetricCoeff, timeInterval, nodalVolume);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            firstRow = 0;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            firstCol = 0;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 2)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              solidLHS_Contribution(0, 0) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 * dynamics / timeInterval;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              solidLHS_Contribution(1, 1) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 * dynamics / timeInterval;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;              <span class="comment">//-------- DYNAMIC FORCES TERM -------//</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;              Acc = 2.0 * (itNode-&gt;FastGetSolutionStepValue(VELOCITY, 0) - itNode-&gt;FastGetSolutionStepValue(VELOCITY, 1)) / timeInterval - itNode-&gt;FastGetSolutionStepValue(ACCELERATION, 0);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;              solidRHS_Contribution[0] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[0] * dynamics;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;              solidRHS_Contribution[1] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[1] * dynamics;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;              <span class="comment">//-------- EXTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> &amp;VolumeAcceleration = itNode-&gt;FastGetSolutionStepValue(VOLUME_ACCELERATION);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;              <span class="comment">// double posX= itNode-&gt;X();</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;              <span class="comment">// double posY= itNode-&gt;Y();</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;              <span class="comment">// double coeffX =(12.0-24.0*posY)*pow(posX,4);</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;              <span class="comment">// coeffX += (-24.0+48.0*posY)*pow(posX,3);</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;              <span class="comment">// coeffX += (-48.0*posY+72.0*pow(posY,2)-48.0*pow(posY,3)+12.0)*pow(posX,2);</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;              <span class="comment">// coeffX += (-2.0+24.0*posY-72.0*pow(posY,2)+48.0*pow(posY,3))*posX;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;              <span class="comment">// coeffX += 1.0-4.0*posY+12.0*pow(posY,2)-8.0*pow(posY,3);</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;              <span class="comment">// double coeffY =(8.0-48.0*posY+48.0*pow(posY,2))*pow(posX,3);</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;              <span class="comment">// coeffY += (-12.0+72.0*posY-72.0*pow(posY,2))*pow(posX,2);</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              <span class="comment">// coeffY += (4.0-24.0*posY+48.0*pow(posY,2)-48.0*pow(posY,3)+24.0*pow(posY,4))*posX;</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              <span class="comment">// coeffY += -12.0*pow(posY,2)+24.0*pow(posY,3)-12.0*pow(posY,4);</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;              <span class="comment">// RHS_Contribution[0]+=nodalVolume*density*VolumeAcceleration[0]*coeffX;</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;              <span class="comment">// RHS_Contribution[1]+=nodalVolume*density*VolumeAcceleration[1]*coeffY;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              solidRHS_Contribution[0] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[0];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;              solidRHS_Contribution[1] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[1];</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;              <span class="comment">//  if(itNode-&gt;X0()&gt;24.999){</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;              <span class="comment">// solidRHS_Contribution[1]+=40.0/2.0;  // mesh 4      (1 element per edge)</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;              <span class="comment">// solidRHS_Contribution[1]+=40.0/3.0;  // mesh 2      (2 element per edge)</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;              <span class="comment">// solidRHS_Contribution[1]+=40.0/5.0;  // mesh 1      (4 element per edge)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;              <span class="comment">// solidRHS_Contribution[1]+=40.0/9.0;  // mesh 0.5    (8 element per edge)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;              <span class="comment">//  solidRHS_Contribution[1]+=40.0/17.0; // mesh 0.25   (16 element per edge)</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;              <span class="comment">// solidRHS_Contribution[1]+=40.0/33.0; // mesh 0.125  (32 element per edge)</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;              <span class="comment">// solidRHS_Contribution[1]+=40.0/65.0; // mesh 0.0625 (64 element per edge)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;              <span class="comment">//}</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;              <span class="keywordflow">if</span> (belytsckoCase == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;              {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">if</span> (itNode-&gt;X0() &gt; 24.999 &amp;&amp; itNode-&gt;X0() &lt; 25.001)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                  solidRHS_Contribution[1] += nodalExternalForce;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;              }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;              <span class="keywordflow">if</span> (cooksMembraneCase == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;              {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <span class="keywordflow">if</span> (itNode-&gt;X0() &gt; 47.999 &amp;&amp; itNode-&gt;X0() &lt; 48.001)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                  solidRHS_Contribution[1] += nodalExternalForce;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;              }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;              <span class="comment">//-------- INTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> Sigma(3, 0.0);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;              Sigma = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_CAUCHY_STRESS);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xDofPos = itNode-&gt;GetDofPosition(VELOCITY_X);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;              solidEquationId[0] = itNode-&gt;GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;              solidEquationId[1] = itNode-&gt;GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighSize; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;              {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                dNdXi = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstCol];</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                dNdYi = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstCol + 1];</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                solidRHS_Contribution[firstCol] += -nodalVolume * (dNdXi * Sigma[0] + dNdYi * Sigma[2]) * hybridCoeff;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                solidRHS_Contribution[firstCol + 1] += -nodalVolume * (dNdYi * Sigma[1] + dNdXi * Sigma[2]) * hybridCoeff;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; neighSize; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                  dNdXj = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstRow];</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  dNdYj = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstRow + 1];</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                  solidLHS_Contribution(firstRow, firstCol) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdXi + dNdYj * dNdYi * deviatoricCoeff) * theta * hybridCoeff;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                  solidLHS_Contribution(firstRow, firstCol + 1) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdYi + dNdYj * dNdXi * deviatoricCoeff) * theta * hybridCoeff;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                  solidLHS_Contribution(firstRow + 1, firstCol) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdXi + dNdXj * dNdYi * deviatoricCoeff) * theta * hybridCoeff;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                  solidLHS_Contribution(firstRow + 1, firstCol + 1) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdYi + dNdXj * dNdXi * deviatoricCoeff) * theta * hybridCoeff;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                  firstRow += 2;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                firstRow = 0;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                firstCol += 2;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexNode = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                <span class="keywordflow">if</span> (itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span> &amp;&amp; indexNode &lt; neighSize)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> other_neigh_nodes_id = solidNodalSFDneighboursId[indexNode];</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                  {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neigh_nodes_id = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].Id();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    <span class="keywordflow">if</span> (neigh_nodes_id == other_neigh_nodes_id)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                      solidEquationId[firstCol] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                      solidEquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                  }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>())</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                  solidEquationId[firstCol] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                  solidEquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;              }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;              solidLHS_Contribution(0, 0) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;              solidLHS_Contribution(1, 1) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;              solidLHS_Contribution(2, 2) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;              <span class="comment">//-------- DYNAMIC FORCES TERM -------//</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;              Acc = 2.0 * (itNode-&gt;FastGetSolutionStepValue(VELOCITY, 0) - itNode-&gt;FastGetSolutionStepValue(VELOCITY, 1)) / timeInterval - itNode-&gt;FastGetSolutionStepValue(ACCELERATION, 0);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;              solidRHS_Contribution[0] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[0];</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;              solidRHS_Contribution[1] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[1];</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;              solidRHS_Contribution[2] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[2];</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;              <span class="comment">//-------- EXTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> &amp;VolumeAcceleration = itNode-&gt;FastGetSolutionStepValue(VOLUME_ACCELERATION);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              solidRHS_Contribution[0] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[0];</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;              solidRHS_Contribution[1] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[1];</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;              solidRHS_Contribution[2] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[2];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;              <span class="comment">// if(itNode-&gt;X0()&gt;24.999){</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;              <span class="comment">//   // solidRHS_Contribution[1]+=40.0/2.0;  // mesh 4      (1 element per edge)</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;              <span class="comment">//   // solidRHS_Contribution[1]+=40.0/3.0;  // mesh 2      (2 element per edge)</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;              <span class="comment">//   // solidRHS_Contribution[1]+=40.0/5.0;  // mesh 1      (4 element per edge)</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;              <span class="comment">//   solidRHS_Contribution[1]+=40.0/27.0;  // mesh 0.5    (8 element per edge, 2 per width)</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;              <span class="comment">//   // solidRHS_Contribution[1]+=40.0/17.0; // mesh 0.25   (16 element per edge)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;              <span class="comment">//   // solidRHS_Contribution[1]+=40.0/33.0; // mesh 0.125  (32 element per edge)</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;              <span class="comment">//   // solidRHS_Contribution[1]+=40.0/65.0; // mesh 0.0625 (64 element per edge)</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;              <span class="comment">// }</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;              <span class="comment">//-------- INTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 6&gt;</a> Sigma(6, 0.0);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;              Sigma = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_CAUCHY_STRESS);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xDofPos = itNode-&gt;GetDofPosition(VELOCITY_X);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;              solidEquationId[0] = itNode-&gt;GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;              solidEquationId[1] = itNode-&gt;GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;              solidEquationId[2] = itNode-&gt;GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighSize; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;              {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                dNdXi = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstCol];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                dNdYi = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstCol + 1];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                dNdZi = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstCol + 2];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                solidRHS_Contribution[firstCol] += -nodalVolume * (dNdXi * Sigma[0] + dNdYi * Sigma[3] + dNdZi * Sigma[4]);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                solidRHS_Contribution[firstCol + 1] += -nodalVolume * (dNdYi * Sigma[1] + dNdXi * Sigma[3] + dNdZi * Sigma[5]);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                solidRHS_Contribution[firstCol + 2] += -nodalVolume * (dNdZi * Sigma[2] + dNdXi * Sigma[4] + dNdYi * Sigma[5]);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; neighSize; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                  dNdXj = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstRow];</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                  dNdYj = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstRow + 1];</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                  dNdZj = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS)[firstRow + 2];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                  solidLHS_Contribution(firstRow, firstCol) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdXi + (dNdYj * dNdYi + dNdZj * dNdZi) * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                  solidLHS_Contribution(firstRow, firstCol + 1) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdYi + dNdYj * dNdXi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                  solidLHS_Contribution(firstRow, firstCol + 2) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdZi + dNdZj * dNdXi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                  solidLHS_Contribution(firstRow + 1, firstCol) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdXi + dNdXj * dNdYi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                  solidLHS_Contribution(firstRow + 1, firstCol + 1) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdYi + (dNdXj * dNdXi + dNdZj * dNdZi) * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                  solidLHS_Contribution(firstRow + 1, firstCol + 2) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdZi + dNdZj * dNdYi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                  solidLHS_Contribution(firstRow + 2, firstCol) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdZj * dNdXi + dNdXj * dNdZi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                  solidLHS_Contribution(firstRow + 2, firstCol + 1) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdZj * dNdYi + dNdYj * dNdZi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                  solidLHS_Contribution(firstRow + 2, firstCol + 2) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdZj * dNdZi + (dNdXj * dNdXi + dNdYj * dNdYi) * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                  firstRow += 3;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                firstRow = 0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                firstCol += 3;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexNode = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <span class="keywordflow">if</span> (itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span> &amp;&amp; indexNode &lt; neighSize)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> other_neigh_nodes_id = solidNodalSFDneighboursId[indexNode];</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                  {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neigh_nodes_id = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].Id();</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="keywordflow">if</span> (neigh_nodes_id == other_neigh_nodes_id)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                      solidEquationId[firstCol] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                      solidEquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                      solidEquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                  }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>())</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                  solidEquationId[firstCol] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                  solidEquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                  solidEquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;              }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec">Assemble</a>(<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>, solidLHS_Contribution, solidRHS_Contribution, solidEquationId, mlock_array);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec">Assemble</a>(<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>, solidLHS_Contribution, solidRHS_Contribution, solidEquationId);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="comment">//   }</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a6040ddc10ccc6f9363006a3fa9ede11f">  513</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a6040ddc10ccc6f9363006a3fa9ede11f">BuildFluidNodally</a>(</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <a class="code" href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a>(!pScheme) &lt;&lt; <span class="stringliteral">&quot;No scheme provided!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <span class="comment">/* std::cout&lt;&lt;&quot;Building LHS and RHS of Momentum Equation Nodally&quot;&lt;&lt;std::endl; */</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="comment">// contributions to the system</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">LocalSystemMatrixType</a> LHS_Contribution = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">LocalSystemMatrixType</a>(0, 0);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">LocalSystemVectorType</a> RHS_Contribution = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">LocalSystemVectorType</a>(0);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="comment">// vector containing the localization in the system of the different terms</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> EquationId;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a> &amp;CurrentProcessInfo = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a020aafc9231da6da0aaa7c49b89ad8d9">ElementsBegin</a>()-&gt;GetGeometry().WorkingSpaceDimension();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> timeInterval = CurrentProcessInfo[DELTA_TIME];</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> FourThirds = 4.0 / 3.0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> nTwoThirds = -2.0 / 3.0;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordtype">double</span> theta = 0.5;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> Acc(3, 0.0);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a> = 0;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordtype">double</span> dNdXi = 0;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordtype">double</span> dNdYi = 0;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordtype">double</span> dNdZi = 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordtype">double</span> dNdXj = 0;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordtype">double</span> dNdYj = 0;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordtype">double</span> dNdZj = 0;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstRow = 0;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstCol = 0;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> = 0;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordtype">double</span> deviatoricCoeff = 0;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordtype">double</span> volumetricCoeff = 0;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="comment">/* #pragma omp parallel */</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="comment">//    {</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> NodesBegin;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> NodesEnd;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <a class="code" href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a9fc68ec4d0fa71f7bdbb95bf636ef8f3">OpenMPUtils::PartitionedIterators</a>(rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>(), NodesBegin, NodesEnd);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> itNode = NodesBegin; itNode != NodesEnd; ++itNode)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">if</span> ((itNode-&gt;Is(FLUID) &amp;&amp; itNode-&gt;IsNot(SOLID)) || itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;          <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">NodeWeakPtrVectorType</a> &amp;neighb_nodes = itNode-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Vector</a> nodalSFDneighboursId = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS_ORDER);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighSize = nodalSFDneighboursId.size();</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> nodalVolume = itNode-&gt;FastGetSolutionStepValue(NODAL_VOLUME);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;          <span class="keywordflow">if</span> (neighSize &gt; 1 &amp;&amp; nodalVolume &gt; 0)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> localSize = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS).size();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <span class="keywordflow">if</span> (LHS_Contribution.size1() != localSize)</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;              LHS_Contribution.<a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(localSize, localSize, <span class="keyword">false</span>); <span class="comment">// false says not to preserve existing storage!!</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordflow">if</span> (RHS_Contribution.size() != localSize)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;              RHS_Contribution.resize(localSize, <span class="keyword">false</span>); <span class="comment">// false says not to preserve existing storage!!</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">if</span> (EquationId.size() != localSize)</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;              EquationId.resize(localSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(LHS_Contribution) = <a class="code" href="../../db/d66/namespace_kratos.html#a358df20da9726efb77013692eb628f08">ZeroMatrix</a>(localSize, localSize);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(RHS_Contribution) = <a class="code" href="../../db/d66/namespace_kratos.html#a0060702fbd6c7d45c773436101c9ded3">ZeroVector</a>(localSize);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            this-&gt;<a class="code" href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html#ac87e26beaa25e3e5eaa36c4e317c3dc5">SetMaterialPropertiesToFluid</a>(itNode, <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a>, deviatoricCoeff, volumetricCoeff, timeInterval, nodalVolume);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            firstRow = 0;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            firstCol = 0;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 2)</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;              LHS_Contribution(0, 0) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;              LHS_Contribution(1, 1) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;              <span class="comment">//-------- DYNAMIC FORCES TERM -------//</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;              Acc = 2.0 * (itNode-&gt;FastGetSolutionStepValue(VELOCITY, 0) - itNode-&gt;FastGetSolutionStepValue(VELOCITY, 1)) / timeInterval -</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                    itNode-&gt;FastGetSolutionStepValue(ACCELERATION, 0);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;              RHS_Contribution[0] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[0];</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;              RHS_Contribution[1] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[1];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;              <span class="comment">//-------- EXTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> &amp;VolumeAcceleration = itNode-&gt;FastGetSolutionStepValue(VOLUME_ACCELERATION);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;              <span class="comment">// double posX= itNode-&gt;X();</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;              <span class="comment">// double posY= itNode-&gt;Y();</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;              <span class="comment">// double coeffX =(12.0-24.0*posY)*pow(posX,4);</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;              <span class="comment">// coeffX += (-24.0+48.0*posY)*pow(posX,3);</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;              <span class="comment">// coeffX += (-48.0*posY+72.0*pow(posY,2)-48.0*pow(posY,3)+12.0)*pow(posX,2);</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;              <span class="comment">// coeffX += (-2.0+24.0*posY-72.0*pow(posY,2)+48.0*pow(posY,3))*posX;</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;              <span class="comment">// coeffX += 1.0-4.0*posY+12.0*pow(posY,2)-8.0*pow(posY,3);</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;              <span class="comment">// double coeffY =(8.0-48.0*posY+48.0*pow(posY,2))*pow(posX,3);</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;              <span class="comment">// coeffY += (-12.0+72.0*posY-72.0*pow(posY,2))*pow(posX,2);</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;              <span class="comment">// coeffY += (4.0-24.0*posY+48.0*pow(posY,2)-48.0*pow(posY,3)+24.0*pow(posY,4))*posX;</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;              <span class="comment">// coeffY += -12.0*pow(posY,2)+24.0*pow(posY,3)-12.0*pow(posY,4);</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              <span class="comment">// RHS_Contribution[0]+=nodalVolume*density*VolumeAcceleration[0]*coeffX;</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;              <span class="comment">// RHS_Contribution[1]+=nodalVolume*density*VolumeAcceleration[1]*coeffY;</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;              RHS_Contribution[0] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[0];</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;              RHS_Contribution[1] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[1];</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;              <span class="comment">//-------- INTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> Sigma(3, 0.0);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;              Sigma = itNode-&gt;FastGetSolutionStepValue(NODAL_CAUCHY_STRESS);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;              <span class="keywordflow">if</span> (itNode-&gt;IsNot(SOLID) || itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;              {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a> = itNode-&gt;FastGetSolutionStepValue(PRESSURE, 0) * theta + itNode-&gt;FastGetSolutionStepValue(PRESSURE, 1) * (1 - theta);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                Sigma[0] = itNode-&gt;FastGetSolutionStepValue(NODAL_DEVIATORIC_CAUCHY_STRESS)[0] + <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                Sigma[1] = itNode-&gt;FastGetSolutionStepValue(NODAL_DEVIATORIC_CAUCHY_STRESS)[1] + <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;              }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xDofPos = itNode-&gt;GetDofPosition(VELOCITY_X);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;              EquationId[0] = itNode-&gt;GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              EquationId[1] = itNode-&gt;GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighSize; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;              {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                dNdXi = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstCol];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                dNdYi = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstCol + 1];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                RHS_Contribution[firstCol] += -nodalVolume * (dNdXi * Sigma[0] + dNdYi * Sigma[2]);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                RHS_Contribution[firstCol + 1] += -nodalVolume * (dNdYi * Sigma[1] + dNdXi * Sigma[2]);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; neighSize; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                  dNdXj = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstRow];</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                  dNdYj = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstRow + 1];</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                  LHS_Contribution(firstRow, firstCol) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdXi + dNdYj * dNdYi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                  LHS_Contribution(firstRow, firstCol + 1) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdYi + dNdYj * dNdXi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                  LHS_Contribution(firstRow + 1, firstCol) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdXi + dNdXj * dNdYi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                  LHS_Contribution(firstRow + 1, firstCol + 1) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdYi + dNdXj * dNdXi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                  firstRow += 2;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                firstRow = 0;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                firstCol += 2;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexNode = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <span class="keywordflow">if</span> (itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span> &amp;&amp; indexNode &lt; neighSize)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> other_neigh_nodes_id = nodalSFDneighboursId[indexNode];</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                  {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neigh_nodes_id = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].Id();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                    <span class="keywordflow">if</span> (neigh_nodes_id == other_neigh_nodes_id)</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                    {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                      EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                      EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                    }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                  }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                }</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>())</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                  EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                  EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;              }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;              LHS_Contribution(0, 0) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;              LHS_Contribution(1, 1) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;              LHS_Contribution(2, 2) += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * 2.0 / timeInterval;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;              <span class="comment">//-------- DYNAMIC FORCES TERM -------//</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;              Acc = 2.0 * (itNode-&gt;FastGetSolutionStepValue(VELOCITY, 0) - itNode-&gt;FastGetSolutionStepValue(VELOCITY, 1)) / timeInterval -</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                    itNode-&gt;FastGetSolutionStepValue(ACCELERATION, 0);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;              RHS_Contribution[0] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[0];</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;              RHS_Contribution[1] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[1];</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;              RHS_Contribution[2] += -nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * Acc[2];</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;              <span class="comment">//-------- EXTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3&gt;</a> &amp;VolumeAcceleration = itNode-&gt;FastGetSolutionStepValue(VOLUME_ACCELERATION);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;              RHS_Contribution[0] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[0];</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;              RHS_Contribution[1] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[1];</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;              RHS_Contribution[2] += nodalVolume * <a class="code" href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">density</a> * VolumeAcceleration[2];</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;              <span class="comment">//-------- INTERNAL FORCES TERM -------//</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;              <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 6&gt;</a> Sigma(6, 0.0);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;              Sigma = itNode-&gt;FastGetSolutionStepValue(NODAL_CAUCHY_STRESS);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;              <span class="keywordflow">if</span> (itNode-&gt;IsNot(SOLID) || itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;              {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a> = itNode-&gt;FastGetSolutionStepValue(PRESSURE, 0) * theta + itNode-&gt;FastGetSolutionStepValue(PRESSURE, 1) * (1 - theta);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                Sigma[0] = itNode-&gt;FastGetSolutionStepValue(NODAL_DEVIATORIC_CAUCHY_STRESS)[0] + <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                Sigma[1] = itNode-&gt;FastGetSolutionStepValue(NODAL_DEVIATORIC_CAUCHY_STRESS)[1] + <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                Sigma[2] = itNode-&gt;FastGetSolutionStepValue(NODAL_DEVIATORIC_CAUCHY_STRESS)[2] + <a class="code" href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">pressure</a>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;              }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xDofPos = itNode-&gt;GetDofPosition(VELOCITY_X);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;              EquationId[0] = itNode-&gt;GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;              EquationId[1] = itNode-&gt;GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;              EquationId[2] = itNode-&gt;GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighSize; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                dNdXi = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstCol];</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                dNdYi = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstCol + 1];</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                dNdZi = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstCol + 2];</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                RHS_Contribution[firstCol] += -nodalVolume * (dNdXi * Sigma[0] + dNdYi * Sigma[3] + dNdZi * Sigma[4]);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                RHS_Contribution[firstCol + 1] += -nodalVolume * (dNdYi * Sigma[1] + dNdXi * Sigma[3] + dNdZi * Sigma[5]);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                RHS_Contribution[firstCol + 2] += -nodalVolume * (dNdZi * Sigma[2] + dNdXi * Sigma[4] + dNdYi * Sigma[5]);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; neighSize; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                  dNdXj = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstRow];</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                  dNdYj = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstRow + 1];</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                  dNdZj = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS)[firstRow + 2];</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                  LHS_Contribution(firstRow, firstCol) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdXi + (dNdYj * dNdYi + dNdZj * dNdZi) * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                  LHS_Contribution(firstRow, firstCol + 1) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdYi + dNdYj * dNdXi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                  LHS_Contribution(firstRow, firstCol + 2) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdXj * dNdZi + dNdZj * dNdXi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                  LHS_Contribution(firstRow + 1, firstCol) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdXi + dNdXj * dNdYi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                  LHS_Contribution(firstRow + 1, firstCol + 1) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdYi + (dNdXj * dNdXi + dNdZj * dNdZi) * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                  LHS_Contribution(firstRow + 1, firstCol + 2) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdYj * dNdZi + dNdZj * dNdYi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                  LHS_Contribution(firstRow + 2, firstCol) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdZj * dNdXi + dNdXj * dNdZi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                  LHS_Contribution(firstRow + 2, firstCol + 1) += nodalVolume * ((nTwoThirds * deviatoricCoeff + volumetricCoeff) * dNdZj * dNdYi + dNdYj * dNdZi * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                  LHS_Contribution(firstRow + 2, firstCol + 2) += nodalVolume * ((FourThirds * deviatoricCoeff + volumetricCoeff) * dNdZj * dNdZi + (dNdXj * dNdXi + dNdYj * dNdYi) * deviatoricCoeff) * theta;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                  firstRow += 3;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                firstRow = 0;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                firstCol += 3;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexNode = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">if</span> (itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span> &amp;&amp; indexNode &lt; neighSize)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> other_neigh_nodes_id = nodalSFDneighboursId[indexNode];</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                  <span class="comment">// std::cout&lt;&lt;&quot;other_neigh_nodes_id= &quot;&lt;&lt;other_neigh_nodes_id&lt;&lt;&quot; within &quot;&lt;&lt;nodalSFDneighboursId&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                  {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neigh_nodes_id = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].Id();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    <span class="comment">// std::cout&lt;&lt;&quot; neigh_nodes_id= &quot;&lt;&lt; neigh_nodes_id&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <span class="keywordflow">if</span> (neigh_nodes_id == other_neigh_nodes_id)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                      EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                      EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                      EquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                  }</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>())</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                  EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                  EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                  EquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;              }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec">Assemble</a>(<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>, LHS_Contribution, RHS_Contribution, EquationId, mlock_array);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec">Assemble</a>(<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>, LHS_Contribution, RHS_Contribution, EquationId);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;          }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="comment">//    }</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a5e99c74be9769d3a05571b5a63192a71">  820</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a5e99c74be9769d3a05571b5a63192a71">BuildAndSolve</a>(</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart,</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;Dx,</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>)<span class="keyword"> override</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <a class="code" href="../../d9/d31/class_kratos_1_1_timer.html#a08db3e5418419f02685c343cc0a63d9c">Timer::Start</a>(<span class="stringliteral">&quot;Build&quot;</span>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      <span class="comment">// boost::timer m_build_time;</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordtype">double</span> hybridCoeff = 1.0; <span class="comment">// 0.5: half nodal - half elemental; 1.0 all nodal; 0.0 all elemental</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76986c43775354f16f4009d1156bf549">BuildSolidNodally</a>(pScheme, rModelPart, <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>, hybridCoeff);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">if</span> (hybridCoeff &lt; 0.99999999)</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1af5122423dae64ab6e4620a68be06db">BuildElementally</a>(pScheme, rModelPart, <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a6040ddc10ccc6f9363006a3fa9ede11f">BuildFluidNodally</a>(pScheme, rModelPart, <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      <a class="code" href="../../d9/d31/class_kratos_1_1_timer.html#a78abd4fabca3e2717ab611417eef96dd">Timer::Stop</a>(<span class="stringliteral">&quot;Build&quot;</span>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">//         ApplyPointLoads(pScheme,rModelPart,b);</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="comment">// Does nothing...dirichlet conditions are naturally dealt with in defining the residual</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      this-&gt;<a class="code" href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html#a9761557533711204cca6dae7fd89ab82">ApplyDirichletConditions</a>(pScheme, rModelPart, <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, Dx, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedBlockBuilderAndSolver&quot;</span>, (this-&gt;<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() == 3)) &lt;&lt; <span class="stringliteral">&quot;Before the solution of the system&quot;</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                                                                        &lt;&lt; <span class="stringliteral">&quot;\nSystem Matrix = &quot;</span> &lt;&lt; A &lt;&lt; <span class="stringliteral">&quot;\nUnknowns vector = &quot;</span> &lt;&lt; Dx &lt;&lt; <span class="stringliteral">&quot;\nRHS vector = &quot;</span> &lt;&lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      this-&gt;<a class="code" href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html#a1726d3df37a63c27d8661c839bea96de">SystemSolveWithPhysics</a>(A, Dx, <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>, rModelPart);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedBlockBuilderAndSolver&quot;</span>, (this-&gt;<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() == 3)) &lt;&lt; <span class="stringliteral">&quot;After the solution of the system&quot;</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                                                                        &lt;&lt; <span class="stringliteral">&quot;\nSystem Matrix = &quot;</span> &lt;&lt; A &lt;&lt; <span class="stringliteral">&quot;\nUnknowns vector = &quot;</span> &lt;&lt; Dx &lt;&lt; <span class="stringliteral">&quot;\nRHS vector = &quot;</span> &lt;&lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1af5122423dae64ab6e4620a68be06db">  863</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1af5122423dae64ab6e4620a68be06db">BuildElementally</a>(</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart,</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;rA,</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;rb)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <a class="code" href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a>(!pScheme) &lt;&lt; <span class="stringliteral">&quot;No scheme provided!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      <span class="comment">// getting the elements from the model</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nelements = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>().<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a510c92d5ebe9a4beeb063269530ef31a">size</a>());</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">// getting the array of the conditions</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nconditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().size());</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keyword">const</span> <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a> &amp;CurrentProcessInfo = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      ModelPart::ElementsContainerType::iterator el_begin = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a020aafc9231da6da0aaa7c49b89ad8d9">ElementsBegin</a>();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      ModelPart::ConditionsContainerType::iterator cond_begin = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1c8f74bec8af82fc8b754db08e89e9c1">ConditionsBegin</a>();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <span class="comment">// contributions to the system</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">LocalSystemMatrixType</a> LHS_Contribution = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">LocalSystemMatrixType</a>(0, 0);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">LocalSystemVectorType</a> RHS_Contribution = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">LocalSystemVectorType</a>(0);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="comment">// vector containing the localization in the system of the different</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <span class="comment">// terms</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> EquationId;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="comment">// const double start_build = OpenMPUtils::GetCurrentTime();</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">// assemble all elements</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#pragma omp parallel firstprivate(nelements, nconditions, LHS_Contribution, RHS_Contribution, EquationId)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="preprocessor">#pragma omp for schedule(guided, 512) nowait</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; nelements; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        {</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;          ModelPart::ElementsContainerType::iterator it = el_begin + <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          <span class="comment">// detect if the element is active or not. If the user did not make any choice the element</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;          <span class="comment">// is active by default</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;          <span class="keywordtype">bool</span> element_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;          <span class="keywordflow">if</span> ((it)-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            element_is_active = (it)-&gt;Is(ACTIVE);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          <span class="keywordflow">if</span> (element_is_active)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="comment">// calculate elemental contribution</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            pScheme-&gt;CalculateSystemContributions(*it, LHS_Contribution, RHS_Contribution, EquationId, CurrentProcessInfo);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            <span class="comment">// assemble the elemental contribution</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="preprocessor">#ifdef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">AssembleElementally</a>(rA, rb, LHS_Contribution, RHS_Contribution, EquationId, mLockArray);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">AssembleElementally</a>(rA, rb, LHS_Contribution, RHS_Contribution, EquationId);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;          }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">#pragma omp for schedule(guided, 512)</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; nconditions; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          ModelPart::ConditionsContainerType::iterator it = cond_begin + <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          <span class="comment">// detect if the element is active or not. If the user did not make any choice the element</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          <span class="comment">// is active by default</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          <span class="keywordtype">bool</span> condition_is_active = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;          <span class="keywordflow">if</span> ((it)-&gt;IsDefined(ACTIVE))</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            condition_is_active = (it)-&gt;Is(ACTIVE);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          <span class="keywordflow">if</span> (condition_is_active)</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="comment">// calculate elemental contribution</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            pScheme-&gt;CalculateSystemContributions(*it, LHS_Contribution, RHS_Contribution, EquationId, CurrentProcessInfo);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor">#ifdef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">AssembleElementally</a>(rA, rb, LHS_Contribution, RHS_Contribution, EquationId, mLockArray);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">AssembleElementally</a>(rA, rb, LHS_Contribution, RHS_Contribution, EquationId);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;ResidualBasedEliminationBuilderAndSolver&quot;</span>, this-&gt;<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2 &amp;&amp; rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">GetCommunicator</a>().<a class="code" href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">MyPID</a>() == 0) &lt;&lt; <span class="stringliteral">&quot;Finished building&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">  949</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">AssembleElementally</a>(</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;rA,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;rb,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">LocalSystemMatrixType</a> &amp;rLHSContribution,</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">LocalSystemVectorType</a> &amp;rRHSContribution,</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> &amp;rEquationId</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;#ifdef USE_LOCKS_IN_ASSEMBLY</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        ,</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        std::vector&lt;omp_lock_t&gt; &amp;rLockArray</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;#endif</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    )</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a> = rLHSContribution.size1();</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_local = 0; i_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; i_local++)</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_global = rEquationId[i_local];</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="keywordflow">if</span> (i_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="preprocessor">#ifdef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;          omp_set_lock(&amp;rLockArray[i_global]);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;          <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>[i_global] += rRHSContribution(i_local);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          <span class="keywordtype">double</span> &amp;r_a = rb[i_global];</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;v_a = rRHSContribution(i_local);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor">#pragma omp atomic</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;          r_a += v_a;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;          <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab4c47434d24da43859b4df11ae704db6">AssembleRowContributionFreeDofs</a>(rA, rLHSContribution, i_global, i_local, rEquationId);</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="preprocessor">#ifdef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;          omp_unset_lock(&amp;rLockArray[i_global]);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">// note that computation of reactions is not performed here!</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a86e298472dffe6824815c414d312c7d4">  996</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a86e298472dffe6824815c414d312c7d4">SetUpDofSet</a>(</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart)<span class="keyword"> override</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;NodalResidualBasedEliminationBuilderAndSolverForFSI&quot;</span>, this-&gt;<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 1 &amp;&amp; rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">GetCommunicator</a>().<a class="code" href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">MyPID</a>() == 0) &lt;&lt; <span class="stringliteral">&quot;Setting up the dofs&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <span class="comment">// Gets the array of elements from the modeler</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae8971ea9fbe6bfb776a4e3cb86b4b66e">ElementsArrayType</a> &amp;pElements = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nelements = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pElements.size());</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#a83ae9b09dd7a0ed7ab3bc1baa6429df5">Element::DofsVectorType</a> ElementalDofList;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a> &amp;CurrentProcessInfo = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nthreads = <a class="code" href="../../d3/da8/class_kratos_1_1_parallel_utilities.html#aa9af37f90ccd77b2fd6b6ca7c0b58406">ParallelUtilities::GetNumThreads</a>();</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="comment">//         typedef boost::fast_pool_allocator&lt; NodeType::DofType::Pointer &gt; allocator_type;</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <span class="comment">//         typedef std::unordered_set &lt; NodeType::DofType::Pointer,</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="comment">//             DofPointerHasher,</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="comment">//             DofPointerComparor,</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="comment">//             allocator_type    &gt;  set_type;</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor">#ifdef USE_GOOGLE_HASH</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keyword">typedef</span> google::dense_hash_set&lt;NodeType::DofType::Pointer, DofPointerHasher&gt; set_type;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keyword">typedef</span> std::unordered_set&lt;NodeType::DofType::Pointer, DofPointerHasher&gt; set_type;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      std::vector&lt;set_type&gt; dofs_aux_list(nthreads);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(nthreads); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;      {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor">#ifdef USE_GOOGLE_HASH</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        dofs_aux_list[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].set_empty_key(<a class="code" href="../../dc/d58/class_kratos_1_1_dof.html#a53950a084e353e0bd4b8692a9f5eae0b">NodeType::DofType::Pointer</a>());</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        dofs_aux_list[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].reserve(nelements);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="comment">// #pragma omp parallel for firstprivate(nelements, ElementalDofList)</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(nelements); ++<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keyword">auto</span> it_elem = pElements.begin() + <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a0dda91521f11b2ff6e2508e650195992">IndexType</a> this_thread_id = <a class="code" href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a25ab2a1b4dca7ecf3a1e4aee1039507e">OpenMPUtils::ThisThread</a>();</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <span class="comment">// Gets list of Dof involved on every element</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        pScheme-&gt;GetDofList(*it_elem, ElementalDofList, CurrentProcessInfo);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160; </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        dofs_aux_list[this_thread_id].insert(ElementalDofList.begin(), ElementalDofList.end());</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a5e418b9a6309ffa92898291532bdeba4">ConditionsArrayType</a> &amp;pConditions = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nconditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(pConditions.size());</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#pragma omp parallel for firstprivate(nconditions, ElementalDofList)</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; nconditions; ++<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keyword">auto</span> it_cond = pConditions.begin() + <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a0dda91521f11b2ff6e2508e650195992">IndexType</a> this_thread_id = <a class="code" href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a25ab2a1b4dca7ecf3a1e4aee1039507e">OpenMPUtils::ThisThread</a>();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// Gets list of Dof involved on every element</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        pScheme-&gt;GetDofList(*it_cond, ElementalDofList, CurrentProcessInfo);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        dofs_aux_list[this_thread_id].insert(ElementalDofList.begin(), ElementalDofList.end());</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="comment">// here we do a reduction in a tree so to have everything on thread 0</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_max = nthreads;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_max = ceil(0.5 * <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(old_max));</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      <span class="keywordflow">while</span> (new_max &gt;= 1 &amp;&amp; new_max != old_max)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(new_max); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + new_max &lt; old_max)</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            dofs_aux_list[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].insert(dofs_aux_list[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + new_max].begin(), dofs_aux_list[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + new_max].end());</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            dofs_aux_list[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + new_max].clear();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;          }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        old_max = new_max;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        new_max = ceil(0.5 * <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(old_max));</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">DofsArrayType</a> Doftemp;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a> = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a90429a66a5247c0817286a244177b6f5">DofsArrayType</a>();</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      Doftemp.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#ac36a7d1445d4eadf75b341924f3aa4dd">reserve</a>(dofs_aux_list[0].size());</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = dofs_aux_list[0].begin(); it != dofs_aux_list[0].end(); it++)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        Doftemp.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a9d223f7af1848345c2d25830364314f0">push_back</a>(*it);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      Doftemp.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a7542007a871149bde5d4edfb73829d4f">Sort</a>();</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a> = Doftemp;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      <span class="comment">// Throws an execption if there are no Degrees of freedom involved in the analysis</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <a class="code" href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a>(<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size() == 0) &lt;&lt; <span class="stringliteral">&quot;No degrees of freedom!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a22231ac6816fd743908f9601bd8ba6a5">BaseType::mDofSetIsInitialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;NodalResidualBasedEliminationBuilderAndSolverForFSI&quot;</span>, this-&gt;<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">GetEchoLevel</a>() &gt; 2 &amp;&amp; rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">GetCommunicator</a>().<a class="code" href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">MyPID</a>() == 0) &lt;&lt; <span class="stringliteral">&quot;Finished setting up the dofs&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <span class="keywordflow">if</span> (mlock_array.size() != 0)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(mlock_array.size()); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;          omp_destroy_lock(&amp;mlock_array[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      mlock_array.resize(<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.size());</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(mlock_array.size()); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        omp_init_lock(&amp;mlock_array[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">// If reactions are to be calculated, we check if all the dofs have reactions defined</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="comment">// This is tobe done only in debug mode</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#ifdef KRATOS_DEBUG</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4960cb64a0657894f9776608a923ce25">BaseType::GetCalculateReactionsFlag</a>())</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> dof_iterator = <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.begin(); dof_iterator != <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#acc410959c998f861779d4e180822b78b">end</a>(); ++dof_iterator)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          <a class="code" href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a>(dof_iterator-&gt;HasReaction()) &lt;&lt; <span class="stringliteral">&quot;Reaction variable not set for the following : &quot;</span> &lt;&lt; std::endl</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                                           &lt;&lt; <span class="stringliteral">&quot;Node : &quot;</span> &lt;&lt; dof_iterator-&gt;Id() &lt;&lt; std::endl</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                                                           &lt;&lt; <span class="stringliteral">&quot;Dof : &quot;</span> &lt;&lt; (*dof_iterator) &lt;&lt; std::endl</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                                           &lt;&lt; <span class="stringliteral">&quot;Not possible to calculate reactions.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">//**************************************************************************</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="comment">//**************************************************************************</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab05179ab98dee1c5f2ad76befa431400"> 1136</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab05179ab98dee1c5f2ad76befa431400">ResizeAndInitializeVectors</a>(</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ad7cf31210f73d447ba2969921bf30065">TSystemMatrixPointerType</a> &amp;pA,</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">TSystemVectorPointerType</a> &amp;pDx,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">TSystemVectorPointerType</a> &amp;pb,</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart)<span class="keyword"> override</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="comment">//  boost::timer m_contruct_matrix;</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">if</span> (pA == NULL) <span class="comment">// if the pointer is not initialized initialize it to an empty matrix</span></div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      {</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ad7cf31210f73d447ba2969921bf30065">TSystemMatrixPointerType</a> pNewA = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af0e05a6a19c238e4f51972c7e7c5929f">TSystemMatrixPointerType</a>(<span class="keyword">new</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae2b0f7d8efc5b3a9d80ded8bd20c50fc">TSystemMatrixType</a>(0, 0));</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        pA.swap(pNewA);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">if</span> (pDx == NULL) <span class="comment">// if the pointer is not initialized initialize it to an empty matrix</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">TSystemVectorPointerType</a> pNewDx = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aaa29a2d5739f8c5923e09083e5711a83">TSystemVectorPointerType</a>(<span class="keyword">new</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">TSystemVectorType</a>(0));</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        pDx.swap(pNewDx);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      }</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">if</span> (pb == NULL) <span class="comment">// if the pointer is not initialized initialize it to an empty matrix</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">TSystemVectorPointerType</a> pNewb = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aaa29a2d5739f8c5923e09083e5711a83">TSystemVectorPointerType</a>(<span class="keyword">new</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">TSystemVectorType</a>(0));</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        pb.swap(pNewb);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a> == NULL) <span class="comment">// if the pointer is not initialized initialize it to an empty matrix</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">TSystemVectorPointerType</a> pNewReactionsVector = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aaa29a2d5739f8c5923e09083e5711a83">TSystemVectorPointerType</a>(<span class="keyword">new</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">TSystemVectorType</a>(0));</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>.swap(pNewReactionsVector);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a> = *pA;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;Dx = *pDx;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = *pb;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="comment">// resizing the system vectors and matrix</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.size1() == 0 || <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#aa4cf0a493c34278ce36248b94ffc7247">BaseType::GetReshapeMatrixFlag</a>() == <span class="keyword">true</span>) <span class="comment">// if the matrix is not initialized</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.resize(<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae5c95462e1fc292662847de9ae5b905b">ConstructMatrixStructureForFSI</a>(pScheme, <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, rModelPart);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.size1() != <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a> || <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.size2() != <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;          <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;it should not come here!!!!!!!! ... this is SLOW&quot;</span>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          <a class="code" href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a> &lt;&lt; <span class="stringliteral">&quot;The equation system size has changed during the simulation. This is not permited.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.resize(<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;          <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae5c95462e1fc292662847de9ae5b905b">ConstructMatrixStructureForFSI</a>(pScheme, <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>, rModelPart);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        }</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">if</span> (Dx.size() != <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        Dx.resize(<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>.size() != <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>.resize(<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160; </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      <span class="comment">// if needed resize the vector for the calculation of reactions</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">BaseType::mCalculateReactionsFlag</a> == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      {</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ReactionsVectorSize = <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">BaseType::mDofSet</a>.<a class="code" href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a510c92d5ebe9a4beeb063269530ef31a">size</a>();</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>-&gt;size() != ReactionsVectorSize)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;          <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>-&gt;resize(ReactionsVectorSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab4c47434d24da43859b4df11ae704db6"> 1204</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab4c47434d24da43859b4df11ae704db6">AssembleRowContributionFreeDofs</a>(</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;rA,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Matrix</a> &amp;rALocal,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a0dda91521f11b2ff6e2508e650195992">IndexType</a> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>,</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a0dda91521f11b2ff6e2508e650195992">IndexType</a> i_local,</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> &amp;EquationId)</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordtype">double</span> *values_vector = rA.value_data().begin();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      std::size_t *index1_vector = rA.index1_data().begin();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      std::size_t *index2_vector = rA.index2_data().begin();</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keyword">const</span> std::size_t left_limit = index1_vector[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      <span class="comment">// Find the first entry</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="comment">// We iterate over the equation ids until we find the first equation id to be considered</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      <span class="comment">// We count in which component we find an ID</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      std::size_t last_pos = 0;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      std::size_t last_found = 0;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      std::size_t <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> = 0;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keywordflow">for</span> (std::size_t <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; EquationId.size(); ++<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>)</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keyword">const</span> std::size_t j_global = EquationId[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>];</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        <span class="keywordflow">if</span> (j_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;          last_pos = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af4ac10a7e6ab0c67e87f276d2f67bbc8">ForwardFind</a>(j_global, left_limit, index2_vector);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;          last_found = j_global;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="comment">// If the counter is equal to the size of the EquationID vector that means that only one dof will be considered, if the number is greater means that all the dofs are fixed. If the number is below means that at we have several dofs free to be considered</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> &lt;= EquationId.size())</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="preprocessor">#ifndef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordtype">double</span> &amp;r_a = values_vector[last_pos];</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;v_a = rALocal(i_local, <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> - 1);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor">#pragma omp atomic</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        r_a += v_a;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        values_vector[last_pos] += rALocal(i_local, <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> - 1);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="comment">// Now find all of the other entries</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        std::size_t pos = 0;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">for</span> (std::size_t <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; EquationId.size(); ++<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>)</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;          std::size_t id_to_find = EquationId[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>];</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;          <span class="keywordflow">if</span> (id_to_find &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;          {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordflow">if</span> (id_to_find &gt; last_found)</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;              pos = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af4ac10a7e6ab0c67e87f276d2f67bbc8">ForwardFind</a>(id_to_find, last_pos + 1, index2_vector);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (id_to_find &lt; last_found)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;              pos = <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac9d5c08c8e4cfecd2f619f934b08d16f">BackwardFind</a>(id_to_find, last_pos - 1, index2_vector);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;              pos = last_pos;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="preprocessor">#ifndef USE_LOCKS_IN_ASSEMBLY</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordtype">double</span> &amp;r = values_vector[pos];</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">v</a> = rALocal(i_local, <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="preprocessor">#pragma omp atomic</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            r += <a class="code" href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">v</a>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            values_vector[pos] += Alocal(i_local, <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            last_found = id_to_find;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            last_pos = pos;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;          }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af4ac10a7e6ab0c67e87f276d2f67bbc8"> 1275</a></span>&#160;    <span class="keyword">inline</span> std::size_t <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af4ac10a7e6ab0c67e87f276d2f67bbc8">ForwardFind</a>(<span class="keyword">const</span> std::size_t id_to_find,</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                   <span class="keyword">const</span> std::size_t <a class="code" href="../../d3/d1a/namespace_d_e_m__benchmarks.html#a1fc5d00464e8eee288be8f84f871b6f9">start</a>,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                   <span class="keyword">const</span> std::size_t *index_vector)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      std::size_t pos = <a class="code" href="../../d3/d1a/namespace_d_e_m__benchmarks.html#a1fc5d00464e8eee288be8f84f871b6f9">start</a>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">while</span> (id_to_find != index_vector[pos])</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        pos++;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <span class="keywordflow">return</span> pos;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac9d5c08c8e4cfecd2f619f934b08d16f"> 1285</a></span>&#160;    <span class="keyword">inline</span> std::size_t <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac9d5c08c8e4cfecd2f619f934b08d16f">BackwardFind</a>(<span class="keyword">const</span> std::size_t id_to_find,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                    <span class="keyword">const</span> std::size_t <a class="code" href="../../d3/d1a/namespace_d_e_m__benchmarks.html#a1fc5d00464e8eee288be8f84f871b6f9">start</a>,</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                    <span class="keyword">const</span> std::size_t *index_vector)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      std::size_t pos = <a class="code" href="../../d3/d1a/namespace_d_e_m__benchmarks.html#a1fc5d00464e8eee288be8f84f871b6f9">start</a>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordflow">while</span> (id_to_find != index_vector[pos])</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        pos--;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">return</span> pos;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="comment">//**************************************************************************</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec"> 1327</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec">Assemble</a>(</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">TSystemVectorType</a> &amp;<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">LocalSystemMatrixType</a> &amp;LHS_Contribution,</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">LocalSystemVectorType</a> &amp;RHS_Contribution,</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> &amp;EquationId</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;#ifdef _OPENMP</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        ,</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        std::vector&lt;omp_lock_t&gt; &amp;lock_array</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;#endif</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    )</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a> = LHS_Contribution.size1();</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_local = 0; i_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; i_local++)</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_global = EquationId[i_local];</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <span class="keywordflow">if</span> (i_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        {</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          omp_set_lock(&amp;lock_array[i_global]);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>[i_global] += RHS_Contribution(i_local);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_local = 0; j_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; j_local++)</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;          {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_global = EquationId[j_local];</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="keywordflow">if</span> (j_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;              <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>(i_global, j_global) += LHS_Contribution(i_local, j_local);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;          }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          omp_unset_lock(&amp;lock_array[i_global]);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="comment">// note that assembly on fixed rows is not performed here</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="comment">//**************************************************************************</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae5c95462e1fc292662847de9ae5b905b"> 1368</a></span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae5c95462e1fc292662847de9ae5b905b">ConstructMatrixStructureForFSI</a>(</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keyword">typename</span> TSchemeType::Pointer pScheme,</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a> &amp;rModelPart)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      <span class="comment">// filling with zero the matrix (creating the structure)</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <a class="code" href="../../d9/d31/class_kratos_1_1_timer.html#a08db3e5418419f02685c343cc0a63d9c">Timer::Start</a>(<span class="stringliteral">&quot;MatrixStructure&quot;</span>);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a> &amp;CurrentProcessInfo = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="comment">// Getting the array of the conditions</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nconditions = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().size());</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      ModelPart::ConditionsContainerType::iterator cond_begin = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1c8f74bec8af82fc8b754db08e89e9c1">ConditionsBegin</a>();</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keyword">const</span> std::size_t equation_size = <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="preprocessor">#ifdef USE_GOOGLE_HASH</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      std::vector&lt;google::dense_hash_set&lt;std::size_t&gt;&gt; indices(equation_size);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keyword">const</span> std::size_t empty_key = 2 * equation_size + 10;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      std::vector&lt;std::unordered_set&lt;std::size_t&gt;&gt; indices(equation_size);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="preprocessor">#pragma omp parallel for firstprivate(equation_size)</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iii = 0; iii &lt; static_cast&lt;int&gt;(equation_size); iii++)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="preprocessor">#ifdef USE_GOOGLE_HASH</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        indices[iii].set_empty_key(empty_key);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        indices[iii].reserve(40);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> EquationId;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> NodesBegin;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> NodesEnd;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <a class="code" href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a9fc68ec4d0fa71f7bdbb95bf636ef8f3">OpenMPUtils::PartitionedIterators</a>(rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>(), NodesBegin, NodesEnd);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> itNode = NodesBegin; itNode != NodesEnd; ++itNode)</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="keywordflow">if</span> (itNode-&gt;Is(SOLID))</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        {</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> localSize = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS).size();</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a020aafc9231da6da0aaa7c49b89ad8d9">ElementsBegin</a>()-&gt;GetGeometry().WorkingSpaceDimension();</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Vector</a> nodalSFDneighboursId = itNode-&gt;FastGetSolutionStepValue(SOLID_NODAL_SFD_NEIGHBOURS_ORDER);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighSize = nodalSFDneighboursId.size();</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;          <span class="keywordflow">if</span> (EquationId.size() != localSize)</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            EquationId.<a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(localSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstCol = 0;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xDofPos = itNode-&gt;GetDofPosition(VELOCITY_X);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;          EquationId[0] = itNode-&gt;GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          EquationId[1] = itNode-&gt;GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            EquationId[2] = itNode-&gt;GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;          <span class="keywordflow">if</span> (itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">NodeWeakPtrVectorType</a> &amp;neighb_nodes = itNode-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            {</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexNode = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;              <span class="keywordflow">if</span> (indexNode &lt; neighSize)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;              {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> other_neigh_nodes_id = nodalSFDneighboursId[indexNode];</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                firstCol += <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neigh_nodes_id = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].Id();</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                  <span class="keywordflow">if</span> (neigh_nodes_id == other_neigh_nodes_id)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                  {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                    EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                    {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                      EquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                  }</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;              }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;          }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;          {</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">NodeWeakPtrVectorType</a> &amp;neighb_nodes = itNode-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;              firstCol += <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a>;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;              EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;              EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;              {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                EquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;              }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;          }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        }</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="keywordflow">if</span> ((itNode-&gt;Is(FLUID) &amp;&amp; itNode-&gt;IsNot(SOLID)) || itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> localSize = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS).<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>();</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a020aafc9231da6da0aaa7c49b89ad8d9">ElementsBegin</a>()-&gt;GetGeometry().WorkingSpaceDimension();</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;          <a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Vector</a> nodalSFDneighboursId = itNode-&gt;FastGetSolutionStepValue(NODAL_SFD_NEIGHBOURS_ORDER);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighSize = nodalSFDneighboursId.size();</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;          <span class="keywordflow">if</span> (EquationId.size() != localSize)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            EquationId.<a class="code" href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">resize</a>(localSize, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> firstCol = 0;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> xDofPos = itNode-&gt;GetDofPosition(VELOCITY_X);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;          EquationId[0] = itNode-&gt;GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          EquationId[1] = itNode-&gt;GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            EquationId[2] = itNode-&gt;GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;          <span class="keywordflow">if</span> (itNode-&gt;FastGetSolutionStepValue(INTERFACE_NODE) == <span class="keyword">true</span>)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">NodeWeakPtrVectorType</a> &amp;neighb_nodes = itNode-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indexNode = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;              <span class="keywordflow">if</span> (indexNode &lt; neighSize)</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;              {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> other_neigh_nodes_id = nodalSFDneighboursId[indexNode];</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                firstCol += <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neigh_nodes_id = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].Id();</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                  <span class="keywordflow">if</span> (neigh_nodes_id == other_neigh_nodes_id)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                  {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                    EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                    EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                      EquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                  }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                }</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;              }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;          }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">NodeWeakPtrVectorType</a> &amp;neighb_nodes = itNode-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">size</a>(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;              firstCol += <a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a>;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;              EquationId[firstCol] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_X, xDofPos).EquationId();</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;              EquationId[firstCol + 1] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Y, xDofPos + 1).EquationId();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">dimension</a> == 3)</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;              {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                EquationId[firstCol + 2] = neighb_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].GetDof(VELOCITY_Z, xDofPos + 2).EquationId();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;              }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;          }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="keywordflow">for</span> (std::size_t <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; EquationId.size(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;          <span class="keywordflow">if</span> (EquationId[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;          {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            omp_set_lock(&amp;mlock_array[EquationId[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]]);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <span class="keyword">auto</span> &amp;row_indices = indices[EquationId[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]];</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = EquationId.begin(); it != EquationId.end(); it++)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;              <span class="keywordflow">if</span> (*it &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                row_indices.insert(*it);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            }</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            omp_unset_lock(&amp;mlock_array[EquationId[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]]);</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;          }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> ids(3, 0);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="preprocessor">#pragma omp parallel for firstprivate(nconditions, ids)</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iii = 0; iii &lt; nconditions; iii++)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      {</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keyword">typename</span> ConditionsArrayType::iterator i_condition = cond_begin + iii;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        pScheme-&gt;EquationId(*i_condition, ids, CurrentProcessInfo);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="keywordflow">for</span> (std::size_t <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; ids.size(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;          <span class="keywordflow">if</span> (ids[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;          {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            omp_set_lock(&amp;mlock_array[ids[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]]);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keyword">auto</span> &amp;row_indices = indices[ids[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]];</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = ids.begin(); it != ids.end(); it++)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;              <span class="keywordflow">if</span> (*it &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                row_indices.insert(*it);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            omp_unset_lock(&amp;mlock_array[ids[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]]);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;          }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">// count the row sizes</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nnz = 0;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; indices.size(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        nnz += indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].size();</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a> = boost::numeric::ublas::compressed_matrix&lt;double&gt;(indices.size(), indices.size(), nnz);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="keywordtype">double</span> *Avalues = <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.value_data().begin();</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      std::size_t *Arow_indices = <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.index1_data().begin();</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      std::size_t *Acol_indices = <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.index2_data().begin();</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <span class="comment">// filling the index1 vector - DO NOT MAKE PARALLEL THE FOLLOWING LOOP!</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      Arow_indices[0] = 0;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.size1()); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        Arow_indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1] = Arow_indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] + indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].size();</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; i &lt; static_cast&lt;int&gt;(<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.size1()); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row_begin = Arow_indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> row_end = Arow_indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> + 1];</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = row_begin;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].begin(); it != indices[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].end(); it++)</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;        {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;          Acol_indices[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>] = *it;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;          Avalues[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>] = 0.0;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        std::sort(&amp;Acol_indices[row_begin], &amp;Acol_indices[row_end]);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>.set_filled(indices.size() + 1, nnz);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      <a class="code" href="../../d9/d31/class_kratos_1_1_timer.html#a78abd4fabca3e2717ab611417eef96dd">Timer::Stop</a>(<span class="stringliteral">&quot;MatrixStructure&quot;</span>);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"><a class="line" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#affb470f9ce0bf620a343f872eb8077b7"> 1626</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#affb470f9ce0bf620a343f872eb8077b7">AssembleLHS</a>(</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">LocalSystemMatrixType</a> &amp;LHS_Contribution,</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> &amp;EquationId)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a> = LHS_Contribution.size1();</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_local = 0; i_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; i_local++)</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_global = EquationId[i_local];</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        <span class="keywordflow">if</span> (i_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_local = 0; j_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; j_local++)</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_global = EquationId[j_local];</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="keywordflow">if</span> (j_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;              <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>(i_global, j_global) += LHS_Contribution(i_local, j_local);</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;          }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    std::vector&lt;omp_lock_t&gt; mlock_array;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> AddUnique(std::vector&lt;std::size_t&gt; &amp;<a class="code" href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">v</a>, <span class="keyword">const</span> std::size_t &amp;candidate)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      std::vector&lt;std::size_t&gt;::iterator <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = <a class="code" href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">v</a>.begin();</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      std::vector&lt;std::size_t&gt;::iterator endit = <a class="code" href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">v</a>.end();</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> != endit &amp;&amp; (*<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>) != candidate)</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      {</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == endit)</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <a class="code" href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">v</a>.push_back(candidate);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordtype">void</span> AssembleRHS(</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">TSystemVectorType</a> &amp;<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">LocalSystemVectorType</a> &amp;RHS_Contribution,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> &amp;EquationId)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a> = RHS_Contribution.size();</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160; </div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">BaseType::mCalculateReactionsFlag</a> == <span class="keyword">false</span>)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_local = 0; i_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; i_local++)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_global = EquationId[i_local];</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;          <span class="keywordflow">if</span> (i_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) <span class="comment">// free dof</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;          {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            <span class="comment">// ASSEMBLING THE SYSTEM VECTOR</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            <span class="keywordtype">double</span> &amp;b_value = <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>[i_global];</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;rhs_value = RHS_Contribution[i_local];</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">#pragma omp atomic</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            b_value += rhs_value;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;          }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">TSystemVectorType</a> &amp;ReactionsVector = *<a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">BaseType::mpReactionsVector</a>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_local = 0; i_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; i_local++)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_global = EquationId[i_local];</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160; </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;          <span class="keywordflow">if</span> (i_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>) <span class="comment">// free dof</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;          {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            <span class="comment">// ASSEMBLING THE SYSTEM VECTOR</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <span class="keywordtype">double</span> &amp;b_value = <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>[i_global];</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;rhs_value = RHS_Contribution[i_local];</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="preprocessor">#pragma omp atomic</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;            b_value += rhs_value;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;          }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// fixed dof</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;          {</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            <span class="keywordtype">double</span> &amp;b_value = ReactionsVector[i_global - <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>];</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;rhs_value = RHS_Contribution[i_local];</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="preprocessor">#pragma omp atomic</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            b_value += rhs_value;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;          }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">//**************************************************************************</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordtype">void</span> AssembleLHS_CompleteOnFreeRows(</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae2b0f7d8efc5b3a9d80ded8bd20c50fc">TSystemMatrixType</a> &amp;<a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>,</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <a class="code" href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">LocalSystemMatrixType</a> &amp;LHS_Contribution,</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Element::EquationIdVectorType</a> &amp;EquationId)</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a> = LHS_Contribution.size1();</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_local = 0; i_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; i_local++)</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      {</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_global = EquationId[i_local];</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">if</span> (i_global &lt; <a class="code" href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">BaseType::mEquationSystemSize</a>)</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_local = 0; j_local &lt; <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">local_size</a>; j_local++)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;          {</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            <span class="keywordtype">int</span> j_global = EquationId[j_local];</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            <a class="code" href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">A</a>(i_global, j_global) += LHS_Contribution(i_local, j_local);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;          }</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      }</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  }; <span class="comment">/* Class NodalResidualBasedEliminationBuilderAndSolverForFSI */</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;} <span class="comment">/* namespace Kratos.*/</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* KRATOS_NODAL_RESIDUAL_BASED_ELIMINATION_BUILDER_AND_SOLVER_FOR_FSI  defined */</span><span class="preprocessor"></span></div>
<div class="ttc" id="abuilder__and__solver_8h_html"><div class="ttname"><a href="../../d0/da7/builder__and__solver_8h.html">builder_and_solver.h</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a0dda91521f11b2ff6e2508e650195992"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a0dda91521f11b2ff6e2508e650195992">Kratos::BuilderAndSolver::IndexType</a></div><div class="ttdeci">std::size_t IndexType</div><div class="ttdoc">Definition of the index type.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:76</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a22231ac6816fd743908f9601bd8ba6a5"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a22231ac6816fd743908f9601bd8ba6a5">Kratos::BuilderAndSolver::mDofSetIsInitialized</a></div><div class="ttdeci">bool mDofSetIsInitialized</div><div class="ttdoc">If the matrix is reshaped each step.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:743</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a2cd11ba264c17998632c16118beb9edf"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a2cd11ba264c17998632c16118beb9edf">Kratos::BuilderAndSolver::TSystemVectorType</a></div><div class="ttdeci">TSparseSpace::VectorType TSystemVectorType</div><div class="ttdoc">Definition of the vector size.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:85</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a33b83c3e857167ce8816b2425ef07364"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a33b83c3e857167ce8816b2425ef07364">Kratos::BuilderAndSolver::NodesArrayType</a></div><div class="ttdeci">ModelPart::NodesContainerType NodesArrayType</div><div class="ttdoc">The containers of the entities.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:109</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a4960cb64a0657894f9776608a923ce25"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4960cb64a0657894f9776608a923ce25">Kratos::BuilderAndSolver::GetCalculateReactionsFlag</a></div><div class="ttdeci">bool GetCalculateReactionsFlag() const</div><div class="ttdoc">This method returns the flag mCalculateReactionsFlag.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:184</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a4a7ec09f7f58df4a8140d57a7c0437d0"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a4a7ec09f7f58df4a8140d57a7c0437d0">Kratos::BuilderAndSolver::TSystemMatrixType</a></div><div class="ttdeci">TSparseSpace::MatrixType TSystemMatrixType</div><div class="ttdoc">Definition of the sparse matrix.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:82</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a5e418b9a6309ffa92898291532bdeba4"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a5e418b9a6309ffa92898291532bdeba4">Kratos::BuilderAndSolver::ConditionsArrayType</a></div><div class="ttdeci">ModelPart::ConditionsContainerType ConditionsArrayType</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:111</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_a77fcbfce08aab91bcb13400df7b1d401"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#a77fcbfce08aab91bcb13400df7b1d401">Kratos::BuilderAndSolver::mpReactionsVector</a></div><div class="ttdeci">TSystemVectorPointerType mpReactionsVector</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:751</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_aa4cf0a493c34278ce36248b94ffc7247"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#aa4cf0a493c34278ce36248b94ffc7247">Kratos::BuilderAndSolver::GetReshapeMatrixFlag</a></div><div class="ttdeci">bool GetReshapeMatrixFlag() const</div><div class="ttdoc">This method returns the flag mReshapeMatrixFlag.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:220</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ab068793fccebe354fbcb56b19b8ca05d"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab068793fccebe354fbcb56b19b8ca05d">Kratos::BuilderAndSolver::LocalSystemMatrixType</a></div><div class="ttdeci">TDenseSpace::MatrixType LocalSystemMatrixType</div><div class="ttdoc">The local matrix definition.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:94</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ab3364c7430ebb0eb6e0ab7b849d9b870"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3364c7430ebb0eb6e0ab7b849d9b870">Kratos::BuilderAndSolver::TSystemVectorPointerType</a></div><div class="ttdeci">TSparseSpace::VectorPointerType TSystemVectorPointerType</div><div class="ttdoc">Definition of the pointer to the vector.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:91</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ab3ff99928e183457c245f57952f1707c"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ab3ff99928e183457c245f57952f1707c">Kratos::BuilderAndSolver::TDataType</a></div><div class="ttdeci">TSparseSpace::DataType TDataType</div><div class="ttdoc">Definition of the data type.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:79</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ac263566ea01f7fd5b200597bd0d94f8a"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac263566ea01f7fd5b200597bd0d94f8a">Kratos::BuilderAndSolver::mDofSet</a></div><div class="ttdeci">DofsArrayType mDofSet</div><div class="ttdoc">Pointer to the linear solver.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:739</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ac996ab2b86e2a14a2e0117a29598f461"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ac996ab2b86e2a14a2e0117a29598f461">Kratos::BuilderAndSolver::LocalSystemVectorType</a></div><div class="ttdeci">TDenseSpace::VectorType LocalSystemVectorType</div><div class="ttdoc">The local vector definition.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:97</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ad7cf31210f73d447ba2969921bf30065"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ad7cf31210f73d447ba2969921bf30065">Kratos::BuilderAndSolver::TSystemMatrixPointerType</a></div><div class="ttdeci">TSparseSpace::MatrixPointerType TSystemMatrixPointerType</div><div class="ttdoc">Definition of the pointer to the sparse matrix.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:88</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_adf722c4e501d8e245fc554bd97beab1d"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#adf722c4e501d8e245fc554bd97beab1d">Kratos::BuilderAndSolver::mCalculateReactionsFlag</a></div><div class="ttdeci">bool mCalculateReactionsFlag</div><div class="ttdoc">Flag taking care if the dof set was initialized ot not.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:745</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ae123013335a4ece0d8fdc5c701c75ae2"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae123013335a4ece0d8fdc5c701c75ae2">Kratos::BuilderAndSolver::GetEchoLevel</a></div><div class="ttdeci">int GetEchoLevel() const</div><div class="ttdoc">It returns the echo level.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:674</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ae638e6890872c910b6e087d97bc7d0bd"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae638e6890872c910b6e087d97bc7d0bd">Kratos::BuilderAndSolver::mEquationSystemSize</a></div><div class="ttdeci">unsigned int mEquationSystemSize</div><div class="ttdoc">Flag taking in account if it is needed or not to calculate the reactions.</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:747</div></div>
<div class="ttc" id="aclass_kratos_1_1_builder_and_solver_html_ae8971ea9fbe6bfb776a4e3cb86b4b66e"><div class="ttname"><a href="../../d2/d88/class_kratos_1_1_builder_and_solver.html#ae8971ea9fbe6bfb776a4e3cb86b4b66e">Kratos::BuilderAndSolver::ElementsArrayType</a></div><div class="ttdeci">ModelPart::ElementsContainerType ElementsArrayType</div><div class="ttdef"><b>Definition:</b> builder_and_solver.h:110</div></div>
<div class="ttc" id="aclass_kratos_1_1_communicator_html_aeac30940c4529aa1f7d2af14a768b62b"><div class="ttname"><a href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">Kratos::Communicator::MyPID</a></div><div class="ttdeci">virtual int MyPID() const</div><div class="ttdef"><b>Definition:</b> communicator.cpp:91</div></div>
<div class="ttc" id="aclass_kratos_1_1_dof_html_a53950a084e353e0bd4b8692a9f5eae0b"><div class="ttname"><a href="../../dc/d58/class_kratos_1_1_dof.html#a53950a084e353e0bd4b8692a9f5eae0b">Kratos::Dof::Pointer</a></div><div class="ttdeci">Dof * Pointer</div><div class="ttdoc">Pointer definition of Dof.</div><div class="ttdef"><b>Definition:</b> dof.h:93</div></div>
<div class="ttc" id="aclass_kratos_1_1_element_html_a83ae9b09dd7a0ed7ab3bc1baa6429df5"><div class="ttname"><a href="../../d5/dd4/class_kratos_1_1_element.html#a83ae9b09dd7a0ed7ab3bc1baa6429df5">Kratos::Element::DofsVectorType</a></div><div class="ttdeci">std::vector&lt; DofType::Pointer &gt; DofsVectorType</div><div class="ttdef"><b>Definition:</b> element.h:100</div></div>
<div class="ttc" id="aclass_kratos_1_1_element_html_ae71a1a55ae484b69ec9ec5f18919e324"><div class="ttname"><a href="../../d5/dd4/class_kratos_1_1_element.html#ae71a1a55ae484b69ec9ec5f18919e324">Kratos::Element::EquationIdVectorType</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; EquationIdVectorType</div><div class="ttdef"><b>Definition:</b> element.h:98</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">Kratos::GlobalPointersVector</a></div><div class="ttdoc">This class is a vector which stores global pointers.</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:61</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_a930fdb3e8b0ff4e6453f464647e3ce73"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a930fdb3e8b0ff4e6453f464647e3ce73">Kratos::GlobalPointersVector::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:310</div></div>
<div class="ttc" id="aclass_kratos_1_1_internals_1_1_matrix_html"><div class="ttname"><a href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html">Kratos::Internals::Matrix&lt; double, AMatrix::dynamic, 1 &gt;</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_internals_1_1_matrix_html_a3d36c583d63e7eeda493a7abdc97d874"><div class="ttname"><a href="../../d9/dbb/class_kratos_1_1_internals_1_1_matrix.html#a3d36c583d63e7eeda493a7abdc97d874">Kratos::Internals::Matrix::resize</a></div><div class="ttdeci">void resize(std::size_t NewSize1, std::size_t NewSize2, bool preserve=0)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:224</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html">Kratos::ModelPart</a></div><div class="ttdoc">This class aims to manage meshes for multi-physics simulations.</div><div class="ttdef"><b>Definition:</b> model_part.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a020aafc9231da6da0aaa7c49b89ad8d9"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a020aafc9231da6da0aaa7c49b89ad8d9">Kratos::ModelPart::ElementsBegin</a></div><div class="ttdeci">ElementIterator ElementsBegin(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1169</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a1c8f74bec8af82fc8b754db08e89e9c1"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a1c8f74bec8af82fc8b754db08e89e9c1">Kratos::ModelPart::ConditionsBegin</a></div><div class="ttdeci">ConditionIterator ConditionsBegin(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1361</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a3be3b39e5cd9032763c2b3fd0d28dc7f"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">Kratos::ModelPart::GetCommunicator</a></div><div class="ttdeci">Communicator &amp; GetCommunicator()</div><div class="ttdef"><b>Definition:</b> model_part.h:1826</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a6754ddb1e657c4efba0705a341de0294"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Kratos::ModelPart::Conditions</a></div><div class="ttdeci">ConditionsContainerType &amp; Conditions(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1381</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a78674e1f2609ef421e202c8b206b59ae"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">Kratos::ModelPart::GetProcessInfo</a></div><div class="ttdeci">ProcessInfo &amp; GetProcessInfo()</div><div class="ttdef"><b>Definition:</b> model_part.h:1751</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a885a2e1a9dd829e9cc23dad49e8ad72e"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">Kratos::ModelPart::NodeIterator</a></div><div class="ttdeci">MeshType::NodeIterator NodeIterator</div><div class="ttdef"><b>Definition:</b> model_part.h:134</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a94dfb23c46340061bd57e9b9c4e317c8"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Kratos::ModelPart::Elements</a></div><div class="ttdeci">ElementsContainerType &amp; Elements(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1189</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aeeaebc841dc1351f20b650c6497d6323"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Kratos::ModelPart::Nodes</a></div><div class="ttdeci">NodesContainerType &amp; Nodes(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:507</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI</a></div><div class="ttdoc">Current class provides an implementation for standard builder and solving operations.</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:81</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a1af5122423dae64ab6e4620a68be06db"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1af5122423dae64ab6e4620a68be06db">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::BuildElementally</a></div><div class="ttdeci">void BuildElementally(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;rA, TSystemVectorType &amp;rb)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:863</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a1c4a0c09ee68fc475090afd691b44f63"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1c4a0c09ee68fc475090afd691b44f63">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::TSchemeType</a></div><div class="ttdeci">BaseType::TSchemeType TSchemeType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:89</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a1e9eaba95d182df50bcc8146d27cb17c"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a1e9eaba95d182df50bcc8146d27cb17c">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::BaseType</a></div><div class="ttdeci">NodalResidualBasedEliminationBuilderAndSolver&lt; TSparseSpace, TDenseSpace, TLinearSolver &gt; BaseType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:87</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a34d62c19335a57e7a9d3219113c934ee"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a34d62c19335a57e7a9d3219113c934ee">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::AssembleElementally</a></div><div class="ttdeci">void AssembleElementally(TSystemMatrixType &amp;rA, TSystemVectorType &amp;rb, const LocalSystemMatrixType &amp;rLHSContribution, const LocalSystemVectorType &amp;rRHSContribution, const Element::EquationIdVectorType &amp;rEquationId)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:949</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a38ba6062d38e541932ef27871f27d809"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a38ba6062d38e541932ef27871f27d809">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::KRATOS_CLASS_POINTER_DEFINITION</a></div><div class="ttdeci">KRATOS_CLASS_POINTER_DEFINITION(NodalResidualBasedEliminationBuilderAndSolverForFSI)</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a45c58cfc63cf813a8eff6f4c7ebcd82a"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a45c58cfc63cf813a8eff6f4c7ebcd82a">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::~NodalResidualBasedEliminationBuilderAndSolverForFSI</a></div><div class="ttdeci">~NodalResidualBasedEliminationBuilderAndSolverForFSI() override</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:132</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a58c17b6b8d0ae976096ead56a8d748af"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a58c17b6b8d0ae976096ead56a8d748af">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::TSystemVectorType</a></div><div class="ttdeci">BaseType::TSystemVectorType TSystemVectorType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:97</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a5e99c74be9769d3a05571b5a63192a71"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a5e99c74be9769d3a05571b5a63192a71">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::BuildAndSolve</a></div><div class="ttdeci">void BuildAndSolve(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;A, TSystemVectorType &amp;Dx, TSystemVectorType &amp;b) override</div><div class="ttdoc">Function to perform the building and solving phase at the same time.</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:820</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a6040ddc10ccc6f9363006a3fa9ede11f"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a6040ddc10ccc6f9363006a3fa9ede11f">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::BuildFluidNodally</a></div><div class="ttdeci">void BuildFluidNodally(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;A, TSystemVectorType &amp;b)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:513</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a65f8f6bc7aaecb99468e45ac16e77b46"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a65f8f6bc7aaecb99468e45ac16e77b46">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::SetMaterialPropertiesToSolid</a></div><div class="ttdeci">void SetMaterialPropertiesToSolid(ModelPart::NodeIterator itNode, double &amp;density, double &amp;deviatoricCoeff, double &amp;volumetricCoeff, double timeInterval, double nodalVolume)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:144</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a67261ff0a40c8a6cef7bcdb89e26920a"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a67261ff0a40c8a6cef7bcdb89e26920a">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::NodeWeakPtrVectorType</a></div><div class="ttdeci">GlobalPointersVector&lt; Node &gt; NodeWeakPtrVectorType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:115</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a7097ec6c8a4ce1e6db9157553032bd15"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a7097ec6c8a4ce1e6db9157553032bd15">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::LocalSystemMatrixType</a></div><div class="ttdeci">BaseType::LocalSystemMatrixType LocalSystemMatrixType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:101</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a76986c43775354f16f4009d1156bf549"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76986c43775354f16f4009d1156bf549">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::BuildSolidNodally</a></div><div class="ttdeci">void BuildSolidNodally(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;A, TSystemVectorType &amp;b, double hybridCoeff)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:161</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a76ebf318e314cd1dab24aed1cae2cdb1"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a76ebf318e314cd1dab24aed1cae2cdb1">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::ConditionsArrayType</a></div><div class="ttdeci">BaseType::ConditionsArrayType ConditionsArrayType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:110</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a86e298472dffe6824815c414d312c7d4"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a86e298472dffe6824815c414d312c7d4">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::SetUpDofSet</a></div><div class="ttdeci">void SetUpDofSet(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart) override</div><div class="ttdoc">Builds the list of the DofSets involved in the problem by &quot;asking&quot; to each element and condition its ...</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:996</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a8f287870f03c81bd1afad33d4c7893ec"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a8f287870f03c81bd1afad33d4c7893ec">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::Assemble</a></div><div class="ttdeci">void Assemble(TSystemMatrixType &amp;A, TSystemVectorType &amp;b, const LocalSystemMatrixType &amp;LHS_Contribution, const LocalSystemVectorType &amp;RHS_Contribution, const Element::EquationIdVectorType &amp;EquationId)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1327</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a90429a66a5247c0817286a244177b6f5"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a90429a66a5247c0817286a244177b6f5">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::DofsArrayType</a></div><div class="ttdeci">BaseType::DofsArrayType DofsArrayType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:93</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a93d358bb26ec76278529d38c507fc909"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a93d358bb26ec76278529d38c507fc909">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::LocalSystemVectorType</a></div><div class="ttdeci">BaseType::LocalSystemVectorType LocalSystemVectorType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:99</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_a98795f4131971a9731c0e4823775eb76"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#a98795f4131971a9731c0e4823775eb76">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::NodesArrayType</a></div><div class="ttdeci">BaseType::NodesArrayType NodesArrayType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:108</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_aa44d52cdb8c4882076d8ff48be5d753c"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aa44d52cdb8c4882076d8ff48be5d753c">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::NodalResidualBasedEliminationBuilderAndSolverForFSI</a></div><div class="ttdeci">NodalResidualBasedEliminationBuilderAndSolverForFSI(typename TLinearSolver::Pointer pNewLinearSystemSolver)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:123</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_aaa29a2d5739f8c5923e09083e5711a83"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aaa29a2d5739f8c5923e09083e5711a83">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::TSystemVectorPointerType</a></div><div class="ttdeci">BaseType::TSystemVectorPointerType TSystemVectorPointerType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:104</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ab05179ab98dee1c5f2ad76befa431400"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab05179ab98dee1c5f2ad76befa431400">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::ResizeAndInitializeVectors</a></div><div class="ttdeci">void ResizeAndInitializeVectors(typename TSchemeType::Pointer pScheme, TSystemMatrixPointerType &amp;pA, TSystemVectorPointerType &amp;pDx, TSystemVectorPointerType &amp;pb, ModelPart &amp;rModelPart) override</div><div class="ttdoc">This method initializes and resizes the system of equations.</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1136</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ab4c47434d24da43859b4df11ae704db6"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ab4c47434d24da43859b4df11ae704db6">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::AssembleRowContributionFreeDofs</a></div><div class="ttdeci">void AssembleRowContributionFreeDofs(TSystemMatrixType &amp;rA, const Matrix &amp;rALocal, const IndexType i, const IndexType i_local, const Element::EquationIdVectorType &amp;EquationId)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1204</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_aba2d8f5bbe4b55366ee8fac411bb3477"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#aba2d8f5bbe4b55366ee8fac411bb3477">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::VectorType</a></div><div class="ttdeci">Vector VectorType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:114</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ac50df92d3663e24c6bc9d1c34a360d84"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac50df92d3663e24c6bc9d1c34a360d84">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::NodeType</a></div><div class="ttdeci">Node NodeType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:106</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ac9d5c08c8e4cfecd2f619f934b08d16f"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ac9d5c08c8e4cfecd2f619f934b08d16f">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::BackwardFind</a></div><div class="ttdeci">std::size_t BackwardFind(const std::size_t id_to_find, const std::size_t start, const std::size_t *index_vector)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1285</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ae1a9a1694c4529f69f559f3eaabdbea2"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae1a9a1694c4529f69f559f3eaabdbea2">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::ElementsArrayType</a></div><div class="ttdeci">BaseType::ElementsArrayType ElementsArrayType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:109</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ae2b0f7d8efc5b3a9d80ded8bd20c50fc"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae2b0f7d8efc5b3a9d80ded8bd20c50fc">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::TSystemMatrixType</a></div><div class="ttdeci">BaseType::TSystemMatrixType TSystemMatrixType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:95</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ae5c95462e1fc292662847de9ae5b905b"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae5c95462e1fc292662847de9ae5b905b">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::ConstructMatrixStructureForFSI</a></div><div class="ttdeci">virtual void ConstructMatrixStructureForFSI(typename TSchemeType::Pointer pScheme, TSystemMatrixType &amp;A, ModelPart &amp;rModelPart)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1368</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ae96724250229bcf10a03fd47f81e7b8a"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae96724250229bcf10a03fd47f81e7b8a">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::ElementsContainerType</a></div><div class="ttdeci">BaseType::ElementsContainerType ElementsContainerType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:112</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_ae9f9fa5aa1a15f1996e9a9dd4c8c6f50"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#ae9f9fa5aa1a15f1996e9a9dd4c8c6f50">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::TDataType</a></div><div class="ttdeci">BaseType::TDataType TDataType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:91</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_af0e05a6a19c238e4f51972c7e7c5929f"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af0e05a6a19c238e4f51972c7e7c5929f">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::TSystemMatrixPointerType</a></div><div class="ttdeci">BaseType::TSystemMatrixPointerType TSystemMatrixPointerType</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:103</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_af4ac10a7e6ab0c67e87f276d2f67bbc8"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#af4ac10a7e6ab0c67e87f276d2f67bbc8">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::ForwardFind</a></div><div class="ttdeci">std::size_t ForwardFind(const std::size_t id_to_find, const std::size_t start, const std::size_t *index_vector)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1275</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i_html_affb470f9ce0bf620a343f872eb8077b7"><div class="ttname"><a href="../../d9/df1/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_for_f_s_i.html#affb470f9ce0bf620a343f872eb8077b7">Kratos::NodalResidualBasedEliminationBuilderAndSolverForFSI::AssembleLHS</a></div><div class="ttdeci">void AssembleLHS(TSystemMatrixType &amp;A, LocalSystemMatrixType &amp;LHS_Contribution, Element::EquationIdVectorType &amp;EquationId)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver_for_FSI.h:1626</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_html"><div class="ttname"><a href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html">Kratos::NodalResidualBasedEliminationBuilderAndSolver</a></div><div class="ttdoc">Current class provides an implementation for standard builder and solving operations.</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver.h:80</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_html_a1726d3df37a63c27d8661c839bea96de"><div class="ttname"><a href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html#a1726d3df37a63c27d8661c839bea96de">Kratos::NodalResidualBasedEliminationBuilderAndSolver::SystemSolveWithPhysics</a></div><div class="ttdeci">void SystemSolveWithPhysics(TSystemMatrixType &amp;A, TSystemVectorType &amp;Dx, TSystemVectorType &amp;b, ModelPart &amp;rModelPart)</div><div class="ttdoc">This is a call to the linear system solver (taking into account some physical particularities of the ...</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver.h:457</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_html_a9761557533711204cca6dae7fd89ab82"><div class="ttname"><a href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html#a9761557533711204cca6dae7fd89ab82">Kratos::NodalResidualBasedEliminationBuilderAndSolver::ApplyDirichletConditions</a></div><div class="ttdeci">void ApplyDirichletConditions(typename TSchemeType::Pointer pScheme, ModelPart &amp;rModelPart, TSystemMatrixType &amp;A, TSystemVectorType &amp;Dx, TSystemVectorType &amp;b) override</div><div class="ttdoc">Applies the dirichlet conditions. This operation may be very heavy or completely unexpensive dependin...</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver.h:782</div></div>
<div class="ttc" id="aclass_kratos_1_1_nodal_residual_based_elimination_builder_and_solver_html_ac87e26beaa25e3e5eaa36c4e317c3dc5"><div class="ttname"><a href="../../d2/d8d/class_kratos_1_1_nodal_residual_based_elimination_builder_and_solver.html#ac87e26beaa25e3e5eaa36c4e317c3dc5">Kratos::NodalResidualBasedEliminationBuilderAndSolver::SetMaterialPropertiesToFluid</a></div><div class="ttdeci">void SetMaterialPropertiesToFluid(ModelPart::NodeIterator itNode, double &amp;density, double &amp;deviatoricCoeff, double &amp;volumetricCoeff, double timeInterval, double nodalVolume)</div><div class="ttdef"><b>Definition:</b> nodal_residualbased_elimination_builder_and_solver.h:143</div></div>
<div class="ttc" id="aclass_kratos_1_1_node_html"><div class="ttname"><a href="../../d5/ddd/class_kratos_1_1_node.html">Kratos::Node</a></div><div class="ttdoc">This class defines the node.</div><div class="ttdef"><b>Definition:</b> node.h:65</div></div>
<div class="ttc" id="aclass_kratos_1_1_open_m_p_utils_html_a25ab2a1b4dca7ecf3a1e4aee1039507e"><div class="ttname"><a href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a25ab2a1b4dca7ecf3a1e4aee1039507e">Kratos::OpenMPUtils::ThisThread</a></div><div class="ttdeci">static int ThisThread()</div><div class="ttdoc">Wrapper for omp_get_thread_num().</div><div class="ttdef"><b>Definition:</b> openmp_utils.h:108</div></div>
<div class="ttc" id="aclass_kratos_1_1_open_m_p_utils_html_a9fc68ec4d0fa71f7bdbb95bf636ef8f3"><div class="ttname"><a href="../../d6/d4e/class_kratos_1_1_open_m_p_utils.html#a9fc68ec4d0fa71f7bdbb95bf636ef8f3">Kratos::OpenMPUtils::PartitionedIterators</a></div><div class="ttdeci">static void PartitionedIterators(TVector &amp;rVector, typename TVector::iterator &amp;rBegin, typename TVector::iterator &amp;rEnd)</div><div class="ttdoc">Generate a partition for an std::vector-like array, providing iterators to the begin and end position...</div><div class="ttdef"><b>Definition:</b> openmp_utils.h:179</div></div>
<div class="ttc" id="aclass_kratos_1_1_parallel_utilities_html_aa9af37f90ccd77b2fd6b6ca7c0b58406"><div class="ttname"><a href="../../d3/da8/class_kratos_1_1_parallel_utilities.html#aa9af37f90ccd77b2fd6b6ca7c0b58406">Kratos::ParallelUtilities::GetNumThreads</a></div><div class="ttdeci">static int GetNumThreads()</div><div class="ttdoc">Returns the current number of threads.</div><div class="ttdef"><b>Definition:</b> parallel_utilities.cpp:34</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html">Kratos::PointerVectorSet</a></div><div class="ttdoc">A sorted associative container similar to an STL set, but uses a vector to store pointers to its data...</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:72</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a510c92d5ebe9a4beeb063269530ef31a"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a510c92d5ebe9a4beeb063269530ef31a">Kratos::PointerVectorSet::size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdoc">Returns the number of elements in the container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:502</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a7542007a871149bde5d4edfb73829d4f"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a7542007a871149bde5d4edfb73829d4f">Kratos::PointerVectorSet::Sort</a></div><div class="ttdeci">void Sort()</div><div class="ttdoc">Sort the elements in the set.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:817</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_a9d223f7af1848345c2d25830364314f0"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#a9d223f7af1848345c2d25830364314f0">Kratos::PointerVectorSet::push_back</a></div><div class="ttdeci">void push_back(TPointerType x)</div><div class="ttdoc">Adds a pointer to the end of the set.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:544</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_ac36a7d1445d4eadf75b341924f3aa4dd"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#ac36a7d1445d4eadf75b341924f3aa4dd">Kratos::PointerVectorSet::reserve</a></div><div class="ttdeci">void reserve(int reservedsize)</div><div class="ttdoc">Reserves memory for a specified number of elements.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:797</div></div>
<div class="ttc" id="aclass_kratos_1_1_pointer_vector_set_html_acc410959c998f861779d4e180822b78b"><div class="ttname"><a href="../../db/dc6/class_kratos_1_1_pointer_vector_set.html#acc410959c998f861779d4e180822b78b">Kratos::PointerVectorSet::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdoc">Returns an iterator pointing to the end of the container.</div><div class="ttdef"><b>Definition:</b> pointer_vector_set.h:314</div></div>
<div class="ttc" id="aclass_kratos_1_1_process_info_html"><div class="ttname"><a href="../../db/deb/class_kratos_1_1_process_info.html">Kratos::ProcessInfo</a></div><div class="ttdoc">ProcessInfo holds the current value of different solution parameters.</div><div class="ttdef"><b>Definition:</b> process_info.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_scheme_html"><div class="ttname"><a href="../../d1/da3/class_kratos_1_1_scheme.html">Kratos::Scheme</a></div><div class="ttdoc">This class provides the implementation of the basic tasks that are needed by the solution strategy.</div><div class="ttdef"><b>Definition:</b> scheme.h:56</div></div>
<div class="ttc" id="aclass_kratos_1_1_timer_html_a08db3e5418419f02685c343cc0a63d9c"><div class="ttname"><a href="../../d9/d31/class_kratos_1_1_timer.html#a08db3e5418419f02685c343cc0a63d9c">Kratos::Timer::Start</a></div><div class="ttdeci">static void Start(std::string const &amp;rIntervalName)</div><div class="ttdoc">This method starts the timer meassures.</div><div class="ttdef"><b>Definition:</b> timer.cpp:109</div></div>
<div class="ttc" id="aclass_kratos_1_1_timer_html_a78abd4fabca3e2717ab611417eef96dd"><div class="ttname"><a href="../../d9/d31/class_kratos_1_1_timer.html#a78abd4fabca3e2717ab611417eef96dd">Kratos::Timer::Stop</a></div><div class="ttdeci">static void Stop(std::string const &amp;rIntervalName)</div><div class="ttdoc">This method stops the timer meassures.</div><div class="ttdef"><b>Definition:</b> timer.cpp:125</div></div>
<div class="ttc" id="aclass_kratos_1_1array__1d_html"><div class="ttname"><a href="../../d4/ddc/class_kratos_1_1array__1d.html">Kratos::array_1d&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="adefine_8h_html"><div class="ttname"><a href="../../df/d67/define_8h.html">define.h</a></div></div>
<div class="ttc" id="adefine_8h_html_a5eac541f5e39bf0360a12f51f0248513"><div class="ttname"><a href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a></div><div class="ttdeci">#define KRATOS_CATCH(MoreInfo)</div><div class="ttdef"><b>Definition:</b> define.h:110</div></div>
<div class="ttc" id="adefine_8h_html_a6135b00508a42f0e8f91d1369644cbc1"><div class="ttname"><a href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a></div><div class="ttdeci">#define KRATOS_WATCH(variable)</div><div class="ttdef"><b>Definition:</b> define.h:837</div></div>
<div class="ttc" id="adefine_8h_html_ab9c29d6a0d19ff26bbc4e45e3181fb3f"><div class="ttname"><a href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div><div class="ttdeci">#define KRATOS_TRY</div><div class="ttdef"><b>Definition:</b> define.h:109</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga376e02451bc7cc3a5fd77b57f0549e6b"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga376e02451bc7cc3a5fd77b57f0549e6b">KRATOS_ERROR</a></div><div class="ttdeci">#define KRATOS_ERROR</div><div class="ttdef"><b>Definition:</b> exception.h:161</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga421c079910a05f8a88688b045190ac9b"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga421c079910a05f8a88688b045190ac9b">KRATOS_ERROR_IF_NOT</a></div><div class="ttdeci">#define KRATOS_ERROR_IF_NOT(conditional)</div><div class="ttdef"><b>Definition:</b> exception.h:163</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga9fdd4e0364598f28a529107663707cf3"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a></div><div class="ttdeci">#define KRATOS_ERROR_IF(conditional)</div><div class="ttdef"><b>Definition:</b> exception.h:162</div></div>
<div class="ttc" id="agroup___kratos_html_ga77c49181bec73a59e8ad275f8a56cdd0"><div class="ttname"><a href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a></div><div class="ttdeci">#define KRATOS_INFO_IF(label, conditional)</div><div class="ttdef"><b>Definition:</b> logger.h:251</div></div>
<div class="ttc" id="akey__hash_8h_html"><div class="ttname"><a href="../../d9/d48/key__hash_8h.html">key_hash.h</a></div></div>
<div class="ttc" id="amodel__part_8h_html"><div class="ttname"><a href="../../dd/dfe/model__part_8h.html">model_part.h</a></div></div>
<div class="ttc" id="anamespace_d_e_m__benchmarks_html_a1fc5d00464e8eee288be8f84f871b6f9"><div class="ttname"><a href="../../d3/d1a/namespace_d_e_m__benchmarks.html#a1fc5d00464e8eee288be8f84f871b6f9">DEM_benchmarks.start</a></div><div class="ttdeci">start</div><div class="ttdef"><b>Definition:</b> DEM_benchmarks.py:17</div></div>
<div class="ttc" id="anamespace_kratos_html"><div class="ttname"><a href="../../db/d66/namespace_kratos.html">Kratos</a></div><div class="ttdoc">REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.</div><div class="ttdef"><b>Definition:</b> example_benchmark.cpp:24</div></div>
<div class="ttc" id="anamespace_kratos_html_a0060702fbd6c7d45c773436101c9ded3"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a0060702fbd6c7d45c773436101c9ded3">Kratos::ZeroVector</a></div><div class="ttdeci">KratosZeroVector&lt; double &gt; ZeroVector</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:561</div></div>
<div class="ttc" id="anamespace_kratos_html_a358df20da9726efb77013692eb628f08"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a358df20da9726efb77013692eb628f08">Kratos::ZeroMatrix</a></div><div class="ttdeci">KratosZeroMatrix&lt; double &gt; ZeroMatrix</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:559</div></div>
<div class="ttc" id="anamespace_kratos_html_aaff3672cc52b90ee3d84713de272e1b5"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">Kratos::noalias</a></div><div class="ttdeci">T &amp; noalias(T &amp;TheMatrix)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:484</div></div>
<div class="ttc" id="anamespaceface__heat_html_ad8009a31d6756733e3d631b91d8683bc"><div class="ttname"><a href="../../d6/dd7/namespaceface__heat.html#ad8009a31d6756733e3d631b91d8683bc">face_heat.density</a></div><div class="ttdeci">float density</div><div class="ttdef"><b>Definition:</b> face_heat.py:56</div></div>
<div class="ttc" id="anamespacegenerate__convection__diffusion__explicit__element_html_a148e6b79cc167914310abbc3f842f75a"><div class="ttname"><a href="../../d8/d57/namespacegenerate__convection__diffusion__explicit__element.html#a148e6b79cc167914310abbc3f842f75a">generate_convection_diffusion_explicit_element.v</a></div><div class="ttdeci">v</div><div class="ttdef"><b>Definition:</b> generate_convection_diffusion_explicit_element.py:114</div></div>
<div class="ttc" id="anamespacegenerate__total__lagrangian__mixed__volumetric__strain__element_html_a1c3ce957bb604e9e317faf3f7fbfc834"><div class="ttname"><a href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#a1c3ce957bb604e9e317faf3f7fbfc834">generate_total_lagrangian_mixed_volumetric_strain_element.local_size</a></div><div class="ttdeci">int local_size</div><div class="ttdef"><b>Definition:</b> generate_total_lagrangian_mixed_volumetric_strain_element.py:17</div></div>
<div class="ttc" id="anamespacegenerate__total__lagrangian__mixed__volumetric__strain__element_html_aa9be8bca3cd4b9f0c16093a9dda89988"><div class="ttname"><a href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">generate_total_lagrangian_mixed_volumetric_strain_element.b</a></div><div class="ttdeci">b</div><div class="ttdef"><b>Definition:</b> generate_total_lagrangian_mixed_volumetric_strain_element.py:31</div></div>
<div class="ttc" id="anamespaceisotropic__damage__automatic__differentiation_html_a3d30b20e72b60cc184b00182233472ba"><div class="ttname"><a href="../../d3/d2b/namespaceisotropic__damage__automatic__differentiation.html#a3d30b20e72b60cc184b00182233472ba">isotropic_damage_automatic_differentiation.dimension</a></div><div class="ttdeci">int dimension</div><div class="ttdef"><b>Definition:</b> isotropic_damage_automatic_differentiation.py:123</div></div>
<div class="ttc" id="anamespacequadrature_html_a56123f01f0d1e776d9a6d85aa0f27caa"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">quadrature.k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> quadrature.py:595</div></div>
<div class="ttc" id="anamespacequadrature_html_aae897447319c4634b1dcef7634fe5876"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">quadrature.j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> quadrature.py:648</div></div>
<div class="ttc" id="anamespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t_html_a37fe67255f2e1d30f90f0f02ceb60616"><div class="ttname"><a href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">script_THERMAL_CORRECT.counter</a></div><div class="ttdeci">int counter</div><div class="ttdef"><b>Definition:</b> script_THERMAL_CORRECT.py:218</div></div>
<div class="ttc" id="anamespacesensitivity_matrix_html_a276ae82595c6ebe2f05987c7af893337"><div class="ttname"><a href="../../d0/d79/namespacesensitivity_matrix.html#a276ae82595c6ebe2f05987c7af893337">sensitivityMatrix.A</a></div><div class="ttdeci">A</div><div class="ttdef"><b>Definition:</b> sensitivityMatrix.py:70</div></div>
<div class="ttc" id="anamespacetensors_html_a15a1da80aa773e2015eba781cababe05"><div class="ttname"><a href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">tensors::i</a></div><div class="ttdeci">integer i</div><div class="ttdef"><b>Definition:</b> TensorModule.f:17</div></div>
<div class="ttc" id="anamespacetest__pureconvectionsolver__benchmarking_html_a2480f8b7f9f6fd8b9ed481e4057ee92a"><div class="ttname"><a href="../../d7/dd6/namespacetest__pureconvectionsolver__benchmarking.html#a2480f8b7f9f6fd8b9ed481e4057ee92a">test_pureconvectionsolver_benchmarking.pressure</a></div><div class="ttdeci">float pressure</div><div class="ttdef"><b>Definition:</b> test_pureconvectionsolver_benchmarking.py:101</div></div>
<div class="ttc" id="anodal__residualbased__elimination__builder__and__solver_8h_html"><div class="ttname"><a href="../../d7/ddd/nodal__residualbased__elimination__builder__and__solver_8h.html">nodal_residualbased_elimination_builder_and_solver.h</a></div></div>
<div class="ttc" id="apfem__fluid__dynamics__application__variables_8h_html"><div class="ttname"><a href="../../da/d6b/pfem__fluid__dynamics__application__variables_8h.html">pfem_fluid_dynamics_application_variables.h</a></div></div>
<div class="ttc" id="atimer_8h_html"><div class="ttname"><a href="../../d5/dd0/timer_8h.html">timer.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 27 2024 02:55:18 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
