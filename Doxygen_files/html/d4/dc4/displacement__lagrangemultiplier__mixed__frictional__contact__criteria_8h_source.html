<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: /home/runner/work/Documentation/Documentation/master/applications/ContactStructuralMechanicsApplication/custom_strategies/custom_convergencecriterias/displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_1d3f81d59b981edbac5b068c0b6c45dd.html">ContactStructuralMechanicsApplication</a></li><li class="navelem"><a class="el" href="../../dir_2e58168c4420ee6a2d8f9d0ffa5a7698.html">custom_strategies</a></li><li class="navelem"><a class="el" href="../../dir_fe47e2dd02163a6c34f3d037442975c5.html">custom_convergencecriterias</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/dc4/displacement__lagrangemultiplier__mixed__frictional__contact__criteria_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// KRATOS    ______            __             __  _____ __                  __                   __</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//          / ____/___  ____  / /_____ ______/ /_/ ___// /________  _______/ /___  ___________ _/ /</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//         / /   / __ \/ __ \/ __/ __ `/ ___/ __/\__ \/ __/ ___/ / / / ___/ __/ / / / ___/ __ `/ / </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//        / /___/ /_/ / / / / /_/ /_/ / /__/ /_ ___/ / /_/ /  / /_/ / /__/ /_/ /_/ / /  / /_/ / /  </span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//        \____/\____/_/ /_/\__/\__,_/\___/\__//____/\__/_/   \__,_/\___/\__/\__,_/_/   \__,_/_/  MECHANICS</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  License:         BSD License</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//                   license: ContactStructuralMechanicsApplication/license.txt</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  Main authors:    Vicente Mataix Ferrandiz</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// System includes</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// External includes</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// Project includes</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d9c/table__stream__utility_8h.html">utilities/table_stream_utility.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d28/color__utilities_8h.html">utilities/color_utilities.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d09/convergence__criteria_8h.html">solving_strategies/convergencecriterias/convergence_criteria.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/d61/active__set__utilities_8h.html">custom_utilities/active_set_utilities.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/deb/contact__utilities_8h.html">custom_utilities/contact_utilities.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dea/constraint__utilities_8h.html">utilities/constraint_utilities.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../db/d66/namespace_kratos.html">Kratos</a></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">template</span>&lt;   <span class="keyword">class </span>TSparseSpace,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <span class="keyword">class </span>TDenseSpace &gt;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d3/d27/class_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria.html">   61</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d3/d27/class_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria.html">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    : <span class="keyword">public</span> <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">ConvergenceCriteria</a>&lt; TSparseSpace, TDenseSpace &gt;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabd945ad450389d94bddbc585d056c6cf">   70</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabd945ad450389d94bddbc585d056c6cf">KRATOS_CLASS_POINTER_DEFINITION</a>( <a class="code" href="../../d3/d27/class_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria.html">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a> );</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga2f08d47eedc22d06735791ef9e6065d4">   73</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga2f08d47eedc22d06735791ef9e6065d4">KRATOS_DEFINE_LOCAL_FLAG</a>( ENSURE_CONTACT );</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga653de6224f72eb7f3c5e9eb756a0addc">   74</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga653de6224f72eb7f3c5e9eb756a0addc">KRATOS_DEFINE_LOCAL_FLAG</a>( PRINTING_OUTPUT );</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga684b187e729ec1069be707e84c0affd9">   75</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga684b187e729ec1069be707e84c0affd9">KRATOS_DEFINE_LOCAL_FLAG</a>( TABLE_IS_INITIALIZED );</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gab7412a2c83fcd79a973e918558b2eadb">   76</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gab7412a2c83fcd79a973e918558b2eadb">KRATOS_DEFINE_LOCAL_FLAG</a>( ROTATION_DOF_IS_CONSIDERED );</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gae82075087fd73ead10dffdd59439b6ea">   77</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gae82075087fd73ead10dffdd59439b6ea">KRATOS_DEFINE_LOCAL_FLAG</a>( PURE_SLIP );</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gaa9ca8be7c58c5ad19d85f086e85d778f">   78</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gaa9ca8be7c58c5ad19d85f086e85d778f">KRATOS_DEFINE_LOCAL_FLAG</a>( INITIAL_RESIDUAL_IS_SET );</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gaf0a75a46fbd68eadd514ef475289fc74">   81</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">BaseType</a> = <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">ConvergenceCriteria&lt;TSparseSpace, TDenseSpace&gt;</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gab720dc08f01aab0539db534412d53ed9">   84</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">ClassType</a> = <a class="code" href="../../d3/d27/class_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria.html">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;</a>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad683d84c96d54a9d4cadfbc243038f8a">   87</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad683d84c96d54a9d4cadfbc243038f8a">DofsArrayType</a> = <span class="keyword">typename</span> <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a83c72adb9f59b5f42df937e2ac36b6a6">BaseType::DofsArrayType</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga46cf645153253815947def755c7df672">   90</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga46cf645153253815947def755c7df672">TSystemMatrixType</a> = <span class="keyword">typename</span> <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a7b42d9b99bab0e8234d007eeda0e0a69">BaseType::TSystemMatrixType</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">   93</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a> = <span class="keyword">typename</span> <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#abb4527f26178f7e5824722f27481a92b">BaseType::TSystemVectorType</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga0661bd6a7a634e64f4eadb60cc08d48f">   96</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga0661bd6a7a634e64f4eadb60cc08d48f">SparseSpaceType</a> = TSparseSpace;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">   99</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">TablePrinterPointerType</a> = TableStreamUtility::Pointer;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gac6cee4de634829daa1db7d91f4b3592f">  102</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gac6cee4de634829daa1db7d91f4b3592f">IndexType</a> = std::size_t;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">  105</a></span>&#160;    <span class="keyword">static</span> constexpr <span class="keywordtype">double</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a> = std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga3f9d9f304249ce9885f481af54200e92">  114</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga3f9d9f304249ce9885f481af54200e92">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a>()</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        : <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">BaseType</a>()</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga0594edd2dd880b4b0361a8e35d4196cf">  123</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga0594edd2dd880b4b0361a8e35d4196cf">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a>(<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Kratos::Parameters</a> ThisParameters)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        : <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">BaseType</a>()</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// Validate and assign defaults</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        ThisParameters = this-&gt;<a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a76d595b2d1bfc2fd3c1075cd4c9452ab">ValidateAndAssignParameters</a>(ThisParameters, this-&gt;<a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabc3fbf9bb998b705fe1446176ae00541">GetDefaultParameters</a>());</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        this-&gt;<a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad2b4f10c2744918e6dd8c5e6c0b0ae2a">AssignSettings</a>(ThisParameters);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga3aded5dada01154cb3c4e821cb138a71">  144</a></span>&#160;    <span class="keyword">explicit</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga3aded5dada01154cb3c4e821cb138a71">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a>(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> DispRatioTolerance,</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> DispAbsTolerance,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> RotRatioTolerance,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> RotAbsTolerance,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> LMNormalRatioTolerance,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> LMNormalAbsTolerance,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> LMTangentStickRatioTolerance,</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> LMTangentStickAbsTolerance,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> LMTangentSlipRatioTolerance,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> LMTangentSlipAbsTolerance,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> NormalTangentRatio,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> EnsureContact = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> PureSlip = <span class="keyword">false</span>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">bool</span> PrintingOutput = <span class="keyword">false</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        )</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        : <a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">BaseType</a>()</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// Set local flags</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ENSURE_CONTACT, EnsureContact);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT, PrintingOutput);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TABLE_IS_INITIALIZED, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP, PureSlip);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::INITIAL_RESIDUAL_IS_SET, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">// The displacement residual</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        mDispRatioTolerance = DispRatioTolerance;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        mDispAbsTolerance = DispAbsTolerance;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// The rotation residual</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        mRotRatioTolerance = RotRatioTolerance;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        mRotAbsTolerance = RotAbsTolerance;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// The normal contact residual</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        mLMNormalRatioTolerance = LMNormalRatioTolerance;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        mLMNormalAbsTolerance = LMNormalAbsTolerance;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// The tangent contact residual</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        mLMTangentStickRatioTolerance = LMTangentStickRatioTolerance;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        mLMTangentStickAbsTolerance = LMTangentStickAbsTolerance;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        mLMTangentSlipRatioTolerance = LMTangentSlipRatioTolerance;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        mLMTangentSlipAbsTolerance = LMTangentSlipAbsTolerance;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="comment">// We get the  ratio between the normal and tangent that will accepted as converged</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        mNormalTangentRatio = NormalTangentRatio;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">//* Copy constructor.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad0a25c830c1204f263dba01a006b8553">  193</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad0a25c830c1204f263dba01a006b8553">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a>( <a class="code" href="../../d3/d27/class_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria.html">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a> <span class="keyword">const</span>&amp; rOther )</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      :<a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">BaseType</a>(rOther)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      ,mOptions(rOther.mOptions)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      ,mDispRatioTolerance(rOther.mDispRatioTolerance)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      ,mDispAbsTolerance(rOther.mDispAbsTolerance)</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      ,mDispInitialResidualNorm(rOther.mDispInitialResidualNorm)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      ,mDispCurrentResidualNorm(rOther.mDispCurrentResidualNorm)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      ,mRotRatioTolerance(rOther.mRotRatioTolerance)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      ,mRotAbsTolerance(rOther.mRotAbsTolerance)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      ,mRotInitialResidualNorm(rOther.mRotInitialResidualNorm)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      ,mRotCurrentResidualNorm(rOther.mRotCurrentResidualNorm)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      ,mLMNormalRatioTolerance(rOther.mLMNormalRatioTolerance)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      ,mLMNormalAbsTolerance(rOther.mLMNormalAbsTolerance)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      ,mLMTangentStickRatioTolerance(rOther.mLMTangentStickRatioTolerance)</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      ,mLMTangentStickAbsTolerance(rOther.mLMTangentStickAbsTolerance)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      ,mLMTangentSlipRatioTolerance(rOther.mLMTangentSlipRatioTolerance)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      ,mLMTangentSlipAbsTolerance(rOther.mLMTangentSlipAbsTolerance)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      ,mNormalTangentRatio(rOther.mNormalTangentRatio)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad0b6c57e34829fa0ec8e1202fbc0110f">  215</a></span>&#160;    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad0b6c57e34829fa0ec8e1202fbc0110f">~DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a>() <span class="keyword">override</span> = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga213b865f2c14cfa102fd40484e45393b">  229</a></span>&#160;    <span class="keyword">typename</span> BaseType::Pointer <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga213b865f2c14cfa102fd40484e45393b">Create</a>(<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Parameters</a> ThisParameters)<span class="keyword"> const override</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">return</span> Kratos::make_shared&lt;ClassType&gt;(ThisParameters);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga5774a8b4049b41c3ba9b0638bbf539ce">  243</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga5774a8b4049b41c3ba9b0638bbf539ce">PostCriteria</a>(</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad683d84c96d54a9d4cadfbc243038f8a">DofsArrayType</a>&amp; rDofSet,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga46cf645153253815947def755c7df672">TSystemMatrixType</a>&amp; rA,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        )<span class="keyword"> override</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d69/class_kratos_1_1_ublas_space.html#aceeb8477b38225ca40028dc9149f85d9">SparseSpaceType::Size</a>(rb) != 0) { <span class="comment">//if we are solving for something</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">// Getting process info</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a>&amp; r_process_info = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="comment">// Initialize</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="keywordtype">double</span> disp_residual_solution_norm = 0.0, rot_residual_solution_norm = 0.0,normal_lm_solution_norm = 0.0, normal_lm_increase_norm = 0.0, tangent_lm_stick_solution_norm = 0.0, tangent_lm_slip_solution_norm = 0.0, tangent_lm_stick_increase_norm = 0.0, tangent_lm_slip_increase_norm = 0.0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gac6cee4de634829daa1db7d91f4b3592f">IndexType</a> disp_dof_num(0),rot_dof_num(0),lm_dof_num(0),lm_stick_dof_num(0),lm_slip_dof_num(0);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">// The nodes array</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keyword">auto</span>&amp; r_nodes_array = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">// Auxiliary values</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keyword">struct </span>AuxValues {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                std::size_t dof_id = 0;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordtype">double</span> residual_dof_value = 0.0, dof_value = 0.0, dof_incr = 0.0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            };</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> pure_slip = mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">// The number of active dofs</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keyword">const</span> std::size_t number_active_dofs = rb.size();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">// Auxiliary displacement DoF check</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keyword">const</span> std::function&lt;<a class="code" href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">bool</a>(<span class="keyword">const</span> <a class="code" href="../../d9/dfe/class_kratos_1_1_variable_data.html">VariableData</a>&amp;)&gt; check_without_rot =</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            [](<span class="keyword">const</span> <a class="code" href="../../d9/dfe/class_kratos_1_1_variable_data.html">VariableData</a>&amp; rCurrVar) -&gt; <span class="keywordtype">bool</span> {<span class="keywordflow">return</span> <span class="keyword">true</span>;};</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keyword">const</span> std::function&lt;<a class="code" href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">bool</a>(<span class="keyword">const</span> <a class="code" href="../../d9/dfe/class_kratos_1_1_variable_data.html">VariableData</a>&amp;)&gt; check_with_rot =</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            [](<span class="keyword">const</span> <a class="code" href="../../d9/dfe/class_kratos_1_1_variable_data.html">VariableData</a>&amp; rCurrVar) -&gt; <span class="keywordtype">bool</span> {<span class="keywordflow">return</span> ((rCurrVar == DISPLACEMENT_X) || (rCurrVar == DISPLACEMENT_Y) || (rCurrVar == DISPLACEMENT_Z));};</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span>* p_check_disp = (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) ? &amp;check_with_rot : &amp;check_without_rot;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">// Loop over Dofs</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keyword">using</span> ThirteenReduction = <a class="code" href="../../d7/d46/struct_kratos_1_1_combined_reduction.html">CombinedReduction&lt;SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;double&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;IndexType&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;IndexType&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;IndexType&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;IndexType&gt;</a>, <a class="code" href="../../df/dfe/class_kratos_1_1_sum_reduction.html">SumReduction&lt;IndexType&gt;</a>&gt;;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            std::tie(disp_residual_solution_norm,rot_residual_solution_norm,normal_lm_solution_norm,normal_lm_increase_norm,tangent_lm_slip_solution_norm,tangent_lm_slip_increase_norm, tangent_lm_stick_solution_norm,tangent_lm_stick_increase_norm,disp_dof_num,rot_dof_num,lm_dof_num, lm_slip_dof_num, lm_stick_dof_num) = block_for_each&lt;ThirteenReduction&gt;(rDofSet, AuxValues(), [<span class="keyword">this</span>,&amp;number_active_dofs,p_check_disp,&amp;pure_slip,&amp;r_nodes_array,&amp;rb,&amp;rDx](<a class="code" href="../../dc/d58/class_kratos_1_1_dof.html">Dof&lt;double&gt;</a>&amp; rDof, AuxValues&amp; aux_values) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                aux_values.dof_id = rDof.<a class="code" href="../../dc/d58/class_kratos_1_1_dof.html#ad16ba5c333c5d7320c3805d83bbe325e">EquationId</a>();</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                aux_values.dof_id = rDof.<a class="code" href="../../dc/d58/class_kratos_1_1_dof.html#ad16ba5c333c5d7320c3805d83bbe325e">EquationId</a>();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="comment">// Check dof id is solved</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="keywordflow">if</span> (aux_values.dof_id &lt; number_active_dofs) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    if (mActiveDofs[aux_values.dof_id] == 1) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        const auto&amp; r_curr_var = rDof.GetVariable();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        if (r_curr_var == VECTOR_LAGRANGE_MULTIPLIER_X || r_curr_var == VECTOR_LAGRANGE_MULTIPLIER_Y || r_curr_var == VECTOR_LAGRANGE_MULTIPLIER_Z) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                            <span class="comment">// The normal of the node (TODO: how to solve this without accesing all the time to the database?)</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                            const auto it_node = r_nodes_array.find(rDof.Id());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                            aux_values.dof_value = rDof.GetSolutionStepValue(0);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                            aux_values.dof_incr = rDx[aux_values.dof_id];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                            const double mu = it_node-&gt;GetValue(FRICTION_COEFFICIENT);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                            if (mu &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                return std::make_tuple(0.0,0.0,std::pow(aux_values.dof_value, 2),std::pow(aux_values.dof_incr, 2),0.0,0.0,0.0,0.0,0,0,1,0,0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                            } else {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                const double normal = it_node-&gt;FastGetSolutionStepValue(NORMAL)[r_curr_var.GetComponentIndex()];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                const double normal_dof_value = aux_values.dof_value * normal;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                const double normal_dof_incr = aux_values.dof_incr * normal;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                if (it_node-&gt;Is(SLIP) || pure_slip) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                    return std::make_tuple(0.0,0.0,std::pow(normal_dof_value, 2),std::pow(normal_dof_incr, 2),std::pow(aux_values.dof_value - normal_dof_value, 2),std::pow(aux_values.dof_incr - normal_dof_incr, 2),0.0,0.0,0,0,1,1,0);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                } else {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                    return std::make_tuple(0.0,0.0,std::pow(normal_dof_value, 2),std::pow(normal_dof_incr, 2),0.0,0.0,std::pow(aux_values.dof_value - normal_dof_value, 2),std::pow(aux_values.dof_incr - normal_dof_incr, 2),0,0,1,0,1);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        } else if ((*p_check_disp)(r_curr_var)) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                            aux_values.residual_dof_value = rb[aux_values.dof_id];</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                            return std::make_tuple(std::pow(aux_values.residual_dof_value, 2),0.0,0.0,0.0,0.0,0.0,0.0,0.0,1,0,0,0,0);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                        } else { <span class="comment">// We will assume is rotation dof</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                            KRATOS_DEBUG_ERROR_IF_NOT((r_curr_var == ROTATION_X) || (r_curr_var == ROTATION_Y) || (r_curr_var == ROTATION_Z)) &lt;&lt; <span class="stringliteral">&quot;Variable must be a ROTATION and it is: &quot;</span> &lt;&lt; r_curr_var.Name() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                            aux_values.residual_dof_value = rb[aux_values.dof_id];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                            return std::make_tuple(0.0,std::pow(aux_values.residual_dof_value, 2),0.0,0.0,0.0,0.0,0.0,0.0,0,1,0,0,0);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keywordflow">return</span> std::make_tuple(0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0,0,0,0,0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            });</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="keywordflow">if</span>(normal_lm_increase_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) normal_lm_increase_norm = 1.0;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">if</span>(tangent_lm_stick_increase_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) tangent_lm_stick_increase_norm = 1.0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            <span class="keywordflow">if</span>(tangent_lm_slip_increase_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) tangent_lm_slip_increase_norm = 1.0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <a class="code" href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a>(mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ENSURE_CONTACT) &amp;&amp; normal_lm_solution_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) &lt;&lt; <span class="stringliteral">&quot;ERROR::CONTACT LOST::ARE YOU SURE YOU ARE SUPPOSED TO HAVE CONTACT?&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            mDispCurrentResidualNorm = disp_residual_solution_norm;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            mRotCurrentResidualNorm = rot_residual_solution_norm;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> normal_lm_ratio = std::sqrt(normal_lm_increase_norm/normal_lm_solution_norm);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> tangent_lm_slip_ratio = tangent_lm_slip_solution_norm &gt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a> ? std::sqrt(tangent_lm_slip_increase_norm/tangent_lm_slip_solution_norm) : 0.0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> tangent_lm_stick_ratio = tangent_lm_stick_solution_norm &gt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a> ? std::sqrt(tangent_lm_stick_increase_norm/tangent_lm_stick_solution_norm) : 0.0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> normal_lm_abs = std::sqrt(normal_lm_increase_norm)/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(lm_dof_num);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> tangent_lm_stick_abs = lm_stick_dof_num &gt; 0 ?  std::sqrt(tangent_lm_stick_increase_norm)/ <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(lm_stick_dof_num) : 0.0;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> tangent_lm_slip_abs = lm_slip_dof_num &gt; 0 ? std::sqrt(tangent_lm_slip_increase_norm)/ <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(lm_slip_dof_num) : 0.0;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> normal_tangent_stick_ratio = tangent_lm_stick_abs/normal_lm_abs;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> normal_tangent_slip_ratio = tangent_lm_slip_abs/normal_lm_abs;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="keywordtype">double</span> residual_disp_ratio, residual_rot_ratio;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="comment">// We initialize the solution</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::INITIAL_RESIDUAL_IS_SET)) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                mDispInitialResidualNorm = (disp_residual_solution_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) ? 1.0 : disp_residual_solution_norm;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                residual_disp_ratio = 1.0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    mRotInitialResidualNorm = (rot_residual_solution_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) ? 1.0 : rot_residual_solution_norm;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    residual_rot_ratio = 1.0;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::INITIAL_RESIDUAL_IS_SET, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="comment">// We calculate the ratio of the displacements</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            residual_disp_ratio = mDispCurrentResidualNorm/mDispInitialResidualNorm;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">// We calculate the ratio of the rotations</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            residual_rot_ratio = mRotCurrentResidualNorm/mRotInitialResidualNorm;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="comment">// We calculate the absolute norms</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">double</span> residual_disp_abs = mDispCurrentResidualNorm/disp_dof_num;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="keywordtype">double</span> residual_rot_abs = mRotCurrentResidualNorm/rot_dof_num;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="comment">// We print the results // TODO: Replace for the new log</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">if</span> (rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">GetCommunicator</a>().<a class="code" href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">MyPID</a>() == 0 &amp;&amp; this-&gt;<a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a3c900ee41bfebf3b56229de2622e8d21">GetEchoLevel</a>() &gt; 0) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                <span class="keywordflow">if</span> (r_process_info.Has(TABLE_UTILITY)) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    std::cout.precision(4);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">TablePrinterPointerType</a> p_table = r_process_info[TABLE_UTILITY];</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    <span class="keyword">auto</span>&amp; r_table = p_table-&gt;GetTable();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP)) {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                            r_table &lt;&lt; residual_disp_ratio &lt;&lt; mDispRatioTolerance &lt;&lt; residual_disp_abs &lt;&lt; mDispAbsTolerance &lt;&lt; residual_rot_ratio &lt;&lt; mRotRatioTolerance &lt;&lt; residual_rot_abs &lt;&lt; mRotAbsTolerance &lt;&lt; normal_lm_ratio  &lt;&lt; mLMNormalRatioTolerance  &lt;&lt; normal_lm_abs  &lt;&lt; mLMNormalAbsTolerance &lt;&lt; tangent_lm_stick_ratio  &lt;&lt; mLMTangentStickRatioTolerance  &lt;&lt; tangent_lm_stick_abs  &lt;&lt; mLMTangentSlipAbsTolerance &lt;&lt; tangent_lm_slip_ratio  &lt;&lt; mLMTangentSlipRatioTolerance  &lt;&lt; tangent_lm_slip_abs  &lt;&lt; mLMTangentStickAbsTolerance;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                            r_table &lt;&lt; residual_disp_ratio &lt;&lt; mDispRatioTolerance &lt;&lt; residual_disp_abs &lt;&lt; mDispAbsTolerance &lt;&lt; residual_rot_ratio &lt;&lt; mRotRatioTolerance &lt;&lt; residual_rot_abs &lt;&lt; mRotAbsTolerance &lt;&lt; normal_lm_ratio  &lt;&lt; mLMNormalRatioTolerance  &lt;&lt; normal_lm_abs  &lt;&lt; mLMNormalAbsTolerance &lt;&lt; tangent_lm_slip_ratio  &lt;&lt; mLMTangentSlipRatioTolerance  &lt;&lt; tangent_lm_slip_abs  &lt;&lt; mLMTangentSlipAbsTolerance;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                        }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP)) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                            r_table &lt;&lt; residual_disp_ratio &lt;&lt; mDispRatioTolerance &lt;&lt; residual_disp_abs &lt;&lt; mDispAbsTolerance &lt;&lt; normal_lm_ratio  &lt;&lt; mLMNormalRatioTolerance  &lt;&lt; normal_lm_abs  &lt;&lt; mLMNormalAbsTolerance &lt;&lt; tangent_lm_stick_ratio  &lt;&lt; mLMTangentStickRatioTolerance  &lt;&lt; tangent_lm_stick_abs  &lt;&lt; mLMTangentSlipAbsTolerance &lt;&lt; tangent_lm_slip_ratio  &lt;&lt; mLMTangentSlipRatioTolerance  &lt;&lt; tangent_lm_slip_abs  &lt;&lt; mLMTangentStickAbsTolerance;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                            r_table &lt;&lt; residual_disp_ratio &lt;&lt; mDispRatioTolerance &lt;&lt; residual_disp_abs &lt;&lt; mDispAbsTolerance &lt;&lt; normal_lm_ratio  &lt;&lt; mLMNormalRatioTolerance  &lt;&lt; normal_lm_abs  &lt;&lt; mLMNormalAbsTolerance &lt;&lt; tangent_lm_slip_ratio  &lt;&lt; mLMTangentSlipRatioTolerance  &lt;&lt; tangent_lm_slip_abs  &lt;&lt; mLMTangentSlipAbsTolerance;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    std::cout.precision(4);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT)) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot;MIXED CONVERGENCE CHECK&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\tSTEP: &quot;</span> &lt;&lt; r_process_info[STEP] &lt;&lt; <span class="stringliteral">&quot;\tNL ITERATION: &quot;</span> &lt;&lt; r_process_info[NL_ITERATION_NUMBER] &lt;&lt; std::endl &lt;&lt; std::scientific;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot;\tDISPLACEMENT: RATIO = &quot;</span>) &lt;&lt; residual_disp_ratio &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.RATIO = &quot;</span>) &lt;&lt; mDispRatioTolerance &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; ABS = &quot;</span>) &lt;&lt; residual_disp_abs &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.ABS = &quot;</span>) &lt;&lt; mDispAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                            <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot;\tROTATION: RATIO = &quot;</span>) &lt;&lt; residual_rot_ratio &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.RATIO = &quot;</span>) &lt;&lt; mRotRatioTolerance &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; ABS = &quot;</span>) &lt;&lt; residual_rot_abs &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.ABS = &quot;</span>) &lt;&lt; mRotAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot;\tNORMAL LAGRANGE MUL: RATIO = &quot;</span>) &lt;&lt; normal_lm_ratio &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.RATIO = &quot;</span>) &lt;&lt; mLMNormalRatioTolerance &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; ABS = &quot;</span>) &lt;&lt; normal_lm_abs &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.ABS = &quot;</span>) &lt;&lt; mLMNormalAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>, mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP)) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; STICK LAGRANGE MUL:\tRATIO = &quot;</span>) &lt;&lt; tangent_lm_stick_ratio &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.RATIO = &quot;</span>) &lt;&lt; mLMTangentStickRatioTolerance &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; ABS = &quot;</span>) &lt;&lt; tangent_lm_stick_abs &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.ABS = &quot;</span>) &lt;&lt; mLMTangentStickAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; SLIP LAGRANGE MUL:\tRATIO = &quot;</span>) &lt;&lt; tangent_lm_slip_ratio &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.RATIO = &quot;</span>) &lt;&lt; mLMTangentSlipRatioTolerance &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; ABS = &quot;</span>) &lt;&lt; tangent_lm_slip_abs &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot; EXP.ABS = &quot;</span>) &lt;&lt; mLMTangentSlipAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;MIXED CONVERGENCE CHECK&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\tSTEP: &quot;</span> &lt;&lt; r_process_info[STEP] &lt;&lt; <span class="stringliteral">&quot;\tNL ITERATION: &quot;</span> &lt;&lt; r_process_info[NL_ITERATION_NUMBER] &lt;&lt; std::endl &lt;&lt; std::scientific;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\tDISPLACEMENT: RATIO = &quot;</span> &lt;&lt; residual_disp_ratio &lt;&lt; <span class="stringliteral">&quot; EXP.RATIO = &quot;</span> &lt;&lt; mDispRatioTolerance &lt;&lt; <span class="stringliteral">&quot; ABS = &quot;</span> &lt;&lt; residual_disp_abs &lt;&lt; <span class="stringliteral">&quot; EXP.ABS = &quot;</span> &lt;&lt; mDispAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                            <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\tROTATION: RATIO = &quot;</span> &lt;&lt; residual_rot_ratio &lt;&lt; <span class="stringliteral">&quot; EXP.RATIO = &quot;</span> &lt;&lt; mRotRatioTolerance &lt;&lt; <span class="stringliteral">&quot; ABS = &quot;</span> &lt;&lt; residual_rot_abs &lt;&lt; <span class="stringliteral">&quot; EXP.ABS = &quot;</span> &lt;&lt; mRotAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\tNORMAL LAGRANGE MUL: RATIO = &quot;</span> &lt;&lt; normal_lm_ratio &lt;&lt; <span class="stringliteral">&quot; EXP.RATIO = &quot;</span> &lt;&lt; mLMNormalRatioTolerance &lt;&lt; <span class="stringliteral">&quot; ABS = &quot;</span> &lt;&lt; normal_lm_abs &lt;&lt; <span class="stringliteral">&quot; EXP.ABS = &quot;</span> &lt;&lt; mLMNormalAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>, mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP)) &lt;&lt; <span class="stringliteral">&quot; STICK LAGRANGE MUL:\tRATIO = &quot;</span> &lt;&lt; tangent_lm_stick_ratio &lt;&lt; <span class="stringliteral">&quot; EXP.RATIO = &quot;</span> &lt;&lt; mLMTangentStickRatioTolerance &lt;&lt; <span class="stringliteral">&quot; ABS = &quot;</span> &lt;&lt; tangent_lm_stick_abs &lt;&lt; <span class="stringliteral">&quot; EXP.ABS = &quot;</span> &lt;&lt; mLMTangentStickAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                        <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; SLIP LAGRANGE MUL:\tRATIO = &quot;</span> &lt;&lt; tangent_lm_slip_ratio &lt;&lt; <span class="stringliteral">&quot; EXP.RATIO = &quot;</span> &lt;&lt; mLMTangentSlipRatioTolerance &lt;&lt; <span class="stringliteral">&quot; ABS = &quot;</span> &lt;&lt; tangent_lm_slip_abs &lt;&lt; <span class="stringliteral">&quot; EXP.ABS = &quot;</span> &lt;&lt; mLMTangentSlipAbsTolerance &lt;&lt; std::endl;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="comment">// NOTE: Here we don&#39;t include the tangent counter part</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            r_process_info[CONVERGENCE_RATIO] = (residual_disp_ratio &gt; normal_lm_ratio) ? residual_disp_ratio : normal_lm_ratio;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            r_process_info[RESIDUAL_NORM] = (normal_lm_abs &gt; mLMNormalAbsTolerance) ? normal_lm_abs : mLMNormalAbsTolerance;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment">// We check if converged</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> disp_converged = (residual_disp_ratio &lt;= mDispRatioTolerance || residual_disp_abs &lt;= mDispAbsTolerance);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> rot_converged = (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Is</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) ? (residual_rot_ratio &lt;= mRotRatioTolerance || residual_rot_abs &lt;= mRotAbsTolerance) : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> lm_converged = (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ENSURE_CONTACT) &amp;&amp; normal_lm_solution_norm &lt; <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Tolerance</a>) ? <span class="keyword">true</span> : (normal_lm_ratio &lt;= mLMNormalRatioTolerance || normal_lm_abs &lt;= mLMNormalAbsTolerance) &amp;&amp; (tangent_lm_stick_ratio &lt;= mLMTangentStickRatioTolerance || tangent_lm_stick_abs &lt;= mLMTangentStickAbsTolerance || normal_tangent_stick_ratio &lt;= mNormalTangentRatio) &amp;&amp; (tangent_lm_slip_ratio &lt;= mLMTangentSlipRatioTolerance || tangent_lm_slip_abs &lt;= mLMTangentSlipAbsTolerance || normal_tangent_slip_ratio &lt;= mNormalTangentRatio);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> ( disp_converged &amp;&amp; rot_converged &amp;&amp; lm_converged ) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">if</span> (rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">GetCommunicator</a>().<a class="code" href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">MyPID</a>() == 0 &amp;&amp; this-&gt;<a class="code" href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a3c900ee41bfebf3b56229de2622e8d21">GetEchoLevel</a>() &gt; 0) {</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                    <span class="keywordflow">if</span> (r_process_info.Has(TABLE_UTILITY)) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                        <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">TablePrinterPointerType</a> p_table = r_process_info[TABLE_UTILITY];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        <span class="keyword">auto</span>&amp; r_table = p_table-&gt;GetTable();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                            r_table &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<a class="code" href="../../d7/d28/color__utilities_8h.html#ab3968f7b5009845811dc102a5b53d898">FGRN</a>(<span class="stringliteral">&quot;       Achieved&quot;</span>));</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            r_table &lt;&lt; <span class="stringliteral">&quot;Achieved&quot;</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT))</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                            <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot;\tConvergence&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<a class="code" href="../../d7/d28/color__utilities_8h.html#ab3968f7b5009845811dc102a5b53d898">FGRN</a>(<span class="stringliteral">&quot;achieved&quot;</span>)) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                            <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\tConvergence is achieved&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="keywordflow">if</span> (rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">GetCommunicator</a>().<a class="code" href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">MyPID</a>() == 0 &amp;&amp; this-&gt;GetEchoLevel() &gt; 0) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">if</span> (r_process_info.Has(TABLE_UTILITY)) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                        <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">TablePrinterPointerType</a> p_table = r_process_info[TABLE_UTILITY];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        <span class="keyword">auto</span>&amp; r_table = p_table-&gt;GetTable();</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT))</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                            r_table &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<a class="code" href="../../d7/d28/color__utilities_8h.html#ae5b789f4a8f720ec20a544c58f9c204d">FRED</a>(<span class="stringliteral">&quot;   Not achieved&quot;</span>));</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                            r_table &lt;&lt; <span class="stringliteral">&quot;Not achieved&quot;</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <span class="keywordflow">if</span> (mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">IsNot</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT))</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                            <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<span class="stringliteral">&quot;\tConvergence&quot;</span>) &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; <a class="code" href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a>(<a class="code" href="../../d7/d28/color__utilities_8h.html#ae5b789f4a8f720ec20a544c58f9c204d">FRED</a>(<span class="stringliteral">&quot; not achieved&quot;</span>)) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                            <a class="code" href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a>(<span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\tConvergence is not achieved&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        } <span class="keywordflow">else</span> <span class="comment">// In this case all the displacements are imposed!</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga44ebd77601768a895f8c0e8e2dbf56d8">  461</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga44ebd77601768a895f8c0e8e2dbf56d8">Initialize</a>( <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; rModelPart)<span class="keyword"> override</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">// Initialize</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        BaseType::mConvergenceCriteriaIsInitialized = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="comment">// Check rotation dof</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED, <a class="code" href="../../d0/d37/class_kratos_1_1_contact_utilities.html#a568736a486eb02e57a7b7f4f851757f5">ContactUtilities::CheckModelPartHasRotationDoF</a>(rModelPart));</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">// Initialize header</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a>&amp; r_process_info = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span> (r_process_info.<a class="code" href="../../d7/dfa/class_kratos_1_1_data_value_container.html#a148369099a18911dd949e71efd5b1a2c">Has</a>(TABLE_UTILITY) &amp;&amp; mOptions.IsNot(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TABLE_IS_INITIALIZED)) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">TablePrinterPointerType</a> p_table = r_process_info[TABLE_UTILITY];</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keyword">auto</span>&amp; r_table = p_table-&gt;GetTable();</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;DP RATIO&quot;</span>, 10);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;EXP. RAT&quot;</span>, 10);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;EXP. ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="keywordflow">if</span> (mOptions.Is(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED)) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;RT RATIO&quot;</span>, 10);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;EXP. RAT&quot;</span>, 10);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;EXP. ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;N.LM RATIO&quot;</span>, 10);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;EXP. RAT&quot;</span>, 10);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;EXP. ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">if</span> (mOptions.IsNot(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP)) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;STI. RATIO&quot;</span>, 10);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;EXP. RAT&quot;</span>, 10);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                r_table.AddColumn(<span class="stringliteral">&quot;EXP. ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;SLIP RATIO&quot;</span>, 10);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;EXP. RAT&quot;</span>, 10);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;EXP. ABS&quot;</span>, 10);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            r_table.AddColumn(<span class="stringliteral">&quot;CONVERGENCE&quot;</span>, 15);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            mOptions.<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Set</a>(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TABLE_IS_INITIALIZED, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga61abaac0a7f69bfc8c7c4af5148b3329">  511</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga61abaac0a7f69bfc8c7c4af5148b3329">InitializeSolutionStep</a>(</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad683d84c96d54a9d4cadfbc243038f8a">DofsArrayType</a>&amp; rDofSet,</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga46cf645153253815947def755c7df672">TSystemMatrixType</a>&amp; rA,</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        )<span class="keyword"> override</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="comment">// Initialize flags</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::INITIAL_RESIDUAL_IS_SET, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">// Filling mActiveDofs when MPC exist</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <a class="code" href="../../d3/da5/namespace_kratos_1_1_constraint_utilities.html#a7e8b2fc1d8aa083d85e3e846600bb2af">ConstraintUtilities::ComputeActiveDofs</a>(rModelPart, mActiveDofs, rDofSet);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga78604f8bb6eb7e4929ce960512649c88">  534</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga78604f8bb6eb7e4929ce960512649c88">FinalizeNonLinearIteration</a>(</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; rModelPart,</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad683d84c96d54a9d4cadfbc243038f8a">DofsArrayType</a>&amp; rDofSet,</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga46cf645153253815947def755c7df672">TSystemMatrixType</a>&amp; rA,</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a>&amp; rDx,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">TSystemVectorType</a>&amp; rb</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        )<span class="keyword"> override</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="comment">// Calling base criteria</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        BaseType::FinalizeNonLinearIteration(rModelPart, rDofSet, rA, rDx, rb);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment">// The current process info</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="../../db/deb/class_kratos_1_1_process_info.html">ProcessInfo</a>&amp; r_process_info = rModelPart.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">GetProcessInfo</a>();</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        r_process_info.<a class="code" href="../../d7/dfa/class_kratos_1_1_data_value_container.html#a2302b1c40936f4e65df281aa3e071342">SetValue</a>(ACTIVE_SET_COMPUTED, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabc3fbf9bb998b705fe1446176ae00541">  554</a></span>&#160;    <a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Parameters</a> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabc3fbf9bb998b705fe1446176ae00541">GetDefaultParameters</a>()<span class="keyword"> const override</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Parameters</a> default_parameters = <a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Parameters</a>(R<span class="stringliteral">&quot;(</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="stringliteral">        {</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="stringliteral">            &quot;name&quot;                                                     : &quot;displacement_lagrangemultiplier_mixed_frictional_contact_criteria&quot;,</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="stringliteral">            &quot;ensure_contact&quot;                                           : false,</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="stringliteral">            &quot;pure_slip&quot;                                                : false,</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">            &quot;print_convergence_criterion&quot;                              : false,</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral">            &quot;residual_relative_tolerance&quot;                              : 1.0e-4,</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">            &quot;residual_absolute_tolerance&quot;                              : 1.0e-9,</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">            &quot;rotation_residual_relative_tolerance&quot;                     : 1.0e-4,</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">            &quot;rotation_residual_absolute_tolerance&quot;                     : 1.0e-9,</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">            &quot;contact_displacement_relative_tolerance&quot;                  : 1.0e-4,</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral">            &quot;contact_displacement_absolute_tolerance&quot;                  : 1.0e-9,</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">            &quot;frictional_stick_contact_displacement_relative_tolerance&quot; : 1.0e-4,</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">            &quot;frictional_stick_contact_residual_relative_tolerance&quot;     : 1.0e-9,</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">            &quot;frictional_slip_contact_displacement_relative_tolerance&quot;  : 1.0e-4,</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">            &quot;frictional_slip_contact_residual_relative_tolerance&quot;      : 1.0e-9,</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">            &quot;ratio_normal_tangent_threshold&quot;                           : 1.0e-4</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">        })&quot;);</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">        </span><span class="comment">// Getting base class default parameters</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keyword">const</span> <a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Parameters</a> base_default_parameters = BaseType::GetDefaultParameters();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        default_parameters.<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a8907155f4af29f0126f2d5d935fedfd4">RecursivelyAddMissingParameters</a>(base_default_parameters);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">return</span> default_parameters;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga2741c251bda0b2b99ca81bd75ab6b1f2">  585</a></span>&#160;    <span class="keyword">static</span> std::string <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga2741c251bda0b2b99ca81bd75ab6b1f2">Name</a>()</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;displacement_lagrangemultiplier_mixed_frictional_contact_criteria&quot;</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga6cba9ff4aa43fb00771aa0226b5cd797">  603</a></span>&#160;    std::string <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga6cba9ff4aa43fb00771aa0226b5cd797">Info</a>()<span class="keyword"> const override</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&quot;</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabac7031d9d40e123d786f24cde5d1f0b">  609</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gabac7031d9d40e123d786f24cde5d1f0b">PrintInfo</a>(std::ostream&amp; rOStream)<span class="keyword"> const override</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        rOStream &lt;&lt; Info();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga7cc19417ed52b4d812e3086aa0636ac1">  615</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#ga7cc19417ed52b4d812e3086aa0636ac1">PrintData</a>(std::ostream&amp; rOStream)<span class="keyword"> const override</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        rOStream &lt;&lt; Info();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad2b4f10c2744918e6dd8c5e6c0b0ae2a">  641</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/dff/group___contact_structural_mechanics_application.html#gad2b4f10c2744918e6dd8c5e6c0b0ae2a">AssignSettings</a>(<span class="keyword">const</span> <a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html">Parameters</a> ThisParameters)<span class="keyword"> override</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        BaseType::AssignSettings(ThisParameters);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">// The displacement residual</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        mDispRatioTolerance = ThisParameters[<span class="stringliteral">&quot;residual_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        mDispAbsTolerance = ThisParameters[<span class="stringliteral">&quot;residual_absolute_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="comment">// The rotation residual</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        mRotRatioTolerance = ThisParameters[<span class="stringliteral">&quot;rotation_residual_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        mRotAbsTolerance = ThisParameters[<span class="stringliteral">&quot;rotation_residual_absolute_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="comment">// The normal contact solution</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        mLMNormalRatioTolerance = ThisParameters[<span class="stringliteral">&quot;contact_displacement_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        mLMNormalAbsTolerance = ThisParameters[<span class="stringliteral">&quot;contact_displacement_absolute_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <span class="comment">// The tangent contact solution</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        mLMTangentStickRatioTolerance = ThisParameters[<span class="stringliteral">&quot;frictional_stick_contact_displacement_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        mLMTangentStickAbsTolerance = ThisParameters[<span class="stringliteral">&quot;frictional_stick_contact_residual_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        mLMTangentSlipRatioTolerance = ThisParameters[<span class="stringliteral">&quot;frictional_slip_contact_displacement_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        mLMTangentSlipAbsTolerance = ThisParameters[<span class="stringliteral">&quot;frictional_slip_contact_residual_relative_tolerance&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// We get the  ratio between the normal and tangent that will accepted as converged</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        mNormalTangentRatio = ThisParameters[<span class="stringliteral">&quot;ratio_normal_tangent_threshold&quot;</span>].<a class="code" href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">GetDouble</a>();</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="comment">// Set local flags</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ENSURE_CONTACT, ThisParameters[<span class="stringliteral">&quot;ensure_contact&quot;</span>].GetBool());</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PRINTING_OUTPUT, ThisParameters[<span class="stringliteral">&quot;print_convergence_criterion&quot;</span>].GetBool());</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TABLE_IS_INITIALIZED, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::ROTATION_DOF_IS_CONSIDERED, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PURE_SLIP, ThisParameters[<span class="stringliteral">&quot;pure_slip&quot;</span>].GetBool());</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        mOptions.Set(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::INITIAL_RESIDUAL_IS_SET, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Flags</a> mOptions; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">double</span> mDispRatioTolerance;      </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordtype">double</span> mDispAbsTolerance;        </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">double</span> mDispInitialResidualNorm; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">double</span> mDispCurrentResidualNorm; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordtype">double</span> mRotRatioTolerance;      </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordtype">double</span> mRotAbsTolerance;        </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">double</span> mRotInitialResidualNorm; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordtype">double</span> mRotCurrentResidualNorm; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">double</span> mLMNormalRatioTolerance;  </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordtype">double</span> mLMNormalAbsTolerance;    </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordtype">double</span> mLMTangentStickRatioTolerance; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordtype">double</span> mLMTangentStickAbsTolerance;   </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">double</span> mLMTangentSlipRatioTolerance;  </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">double</span> mLMTangentSlipAbsTolerance;    </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">double</span> mNormalTangentRatio;      </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    std::vector&lt;int&gt; mActiveDofs;       </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;};  <span class="comment">// Kratos DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> TSparseSpace, <span class="keyword">class</span> TDenseSpace&gt;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="keyword">const</span> <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a> DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;::ENSURE_CONTACT(<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a>(0));</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> TSparseSpace, <span class="keyword">class</span> TDenseSpace&gt;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keyword">const</span> <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a> DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;::PRINTING_OUTPUT(<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a>(1));</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> TSparseSpace, <span class="keyword">class</span> TDenseSpace&gt;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keyword">const</span> <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a> DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;::TABLE_IS_INITIALIZED(<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a>(2));</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> TSparseSpace, <span class="keyword">class</span> TDenseSpace&gt;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="keyword">const</span> <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a> DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;::ROTATION_DOF_IS_CONSIDERED(<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a>(3));</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> TSparseSpace, <span class="keyword">class</span> TDenseSpace&gt;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="keyword">const</span> <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a> DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;::PURE_SLIP(<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a>(4));</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> TSparseSpace, <span class="keyword">class</span> TDenseSpace&gt;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="keyword">const</span> <a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a> DisplacementLagrangeMultiplierMixedFrictionalContactCriteria&lt;TSparseSpace, TDenseSpace&gt;::INITIAL_RESIDUAL_IS_SET(<a class="code" href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a>(5));</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;}</div>
<div class="ttc" id="aactive__set__utilities_8h_html"><div class="ttname"><a href="../../dd/d61/active__set__utilities_8h.html">active_set_utilities.h</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_communicator_html_aeac30940c4529aa1f7d2af14a768b62b"><div class="ttname"><a href="../../d3/da4/class_kratos_1_1_communicator.html#aeac30940c4529aa1f7d2af14a768b62b">Kratos::Communicator::MyPID</a></div><div class="ttdeci">virtual int MyPID() const</div><div class="ttdef"><b>Definition:</b> communicator.cpp:91</div></div>
<div class="ttc" id="aclass_kratos_1_1_contact_utilities_html_a568736a486eb02e57a7b7f4f851757f5"><div class="ttname"><a href="../../d0/d37/class_kratos_1_1_contact_utilities.html#a568736a486eb02e57a7b7f4f851757f5">Kratos::ContactUtilities::CheckModelPartHasRotationDoF</a></div><div class="ttdeci">static bool CheckModelPartHasRotationDoF(ModelPart &amp;rModelPart)</div><div class="ttdoc">This method checks that the modelpart has a rotation DoF.</div><div class="ttdef"><b>Definition:</b> contact_utilities.cpp:147</div></div>
<div class="ttc" id="aclass_kratos_1_1_convergence_criteria_html"><div class="ttname"><a href="../../d3/d80/class_kratos_1_1_convergence_criteria.html">Kratos::ConvergenceCriteria</a></div><div class="ttdoc">This is the base class to define the different convergence criterion considered.</div><div class="ttdef"><b>Definition:</b> convergence_criteria.h:58</div></div>
<div class="ttc" id="aclass_kratos_1_1_convergence_criteria_html_a3c900ee41bfebf3b56229de2622e8d21"><div class="ttname"><a href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a3c900ee41bfebf3b56229de2622e8d21">Kratos::ConvergenceCriteria::GetEchoLevel</a></div><div class="ttdeci">int GetEchoLevel()</div><div class="ttdoc">This returns the level of echo for the solving strategy.</div><div class="ttdef"><b>Definition:</b> convergence_criteria.h:209</div></div>
<div class="ttc" id="aclass_kratos_1_1_convergence_criteria_html_a76d595b2d1bfc2fd3c1075cd4c9452ab"><div class="ttname"><a href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a76d595b2d1bfc2fd3c1075cd4c9452ab">Kratos::ConvergenceCriteria::ValidateAndAssignParameters</a></div><div class="ttdeci">virtual Parameters ValidateAndAssignParameters(Parameters ThisParameters, const Parameters DefaultParameters) const</div><div class="ttdoc">This method validate and assign default parameters.</div><div class="ttdef"><b>Definition:</b> convergence_criteria.h:466</div></div>
<div class="ttc" id="aclass_kratos_1_1_convergence_criteria_html_a7b42d9b99bab0e8234d007eeda0e0a69"><div class="ttname"><a href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a7b42d9b99bab0e8234d007eeda0e0a69">Kratos::ConvergenceCriteria::TSystemMatrixType</a></div><div class="ttdeci">TSparseSpace::MatrixType TSystemMatrixType</div><div class="ttdoc">Matrix type definition.</div><div class="ttdef"><b>Definition:</b> convergence_criteria.h:72</div></div>
<div class="ttc" id="aclass_kratos_1_1_convergence_criteria_html_a83c72adb9f59b5f42df937e2ac36b6a6"><div class="ttname"><a href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#a83c72adb9f59b5f42df937e2ac36b6a6">Kratos::ConvergenceCriteria::DofsArrayType</a></div><div class="ttdeci">ModelPart::DofsArrayType DofsArrayType</div><div class="ttdoc">DoF array type definition.</div><div class="ttdef"><b>Definition:</b> convergence_criteria.h:81</div></div>
<div class="ttc" id="aclass_kratos_1_1_convergence_criteria_html_abb4527f26178f7e5824722f27481a92b"><div class="ttname"><a href="../../d3/d80/class_kratos_1_1_convergence_criteria.html#abb4527f26178f7e5824722f27481a92b">Kratos::ConvergenceCriteria::TSystemVectorType</a></div><div class="ttdeci">TSparseSpace::VectorType TSystemVectorType</div><div class="ttdoc">Vector type definition.</div><div class="ttdef"><b>Definition:</b> convergence_criteria.h:74</div></div>
<div class="ttc" id="aclass_kratos_1_1_data_value_container_html_a148369099a18911dd949e71efd5b1a2c"><div class="ttname"><a href="../../d7/dfa/class_kratos_1_1_data_value_container.html#a148369099a18911dd949e71efd5b1a2c">Kratos::DataValueContainer::Has</a></div><div class="ttdeci">bool Has(const Variable&lt; TDataType &gt; &amp;rThisVariable) const</div><div class="ttdoc">Checks if the data container has a value associated with a given variable.</div><div class="ttdef"><b>Definition:</b> data_value_container.h:382</div></div>
<div class="ttc" id="aclass_kratos_1_1_data_value_container_html_a2302b1c40936f4e65df281aa3e071342"><div class="ttname"><a href="../../d7/dfa/class_kratos_1_1_data_value_container.html#a2302b1c40936f4e65df281aa3e071342">Kratos::DataValueContainer::SetValue</a></div><div class="ttdeci">void SetValue(const Variable&lt; TDataType &gt; &amp;rThisVariable, TDataType const &amp;rValue)</div><div class="ttdoc">Sets the value for a given variable.</div><div class="ttdef"><b>Definition:</b> data_value_container.h:320</div></div>
<div class="ttc" id="aclass_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria_html"><div class="ttname"><a href="../../d3/d27/class_kratos_1_1_displacement_lagrange_multiplier_mixed_frictional_contact_criteria.html">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div><div class="ttdoc">Convergence criteria for contact problems.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:63</div></div>
<div class="ttc" id="aclass_kratos_1_1_dof_html"><div class="ttname"><a href="../../dc/d58/class_kratos_1_1_dof.html">Kratos::Dof</a></div><div class="ttdoc">Dof represents a degree of freedom (DoF).</div><div class="ttdef"><b>Definition:</b> dof.h:86</div></div>
<div class="ttc" id="aclass_kratos_1_1_dof_html_ad16ba5c333c5d7320c3805d83bbe325e"><div class="ttname"><a href="../../dc/d58/class_kratos_1_1_dof.html#ad16ba5c333c5d7320c3805d83bbe325e">Kratos::Dof::EquationId</a></div><div class="ttdeci">EquationIdType EquationId() const</div><div class="ttdef"><b>Definition:</b> dof.h:324</div></div>
<div class="ttc" id="aclass_kratos_1_1_flags_html"><div class="ttname"><a href="../../d9/d4f/class_kratos_1_1_flags.html">Kratos::Flags</a></div><div class="ttdoc">Forward declaration.</div><div class="ttdef"><b>Definition:</b> flags.h:56</div></div>
<div class="ttc" id="aclass_kratos_1_1_flags_html_a22d96716e21630671ec5d301aef9ee1c"><div class="ttname"><a href="../../d9/d4f/class_kratos_1_1_flags.html#a22d96716e21630671ec5d301aef9ee1c">Kratos::Flags::Set</a></div><div class="ttdeci">void Set(const Flags ThisFlag)</div><div class="ttdoc">Set the specified flag.</div><div class="ttdef"><b>Definition:</b> flags.cpp:33</div></div>
<div class="ttc" id="aclass_kratos_1_1_flags_html_a4f077303c44ee715718ed045077514ea"><div class="ttname"><a href="../../d9/d4f/class_kratos_1_1_flags.html#a4f077303c44ee715718ed045077514ea">Kratos::Flags::Is</a></div><div class="ttdeci">bool Is(Flags const &amp;rOther) const</div><div class="ttdoc">Checks if the flags in this object match those in the given Flags object.</div><div class="ttdef"><b>Definition:</b> flags.h:318</div></div>
<div class="ttc" id="aclass_kratos_1_1_flags_html_a7e633a5159d1e064fb875282bef94ad0"><div class="ttname"><a href="../../d9/d4f/class_kratos_1_1_flags.html#a7e633a5159d1e064fb875282bef94ad0">Kratos::Flags::Create</a></div><div class="ttdeci">static Flags Create(IndexType ThisPosition, bool Value=true)</div><div class="ttdef"><b>Definition:</b> flags.h:127</div></div>
<div class="ttc" id="aclass_kratos_1_1_flags_html_abf73692c98d6f843fd74b7319e4f2ece"><div class="ttname"><a href="../../d9/d4f/class_kratos_1_1_flags.html#abf73692c98d6f843fd74b7319e4f2ece">Kratos::Flags::IsNot</a></div><div class="ttdeci">bool IsNot(Flags const &amp;rOther) const</div><div class="ttdoc">Checks if the flags in this object do not match those in the given Flags object.</div><div class="ttdef"><b>Definition:</b> flags.h:338</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html">Kratos::ModelPart</a></div><div class="ttdoc">This class aims to manage meshes for multi-physics simulations.</div><div class="ttdef"><b>Definition:</b> model_part.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a3be3b39e5cd9032763c2b3fd0d28dc7f"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a3be3b39e5cd9032763c2b3fd0d28dc7f">Kratos::ModelPart::GetCommunicator</a></div><div class="ttdeci">Communicator &amp; GetCommunicator()</div><div class="ttdef"><b>Definition:</b> model_part.h:1826</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a78674e1f2609ef421e202c8b206b59ae"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a78674e1f2609ef421e202c8b206b59ae">Kratos::ModelPart::GetProcessInfo</a></div><div class="ttdeci">ProcessInfo &amp; GetProcessInfo()</div><div class="ttdef"><b>Definition:</b> model_part.h:1751</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aeeaebc841dc1351f20b650c6497d6323"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Kratos::ModelPart::Nodes</a></div><div class="ttdeci">NodesContainerType &amp; Nodes(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:507</div></div>
<div class="ttc" id="aclass_kratos_1_1_parameters_html"><div class="ttname"><a href="../../dd/da0/class_kratos_1_1_parameters.html">Kratos::Parameters</a></div><div class="ttdoc">This class provides to Kratos a data structure for I/O based on the standard of JSON.</div><div class="ttdef"><b>Definition:</b> kratos_parameters.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_parameters_html_a38b5b96efd2433233e215fd6e6a1e189"><div class="ttname"><a href="../../dd/da0/class_kratos_1_1_parameters.html#a38b5b96efd2433233e215fd6e6a1e189">Kratos::Parameters::GetDouble</a></div><div class="ttdeci">double GetDouble() const</div><div class="ttdoc">This method returns the double contained in the current Parameter.</div><div class="ttdef"><b>Definition:</b> kratos_parameters.cpp:657</div></div>
<div class="ttc" id="aclass_kratos_1_1_parameters_html_a8907155f4af29f0126f2d5d935fedfd4"><div class="ttname"><a href="../../dd/da0/class_kratos_1_1_parameters.html#a8907155f4af29f0126f2d5d935fedfd4">Kratos::Parameters::RecursivelyAddMissingParameters</a></div><div class="ttdeci">void RecursivelyAddMissingParameters(const Parameters &amp;rDefaultParameters)</div><div class="ttdoc">This function is designed to verify that the parameters under testing contain at least all parameters...</div><div class="ttdef"><b>Definition:</b> kratos_parameters.cpp:1457</div></div>
<div class="ttc" id="aclass_kratos_1_1_process_info_html"><div class="ttname"><a href="../../db/deb/class_kratos_1_1_process_info.html">Kratos::ProcessInfo</a></div><div class="ttdoc">ProcessInfo holds the current value of different solution parameters.</div><div class="ttdef"><b>Definition:</b> process_info.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_sum_reduction_html"><div class="ttname"><a href="../../df/dfe/class_kratos_1_1_sum_reduction.html">Kratos::SumReduction</a></div><div class="ttdoc">utility function to do a sum reduction</div><div class="ttdef"><b>Definition:</b> reduction_utilities.h:68</div></div>
<div class="ttc" id="aclass_kratos_1_1_ublas_space_html_aceeb8477b38225ca40028dc9149f85d9"><div class="ttname"><a href="../../d4/d69/class_kratos_1_1_ublas_space.html#aceeb8477b38225ca40028dc9149f85d9">Kratos::UblasSpace::Size</a></div><div class="ttdeci">static IndexType Size(VectorType const &amp;rV)</div><div class="ttdoc">return size of vector rV</div><div class="ttdef"><b>Definition:</b> ublas_space.h:190</div></div>
<div class="ttc" id="aclass_kratos_1_1_variable_data_html"><div class="ttname"><a href="../../d9/dfe/class_kratos_1_1_variable_data.html">Kratos::VariableData</a></div><div class="ttdoc">This class is the base of variables and variable's components which contains their common data.</div><div class="ttdef"><b>Definition:</b> variable_data.h:49</div></div>
<div class="ttc" id="acolor__utilities_8h_html"><div class="ttname"><a href="../../d7/d28/color__utilities_8h.html">color_utilities.h</a></div></div>
<div class="ttc" id="acolor__utilities_8h_html_ab3968f7b5009845811dc102a5b53d898"><div class="ttname"><a href="../../d7/d28/color__utilities_8h.html#ab3968f7b5009845811dc102a5b53d898">FGRN</a></div><div class="ttdeci">#define FGRN(x)</div><div class="ttdef"><b>Definition:</b> color_utilities.h:27</div></div>
<div class="ttc" id="acolor__utilities_8h_html_ae5b789f4a8f720ec20a544c58f9c204d"><div class="ttname"><a href="../../d7/d28/color__utilities_8h.html#ae5b789f4a8f720ec20a544c58f9c204d">FRED</a></div><div class="ttdeci">#define FRED(x)</div><div class="ttdef"><b>Definition:</b> color_utilities.h:26</div></div>
<div class="ttc" id="acolor__utilities_8h_html_aee1be25a8a1e0622e1f894d981eb8217"><div class="ttname"><a href="../../d7/d28/color__utilities_8h.html#aee1be25a8a1e0622e1f894d981eb8217">BOLDFONT</a></div><div class="ttdeci">#define BOLDFONT(x)</div><div class="ttdef"><b>Definition:</b> color_utilities.h:34</div></div>
<div class="ttc" id="aconstraint__utilities_8h_html"><div class="ttname"><a href="../../d8/dea/constraint__utilities_8h.html">constraint_utilities.h</a></div></div>
<div class="ttc" id="acontact__utilities_8h_html"><div class="ttname"><a href="../../d9/deb/contact__utilities_8h.html">contact_utilities.h</a></div></div>
<div class="ttc" id="aconvergence__criteria_8h_html"><div class="ttname"><a href="../../d0/d09/convergence__criteria_8h.html">convergence_criteria.h</a></div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga0594edd2dd880b4b0361a8e35d4196cf"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga0594edd2dd880b4b0361a8e35d4196cf">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div><div class="ttdeci">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria(Kratos::Parameters ThisParameters)</div><div class="ttdoc">Default constructor. (with parameters)</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:123</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga0661bd6a7a634e64f4eadb60cc08d48f"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga0661bd6a7a634e64f4eadb60cc08d48f">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::SparseSpaceType</a></div><div class="ttdeci">TSparseSpace SparseSpaceType</div><div class="ttdoc">The sparse space used.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:96</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga17ff3861409215b45ff2b8ec1e5da257"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga17ff3861409215b45ff2b8ec1e5da257">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::Tolerance</a></div><div class="ttdeci">static constexpr double Tolerance</div><div class="ttdoc">The epsilon tolerance definition.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:105</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga213b865f2c14cfa102fd40484e45393b"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga213b865f2c14cfa102fd40484e45393b">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::Create</a></div><div class="ttdeci">BaseType::Pointer Create(Parameters ThisParameters) const override</div><div class="ttdoc">Create method.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:229</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga2741c251bda0b2b99ca81bd75ab6b1f2"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga2741c251bda0b2b99ca81bd75ab6b1f2">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::Name</a></div><div class="ttdeci">static std::string Name()</div><div class="ttdoc">Returns the name of the class as used in the settings (snake_case format)</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:585</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga2f08d47eedc22d06735791ef9e6065d4"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga2f08d47eedc22d06735791ef9e6065d4">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_DEFINE_LOCAL_FLAG</a></div><div class="ttdeci">KRATOS_DEFINE_LOCAL_FLAG(ENSURE_CONTACT)</div><div class="ttdoc">Local Flags.</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga3aded5dada01154cb3c4e821cb138a71"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga3aded5dada01154cb3c4e821cb138a71">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div><div class="ttdeci">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria(const double DispRatioTolerance, const double DispAbsTolerance, const double RotRatioTolerance, const double RotAbsTolerance, const double LMNormalRatioTolerance, const double LMNormalAbsTolerance, const double LMTangentStickRatioTolerance, const double LMTangentStickAbsTolerance, const double LMTangentSlipRatioTolerance, const double LMTangentSlipAbsTolerance, const double NormalTangentRatio, const bool EnsureContact=false, const bool PureSlip=false, const bool PrintingOutput=false)</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:144</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga3f9d9f304249ce9885f481af54200e92"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga3f9d9f304249ce9885f481af54200e92">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div><div class="ttdeci">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria()</div><div class="ttdoc">Default constructor.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:114</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga44ebd77601768a895f8c0e8e2dbf56d8"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga44ebd77601768a895f8c0e8e2dbf56d8">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::Initialize</a></div><div class="ttdeci">void Initialize(ModelPart &amp;rModelPart) override</div><div class="ttdoc">This function initialize the convergence criteria.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:461</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga46cf645153253815947def755c7df672"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga46cf645153253815947def755c7df672">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TSystemMatrixType</a></div><div class="ttdeci">typename BaseType::TSystemMatrixType TSystemMatrixType</div><div class="ttdoc">The sparse matrix type.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:90</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga5774a8b4049b41c3ba9b0638bbf539ce"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga5774a8b4049b41c3ba9b0638bbf539ce">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PostCriteria</a></div><div class="ttdeci">bool PostCriteria(ModelPart &amp;rModelPart, DofsArrayType &amp;rDofSet, const TSystemMatrixType &amp;rA, const TSystemVectorType &amp;rDx, const TSystemVectorType &amp;rb) override</div><div class="ttdoc">Compute relative and absolute error.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:243</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga61abaac0a7f69bfc8c7c4af5148b3329"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga61abaac0a7f69bfc8c7c4af5148b3329">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::InitializeSolutionStep</a></div><div class="ttdeci">void InitializeSolutionStep(ModelPart &amp;rModelPart, DofsArrayType &amp;rDofSet, const TSystemMatrixType &amp;rA, const TSystemVectorType &amp;rDx, const TSystemVectorType &amp;rb) override</div><div class="ttdoc">This function initializes the solution step.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:511</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga653de6224f72eb7f3c5e9eb756a0addc"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga653de6224f72eb7f3c5e9eb756a0addc">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_DEFINE_LOCAL_FLAG</a></div><div class="ttdeci">KRATOS_DEFINE_LOCAL_FLAG(PRINTING_OUTPUT)</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga684b187e729ec1069be707e84c0affd9"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga684b187e729ec1069be707e84c0affd9">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_DEFINE_LOCAL_FLAG</a></div><div class="ttdeci">KRATOS_DEFINE_LOCAL_FLAG(TABLE_IS_INITIALIZED)</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga6cba9ff4aa43fb00771aa0226b5cd797"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga6cba9ff4aa43fb00771aa0226b5cd797">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::Info</a></div><div class="ttdeci">std::string Info() const override</div><div class="ttdoc">Turn back information as a string.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:603</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga78604f8bb6eb7e4929ce960512649c88"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga78604f8bb6eb7e4929ce960512649c88">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::FinalizeNonLinearIteration</a></div><div class="ttdeci">void FinalizeNonLinearIteration(ModelPart &amp;rModelPart, DofsArrayType &amp;rDofSet, const TSystemMatrixType &amp;rA, const TSystemVectorType &amp;rDx, const TSystemVectorType &amp;rb) override</div><div class="ttdoc">This function finalizes the non-linear iteration.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:534</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga7cc19417ed52b4d812e3086aa0636ac1"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga7cc19417ed52b4d812e3086aa0636ac1">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PrintData</a></div><div class="ttdeci">void PrintData(std::ostream &amp;rOStream) const override</div><div class="ttdoc">Print object's data.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:615</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga919118a6a6bf9adeeb88ec44a7e2154b"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga919118a6a6bf9adeeb88ec44a7e2154b">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TablePrinterPointerType</a></div><div class="ttdeci">TableStreamUtility::Pointer TablePrinterPointerType</div><div class="ttdoc">The table stream definition TODO: Replace by logger.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:99</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_ga9301bdade0b7cba8ee11745a32968799"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#ga9301bdade0b7cba8ee11745a32968799">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::TSystemVectorType</a></div><div class="ttdeci">typename BaseType::TSystemVectorType TSystemVectorType</div><div class="ttdoc">The dense vector type.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:93</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gaa9ca8be7c58c5ad19d85f086e85d778f"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gaa9ca8be7c58c5ad19d85f086e85d778f">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_DEFINE_LOCAL_FLAG</a></div><div class="ttdeci">KRATOS_DEFINE_LOCAL_FLAG(INITIAL_RESIDUAL_IS_SET)</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gab7412a2c83fcd79a973e918558b2eadb"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gab7412a2c83fcd79a973e918558b2eadb">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_DEFINE_LOCAL_FLAG</a></div><div class="ttdeci">KRATOS_DEFINE_LOCAL_FLAG(ROTATION_DOF_IS_CONSIDERED)</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gabac7031d9d40e123d786f24cde5d1f0b"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gabac7031d9d40e123d786f24cde5d1f0b">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::PrintInfo</a></div><div class="ttdeci">void PrintInfo(std::ostream &amp;rOStream) const override</div><div class="ttdoc">Print information about this object.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:609</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gabc3fbf9bb998b705fe1446176ae00541"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gabc3fbf9bb998b705fe1446176ae00541">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::GetDefaultParameters</a></div><div class="ttdeci">Parameters GetDefaultParameters() const override</div><div class="ttdoc">This method provides the defaults parameters to avoid conflicts between the different constructors.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:554</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gabd945ad450389d94bddbc585d056c6cf"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gabd945ad450389d94bddbc585d056c6cf">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_CLASS_POINTER_DEFINITION</a></div><div class="ttdeci">KRATOS_CLASS_POINTER_DEFINITION(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria)</div><div class="ttdoc">Pointer definition of DisplacementLagrangeMultiplierMixedFrictionalContactCriteria.</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gac6cee4de634829daa1db7d91f4b3592f"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gac6cee4de634829daa1db7d91f4b3592f">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::IndexType</a></div><div class="ttdeci">std::size_t IndexType</div><div class="ttdoc">The index type definition.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:102</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gad0a25c830c1204f263dba01a006b8553"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gad0a25c830c1204f263dba01a006b8553">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div><div class="ttdeci">DisplacementLagrangeMultiplierMixedFrictionalContactCriteria(DisplacementLagrangeMultiplierMixedFrictionalContactCriteria const &amp;rOther)</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:193</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gad0b6c57e34829fa0ec8e1202fbc0110f"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gad0b6c57e34829fa0ec8e1202fbc0110f">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::~DisplacementLagrangeMultiplierMixedFrictionalContactCriteria</a></div><div class="ttdeci">~DisplacementLagrangeMultiplierMixedFrictionalContactCriteria() override=default</div><div class="ttdoc">Destructor.</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gad2b4f10c2744918e6dd8c5e6c0b0ae2a"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gad2b4f10c2744918e6dd8c5e6c0b0ae2a">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::AssignSettings</a></div><div class="ttdeci">void AssignSettings(const Parameters ThisParameters) override</div><div class="ttdoc">This method assigns settings to member variables.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:641</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gad683d84c96d54a9d4cadfbc243038f8a"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gad683d84c96d54a9d4cadfbc243038f8a">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::DofsArrayType</a></div><div class="ttdeci">typename BaseType::DofsArrayType DofsArrayType</div><div class="ttdoc">The dofs array type.</div><div class="ttdef"><b>Definition:</b> displacement_lagrangemultiplier_mixed_frictional_contact_criteria.h:87</div></div>
<div class="ttc" id="agroup___contact_structural_mechanics_application_html_gae82075087fd73ead10dffdd59439b6ea"><div class="ttname"><a href="../../d5/dff/group___contact_structural_mechanics_application.html#gae82075087fd73ead10dffdd59439b6ea">Kratos::DisplacementLagrangeMultiplierMixedFrictionalContactCriteria::KRATOS_DEFINE_LOCAL_FLAG</a></div><div class="ttdeci">KRATOS_DEFINE_LOCAL_FLAG(PURE_SLIP)</div></div>
<div class="ttc" id="agroup___kratos_core_html_ga9fdd4e0364598f28a529107663707cf3"><div class="ttname"><a href="../../d5/d4d/group___kratos_core.html#ga9fdd4e0364598f28a529107663707cf3">KRATOS_ERROR_IF</a></div><div class="ttdeci">#define KRATOS_ERROR_IF(conditional)</div><div class="ttdef"><b>Definition:</b> exception.h:162</div></div>
<div class="ttc" id="agroup___kratos_html_ga1aa4c61e78fd7fa7e4972ed28500bd6d"><div class="ttname"><a href="../../df/da3/group___kratos.html#ga1aa4c61e78fd7fa7e4972ed28500bd6d">KRATOS_INFO</a></div><div class="ttdeci">#define KRATOS_INFO(label)</div><div class="ttdef"><b>Definition:</b> logger.h:250</div></div>
<div class="ttc" id="agroup___kratos_html_ga77c49181bec73a59e8ad275f8a56cdd0"><div class="ttname"><a href="../../df/da3/group___kratos.html#ga77c49181bec73a59e8ad275f8a56cdd0">KRATOS_INFO_IF</a></div><div class="ttdeci">#define KRATOS_INFO_IF(label, conditional)</div><div class="ttdef"><b>Definition:</b> logger.h:251</div></div>
<div class="ttc" id="anamespace_kratos_1_1_constraint_utilities_html_a7e8b2fc1d8aa083d85e3e846600bb2af"><div class="ttname"><a href="../../d3/da5/namespace_kratos_1_1_constraint_utilities.html#a7e8b2fc1d8aa083d85e3e846600bb2af">Kratos::ConstraintUtilities::ComputeActiveDofs</a></div><div class="ttdeci">void ComputeActiveDofs(ModelPart &amp;rModelPart, std::vector&lt; int &gt; &amp;rActiveDofs, const ModelPart::DofsArrayType &amp;rDofSet)</div><div class="ttdoc">This method computes the active dofs.</div><div class="ttdef"><b>Definition:</b> constraint_utilities.cpp:26</div></div>
<div class="ttc" id="anamespace_kratos_html"><div class="ttname"><a href="../../db/d66/namespace_kratos.html">Kratos</a></div><div class="ttdoc">REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.</div><div class="ttdef"><b>Definition:</b> mesh_condition.cpp:21</div></div>
<div class="ttc" id="anamespace_kratos_html_a14b9d687ed53c882489400b57cdf34cd"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">Kratos::bool</a></div><div class="ttdeci">REACTION_CHECK_STIFFNESS_FACTOR INNER_LOOP_ITERATION DISTANCE_THRESHOLD ACTIVE_CHECK_FACTOR AUXILIAR_COORDINATES NORMAL_GAP WEIGHTED_GAP WEIGHTED_SCALAR_RESIDUAL bool</div><div class="ttdef"><b>Definition:</b> contact_structural_mechanics_application_variables.h:93</div></div>
<div class="ttc" id="astruct_kratos_1_1_combined_reduction_html"><div class="ttname"><a href="../../d7/d46/struct_kratos_1_1_combined_reduction.html">Kratos::CombinedReduction</a></div><div class="ttdef"><b>Definition:</b> reduction_utilities.h:345</div></div>
<div class="ttc" id="atable__stream__utility_8h_html"><div class="ttname"><a href="../../d0/d9c/table__stream__utility_8h.html">table_stream_utility.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Nov 18 2024 02:42:32 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
