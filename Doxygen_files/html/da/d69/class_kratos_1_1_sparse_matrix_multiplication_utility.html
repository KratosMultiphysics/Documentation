<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: Kratos::SparseMatrixMultiplicationUtility Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../db/d66/namespace_kratos.html">Kratos</a></li><li class="navelem"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html">SparseMatrixMultiplicationUtility</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="../../d9/d79/class_kratos_1_1_sparse_matrix_multiplication_utility-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Kratos::SparseMatrixMultiplicationUtility Class Reference<div class="ingroups"><a class="el" href="../../d5/d4d/group___kratos_core.html">Kratos Core</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>An utility to multiply sparse matrix in Ublas.  
 <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d5/d4e/sparse__matrix__multiplication__utility_8h_source.html">sparse_matrix_multiplication_utility.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Kratos::SparseMatrixMultiplicationUtility:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="../../df/d1d/class_kratos_1_1_sparse_matrix_multiplication_utility__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Life Cycle</div></td></tr>
<tr class="memitem:ae4d9070cf4baf59f63eaee9fe2f2e24a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae4d9070cf4baf59f63eaee9fe2f2e24a">SparseMatrixMultiplicationUtility</a> ()=delete</td></tr>
<tr class="memdesc:ae4d9070cf4baf59f63eaee9fe2f2e24a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae4d9070cf4baf59f63eaee9fe2f2e24a">More...</a><br /></td></tr>
<tr class="separator:ae4d9070cf4baf59f63eaee9fe2f2e24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a165a3e25a9afd13230551b1d5af34114"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a165a3e25a9afd13230551b1d5af34114">~SparseMatrixMultiplicationUtility</a> ()=default</td></tr>
<tr class="memdesc:a165a3e25a9afd13230551b1d5af34114"><td class="mdescLeft">&#160;</td><td class="mdescRight">Desctructor.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a165a3e25a9afd13230551b1d5af34114">More...</a><br /></td></tr>
<tr class="separator:a165a3e25a9afd13230551b1d5af34114"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Input and output</div></td></tr>
<tr class="memitem:acb9963c434a4a5cea59b407afcef374f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#acb9963c434a4a5cea59b407afcef374f">Info</a> () const</td></tr>
<tr class="memdesc:acb9963c434a4a5cea59b407afcef374f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn back information as a string.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#acb9963c434a4a5cea59b407afcef374f">More...</a><br /></td></tr>
<tr class="separator:acb9963c434a4a5cea59b407afcef374f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c5e4d9d4b249e344572ca99434327a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a5c5e4d9d4b249e344572ca99434327a7">PrintInfo</a> (std::ostream &amp;rOStream) const</td></tr>
<tr class="memdesc:a5c5e4d9d4b249e344572ca99434327a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print information about this object.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a5c5e4d9d4b249e344572ca99434327a7">More...</a><br /></td></tr>
<tr class="separator:a5c5e4d9d4b249e344572ca99434327a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b015276a33c92f653d579ef9ee6869"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ab0b015276a33c92f653d579ef9ee6869">PrintData</a> (std::ostream &amp;rOStream) const</td></tr>
<tr class="memdesc:ab0b015276a33c92f653d579ef9ee6869"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print object's data.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ab0b015276a33c92f653d579ef9ee6869">More...</a><br /></td></tr>
<tr class="separator:ab0b015276a33c92f653d579ef9ee6869"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Operations</div></td></tr>
<tr class="memitem:ad20f647f5fd3142300bcc1145c25fb01"><td class="memTemplParams" colspan="2">template&lt;class AMatrix , class BMatrix , class CMatrix &gt; </td></tr>
<tr class="memitem:ad20f647f5fd3142300bcc1145c25fb01"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad20f647f5fd3142300bcc1145c25fb01">MatrixMultiplication</a> (const AMatrix &amp;rA, const BMatrix &amp;rB, CMatrix &amp;rC)</td></tr>
<tr class="memdesc:ad20f647f5fd3142300bcc1145c25fb01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrix-matrix product C = A·B @detail This method uses a template for each matrix.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad20f647f5fd3142300bcc1145c25fb01">More...</a><br /></td></tr>
<tr class="separator:ad20f647f5fd3142300bcc1145c25fb01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e064492cacef4d1a4d2779a759673d"><td class="memTemplParams" colspan="2">template&lt;class AMatrix , class BMatrix , class CMatrix &gt; </td></tr>
<tr class="memitem:a74e064492cacef4d1a4d2779a759673d"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a74e064492cacef4d1a4d2779a759673d">MatrixMultiplicationSaad</a> (const AMatrix &amp;A, const BMatrix &amp;B, CMatrix &amp;C)</td></tr>
<tr class="memdesc:a74e064492cacef4d1a4d2779a759673d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The first is an OpenMP-enabled modification of classic algorithm from Saad.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a74e064492cacef4d1a4d2779a759673d">More...</a><br /></td></tr>
<tr class="separator:a74e064492cacef4d1a4d2779a759673d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac74203f8d17ccb7150d6ff086a4456f"><td class="memTemplParams" colspan="2">template&lt;class AMatrix , class BMatrix , class CMatrix &gt; </td></tr>
<tr class="memitem:aac74203f8d17ccb7150d6ff086a4456f"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#aac74203f8d17ccb7150d6ff086a4456f">MatrixMultiplicationRMerge</a> (const AMatrix &amp;A, const BMatrix &amp;B, CMatrix &amp;C)</td></tr>
<tr class="memdesc:aac74203f8d17ccb7150d6ff086a4456f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Row-merge algorithm from Rupp et al.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#aac74203f8d17ccb7150d6ff086a4456f">More...</a><br /></td></tr>
<tr class="separator:aac74203f8d17ccb7150d6ff086a4456f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f210963455f00394f168280b8054317"><td class="memTemplParams" colspan="2">template&lt;class AMatrix , class BMatrix &gt; </td></tr>
<tr class="memitem:a0f210963455f00394f168280b8054317"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a0f210963455f00394f168280b8054317">MatrixAdd</a> (AMatrix &amp;A, const BMatrix &amp;B, const <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> Factor=1.0)</td></tr>
<tr class="memdesc:a0f210963455f00394f168280b8054317"><td class="mdescLeft">&#160;</td><td class="mdescRight">The first is a method in order to sum to sparse matrices in a efficient way.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a0f210963455f00394f168280b8054317">More...</a><br /></td></tr>
<tr class="separator:a0f210963455f00394f168280b8054317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c94326fd67e9b3c52ef5ac0ef54a0c"><td class="memTemplParams" colspan="2">template&lt;class AMatrix , class BMatrix &gt; </td></tr>
<tr class="memitem:a24c94326fd67e9b3c52ef5ac0ef54a0c"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a24c94326fd67e9b3c52ef5ac0ef54a0c">TransposeMatrix</a> (AMatrix &amp;rA, const BMatrix &amp;rB, const <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> Factor=1.0)</td></tr>
<tr class="memdesc:a24c94326fd67e9b3c52ef5ac0ef54a0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method computes of the transpose matrix of a given matrix.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a24c94326fd67e9b3c52ef5ac0ef54a0c">More...</a><br /></td></tr>
<tr class="separator:a24c94326fd67e9b3c52ef5ac0ef54a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10f4ba9f8f7b58ce13e2a72ea54bff3"><td class="memTemplParams" colspan="2">template&lt;class CMatrix , typename TSize , typename Ptr , typename IndexType , typename ValueType &gt; </td></tr>
<tr class="memitem:aa10f4ba9f8f7b58ce13e2a72ea54bff3"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#aa10f4ba9f8f7b58ce13e2a72ea54bff3">CreateSolutionMatrix</a> (CMatrix &amp;C, const TSize NRows, const TSize NCols, const Ptr *CPtr, const <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> *AuxIndex2C, const ValueType *AuxValC)</td></tr>
<tr class="memdesc:aa10f4ba9f8f7b58ce13e2a72ea54bff3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is designed to create the final solution sparse matrix from the auxiliary values.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#aa10f4ba9f8f7b58ce13e2a72ea54bff3">More...</a><br /></td></tr>
<tr class="separator:aa10f4ba9f8f7b58ce13e2a72ea54bff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4899cec4c05220c78dcc8a2f50e01b2"><td class="memTemplParams" colspan="2">template&lt;typename TSize , typename Col , typename TIndexType , typename ValueType &gt; </td></tr>
<tr class="memitem:ad4899cec4c05220c78dcc8a2f50e01b2"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad4899cec4c05220c78dcc8a2f50e01b2">SortRows</a> (const TIndexType *CPtr, const TSize NRows, const TSize NCols, Col *Columns, ValueType *Values)</td></tr>
<tr class="memdesc:ad4899cec4c05220c78dcc8a2f50e01b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is designed to reorder the rows by columns.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ad4899cec4c05220c78dcc8a2f50e01b2">More...</a><br /></td></tr>
<tr class="separator:ad4899cec4c05220c78dcc8a2f50e01b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47c8c4b5e5658f4b1011a98c5fa627ab"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a47c8c4b5e5658f4b1011a98c5fa627ab">AssembleSparseMatrixByBlocks</a> (<a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> &amp;rMatrix, const <a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> * &gt; &amp;rMatricespBlocks, <a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> &gt; ContributionCoefficients=<a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> &gt;(0, 0), <a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">bool</a> &gt; TransposeBlocks=<a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">bool</a> &gt;(0, 0))</td></tr>
<tr class="memdesc:a47c8c4b5e5658f4b1011a98c5fa627ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method assembles several sparse matrices into one large sparse matrix.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a47c8c4b5e5658f4b1011a98c5fa627ab">More...</a><br /></td></tr>
<tr class="separator:a47c8c4b5e5658f4b1011a98c5fa627ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57fe8f33457be60e0998150ec4ab0a66"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a57fe8f33457be60e0998150ec4ab0a66">ComputeNonZeroBlocks</a> (const <a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> &amp;rMatrix, const <a class="el" href="../../db/d66/namespace_kratos.html#ac398e9982e45de7167981e05b7f5ff57">int</a> CurrentRow, <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> &amp;rNonZeroColsAux2)</td></tr>
<tr class="memdesc:a57fe8f33457be60e0998150ec4ab0a66"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a method to check the block containing nonzero values.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a57fe8f33457be60e0998150ec4ab0a66">More...</a><br /></td></tr>
<tr class="separator:a57fe8f33457be60e0998150ec4ab0a66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20902963c01ddf3307aee971a6270261"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a20902963c01ddf3307aee971a6270261">ComputeAuxiliarValuesBlocks</a> (const <a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> &amp;rMatrix, <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> *AuxIndex2, <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> *AuxVals, const <a class="el" href="../../db/d66/namespace_kratos.html#ac398e9982e45de7167981e05b7f5ff57">int</a> CurrentRow, <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> &amp;RowEnd, const <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a054910f95e3bbbc3abb5be18b2c82a13">SizeType</a> InitialIndexColumn, const <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> ContributionCoefficient=1.0)</td></tr>
<tr class="memdesc:a20902963c01ddf3307aee971a6270261"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a method to compute the contribution of the auxiliary blocks.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a20902963c01ddf3307aee971a6270261">More...</a><br /></td></tr>
<tr class="separator:a20902963c01ddf3307aee971a6270261"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">Type Definitions</h2></td></tr>
<tr class="memitem:a054910f95e3bbbc3abb5be18b2c82a13"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a054910f95e3bbbc3abb5be18b2c82a13">SizeType</a> = std::size_t</td></tr>
<tr class="memdesc:a054910f95e3bbbc3abb5be18b2c82a13"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size type.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a054910f95e3bbbc3abb5be18b2c82a13">More...</a><br /></td></tr>
<tr class="separator:a054910f95e3bbbc3abb5be18b2c82a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e0d73ebb8e11c7986dbf2cae8ee6f7a"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> = std::size_t</td></tr>
<tr class="memdesc:a8e0d73ebb8e11c7986dbf2cae8ee6f7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The index type.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">More...</a><br /></td></tr>
<tr class="separator:a8e0d73ebb8e11c7986dbf2cae8ee6f7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae925bb4e832a578c7173eacc8bd64cdf"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae925bb4e832a578c7173eacc8bd64cdf">SignedIndexType</a> = std::ptrdiff_t</td></tr>
<tr class="memdesc:ae925bb4e832a578c7173eacc8bd64cdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The signed index type.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae925bb4e832a578c7173eacc8bd64cdf">More...</a><br /></td></tr>
<tr class="separator:ae925bb4e832a578c7173eacc8bd64cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84976095d1d3b64d2b6f07b321ad631c"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a84976095d1d3b64d2b6f07b321ad631c">IndexVectorType</a> = <a class="el" href="../../db/d66/namespace_kratos.html#ab87bde09a9009899f9d0f20ae674f61a">DenseVector</a>&lt; <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> &gt;</td></tr>
<tr class="memdesc:a84976095d1d3b64d2b6f07b321ad631c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector of indexes.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a84976095d1d3b64d2b6f07b321ad631c">More...</a><br /></td></tr>
<tr class="separator:a84976095d1d3b64d2b6f07b321ad631c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30fb27598ada28fc67b320b984ac6042"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a30fb27598ada28fc67b320b984ac6042">SignedIndexVectorType</a> = <a class="el" href="../../db/d66/namespace_kratos.html#ab87bde09a9009899f9d0f20ae674f61a">DenseVector</a>&lt; <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae925bb4e832a578c7173eacc8bd64cdf">SignedIndexType</a> &gt;</td></tr>
<tr class="memdesc:a30fb27598ada28fc67b320b984ac6042"><td class="mdescLeft">&#160;</td><td class="mdescRight">A vector of indexes (signed)  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a30fb27598ada28fc67b320b984ac6042">More...</a><br /></td></tr>
<tr class="separator:a30fb27598ada28fc67b320b984ac6042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e1b59314b68f0558e0b872323fa2bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#af8e1b59314b68f0558e0b872323fa2bc">KRATOS_CLASS_POINTER_DEFINITION</a> (<a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html">SparseMatrixMultiplicationUtility</a>)</td></tr>
<tr class="memdesc:af8e1b59314b68f0558e0b872323fa2bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer definition of TreeContactSearch.  <a href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#af8e1b59314b68f0558e0b872323fa2bc">More...</a><br /></td></tr>
<tr class="separator:af8e1b59314b68f0558e0b872323fa2bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An utility to multiply sparse matrix in Ublas. </p>
<p>Taken and adapted for ublas from external_libraries/amgcl/detail/spgemm.hpp by Denis Demidov <a href="#" onclick="location.href='mai'+'lto:'+'den'+'ni'+'s.d'+'em'+'ido'+'v@'+'gma'+'il'+'.co'+'m'; return false;">denni<span style="display: none;">.nosp@m.</span>s.de<span style="display: none;">.nosp@m.</span>midov<span style="display: none;">.nosp@m.</span>@gma<span style="display: none;">.nosp@m.</span>il.co<span style="display: none;">.nosp@m.</span>m</a> </p><dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000049">Todo:</a></b></dt><dd>Remove as soon as we do not depend of Ublas anymore... </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Vicente Mataix Ferrandiz </dd></dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a8e0d73ebb8e11c7986dbf2cae8ee6f7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">&#9670;&nbsp;</a></span>IndexType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">Kratos::SparseMatrixMultiplicationUtility::IndexType</a> =  std::size_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The index type. </p>

</div>
</div>
<a id="a84976095d1d3b64d2b6f07b321ad631c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84976095d1d3b64d2b6f07b321ad631c">&#9670;&nbsp;</a></span>IndexVectorType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a84976095d1d3b64d2b6f07b321ad631c">Kratos::SparseMatrixMultiplicationUtility::IndexVectorType</a> =  <a class="el" href="../../db/d66/namespace_kratos.html#ab87bde09a9009899f9d0f20ae674f61a">DenseVector</a>&lt;<a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A vector of indexes. </p>

</div>
</div>
<a id="ae925bb4e832a578c7173eacc8bd64cdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae925bb4e832a578c7173eacc8bd64cdf">&#9670;&nbsp;</a></span>SignedIndexType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae925bb4e832a578c7173eacc8bd64cdf">Kratos::SparseMatrixMultiplicationUtility::SignedIndexType</a> =  std::ptrdiff_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The signed index type. </p>

</div>
</div>
<a id="a30fb27598ada28fc67b320b984ac6042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30fb27598ada28fc67b320b984ac6042">&#9670;&nbsp;</a></span>SignedIndexVectorType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a30fb27598ada28fc67b320b984ac6042">Kratos::SparseMatrixMultiplicationUtility::SignedIndexVectorType</a> =  <a class="el" href="../../db/d66/namespace_kratos.html#ab87bde09a9009899f9d0f20ae674f61a">DenseVector</a>&lt;<a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#ae925bb4e832a578c7173eacc8bd64cdf">SignedIndexType</a>&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A vector of indexes (signed) </p>

</div>
</div>
<a id="a054910f95e3bbbc3abb5be18b2c82a13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a054910f95e3bbbc3abb5be18b2c82a13">&#9670;&nbsp;</a></span>SizeType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a054910f95e3bbbc3abb5be18b2c82a13">Kratos::SparseMatrixMultiplicationUtility::SizeType</a> =  std::size_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The size type. </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ae4d9070cf4baf59f63eaee9fe2f2e24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d9070cf4baf59f63eaee9fe2f2e24a">&#9670;&nbsp;</a></span>SparseMatrixMultiplicationUtility()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Kratos::SparseMatrixMultiplicationUtility::SparseMatrixMultiplicationUtility </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default constructor. </p>

</div>
</div>
<a id="a165a3e25a9afd13230551b1d5af34114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a165a3e25a9afd13230551b1d5af34114">&#9670;&nbsp;</a></span>~SparseMatrixMultiplicationUtility()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Kratos::SparseMatrixMultiplicationUtility::~SparseMatrixMultiplicationUtility </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Desctructor. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a47c8c4b5e5658f4b1011a98c5fa627ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47c8c4b5e5658f4b1011a98c5fa627ab">&#9670;&nbsp;</a></span>AssembleSparseMatrixByBlocks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::AssembleSparseMatrixByBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>rMatricespBlocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> &gt;&#160;</td>
          <td class="paramname"><em>ContributionCoefficients</em> = <code><a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt;<a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a>&gt;(0,0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt; <a class="el" href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">bool</a> &gt;&#160;</td>
          <td class="paramname"><em>TransposeBlocks</em> = <code><a class="el" href="../../db/d66/namespace_kratos.html#a768859835d0ef4d383a277d7fb9b0393">DenseMatrix</a>&lt;<a class="el" href="../../db/d66/namespace_kratos.html#a14b9d687ed53c882489400b57cdf34cd">bool</a>&gt;(0,0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method assembles several sparse matrices into one large sparse matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rMatricespBlocks</td><td>The pointers to the matrices we are interested in assemble </td></tr>
    <tr><td class="paramname">ContributionCoefficients</td><td>The matrix containing the coefficients to be considered (copy, so we don't need to provide it) </td></tr>
    <tr><td class="paramname">TransposeBlocks</td><td>The matrix containing the flags telling us to transpose the blocks (copy, so we don't need to provide it) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a20902963c01ddf3307aee971a6270261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20902963c01ddf3307aee971a6270261">&#9670;&nbsp;</a></span>ComputeAuxiliarValuesBlocks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::ComputeAuxiliarValuesBlocks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> *&#160;</td>
          <td class="paramname"><em>AuxIndex2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a> *&#160;</td>
          <td class="paramname"><em>AuxVals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#ac398e9982e45de7167981e05b7f5ff57">int</a>&#160;</td>
          <td class="paramname"><em>CurrentRow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> &amp;&#160;</td>
          <td class="paramname"><em>RowEnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a054910f95e3bbbc3abb5be18b2c82a13">SizeType</a>&#160;</td>
          <td class="paramname"><em>InitialIndexColumn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a>&#160;</td>
          <td class="paramname"><em>ContributionCoefficient</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a method to compute the contribution of the auxiliary blocks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AuxK</td><td>The auxiliary block </td></tr>
    <tr><td class="paramname">AuxIndex2</td><td>The indexes of the non zero columns </td></tr>
    <tr><td class="paramname">AuxVals</td><td>The values of the final matrix </td></tr>
    <tr><td class="paramname">CurrentRow</td><td>The current row computed </td></tr>
    <tr><td class="paramname">RowEnd</td><td>The last column computed </td></tr>
    <tr><td class="paramname">InitialIndexColumn</td><td>The initial column index of the auxiliary block in the final matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a57fe8f33457be60e0998150ec4ab0a66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57fe8f33457be60e0998150ec4ab0a66">&#9670;&nbsp;</a></span>ComputeNonZeroBlocks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::ComputeNonZeroBlocks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#a329be912c57ade65e8f97efc8bf059e7">CompressedMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>rMatrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#ac398e9982e45de7167981e05b7f5ff57">int</a>&#160;</td>
          <td class="paramname"><em>CurrentRow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> &amp;&#160;</td>
          <td class="paramname"><em>rNonZeroColsAux2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a method to check the block containing nonzero values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rMatrix</td><td>The auxiliary block </td></tr>
    <tr><td class="paramname">CurrentRow</td><td>The current row computed </td></tr>
    <tr><td class="paramname">rNonZeroColsAux2</td><td>The nonzero rows array </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa10f4ba9f8f7b58ce13e2a72ea54bff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10f4ba9f8f7b58ce13e2a72ea54bff3">&#9670;&nbsp;</a></span>CreateSolutionMatrix()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class CMatrix , typename TSize , typename Ptr , typename IndexType , typename ValueType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::CreateSolutionMatrix </td>
          <td>(</td>
          <td class="paramtype">CMatrix &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TSize&#160;</td>
          <td class="paramname"><em>NRows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TSize&#160;</td>
          <td class="paramname"><em>NCols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Ptr *&#160;</td>
          <td class="paramname"><em>CPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html#a8e0d73ebb8e11c7986dbf2cae8ee6f7a">IndexType</a> *&#160;</td>
          <td class="paramname"><em>AuxIndex2C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ValueType *&#160;</td>
          <td class="paramname"><em>AuxValC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is designed to create the final solution sparse matrix from the auxiliary values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">C</td><td>The matrix solution </td></tr>
    <tr><td class="paramname">NRows</td><td>The number of rows of the matrix </td></tr>
    <tr><td class="paramname">NCols</td><td>The number of columns of the matrix </td></tr>
    <tr><td class="paramname">CPtr</td><td>The indexes taht indicate the number of nonzero values in each column </td></tr>
    <tr><td class="paramname">AuxIndex2C</td><td>The indexes of the nonzero columns </td></tr>
    <tr><td class="paramname">AuxValC</td><td>The C array containing the values of the sparse matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acb9963c434a4a5cea59b407afcef374f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb9963c434a4a5cea59b407afcef374f">&#9670;&nbsp;</a></span>Info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Kratos::SparseMatrixMultiplicationUtility::Info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Turn back information as a string. </p>

</div>
</div>
<a id="af8e1b59314b68f0558e0b872323fa2bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8e1b59314b68f0558e0b872323fa2bc">&#9670;&nbsp;</a></span>KRATOS_CLASS_POINTER_DEFINITION()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Kratos::SparseMatrixMultiplicationUtility::KRATOS_CLASS_POINTER_DEFINITION </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d69/class_kratos_1_1_sparse_matrix_multiplication_utility.html">SparseMatrixMultiplicationUtility</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer definition of TreeContactSearch. </p>

</div>
</div>
<a id="a0f210963455f00394f168280b8054317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f210963455f00394f168280b8054317">&#9670;&nbsp;</a></span>MatrixAdd()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AMatrix , class BMatrix &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::MatrixAdd </td>
          <td>(</td>
          <td class="paramtype">AMatrix &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BMatrix &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a>&#160;</td>
          <td class="paramname"><em>Factor</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The first is a method in order to sum to sparse matrices in a efficient way. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>The resulting matrix </td></tr>
    <tr><td class="paramname">B</td><td>The second matrix to sum </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad20f647f5fd3142300bcc1145c25fb01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20f647f5fd3142300bcc1145c25fb01">&#9670;&nbsp;</a></span>MatrixMultiplication()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AMatrix , class BMatrix , class CMatrix &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::MatrixMultiplication </td>
          <td>(</td>
          <td class="paramtype">const AMatrix &amp;&#160;</td>
          <td class="paramname"><em>rA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BMatrix &amp;&#160;</td>
          <td class="paramname"><em>rB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CMatrix &amp;&#160;</td>
          <td class="paramname"><em>rC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Matrix-matrix product C = A·B @detail This method uses a template for each matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rA</td><td>The first matrix </td></tr>
    <tr><td class="paramname">rB</td><td>The second matrix </td></tr>
    <tr><td class="paramname">rC</td><td>The resulting matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aac74203f8d17ccb7150d6ff086a4456f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac74203f8d17ccb7150d6ff086a4456f">&#9670;&nbsp;</a></span>MatrixMultiplicationRMerge()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AMatrix , class BMatrix , class CMatrix &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::MatrixMultiplicationRMerge </td>
          <td>(</td>
          <td class="paramtype">const AMatrix &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BMatrix &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CMatrix &amp;&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Row-merge algorithm from Rupp et al. </p>
<p>The algorithm requires less memory and shows much better scalability than classic one. It is used when number of OpenMP cores is more than 4. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>The first matrix to multiply </td></tr>
    <tr><td class="paramname">B</td><td>The second matrix to multiply </td></tr>
    <tr><td class="paramname">C</td><td>The resulting matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a74e064492cacef4d1a4d2779a759673d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74e064492cacef4d1a4d2779a759673d">&#9670;&nbsp;</a></span>MatrixMultiplicationSaad()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AMatrix , class BMatrix , class CMatrix &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::MatrixMultiplicationSaad </td>
          <td>(</td>
          <td class="paramtype">const AMatrix &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BMatrix &amp;&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CMatrix &amp;&#160;</td>
          <td class="paramname"><em>C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The first is an OpenMP-enabled modification of classic algorithm from Saad. </p>
<p>It is used whenever number of OpenMP cores is 4 or less. Saad, Yousef. Iterative methods for sparse linear systems. Siam, 2003. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>The first matrix to multiply </td></tr>
    <tr><td class="paramname">B</td><td>The second matrix to multiply </td></tr>
    <tr><td class="paramname">C</td><td>The resulting matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab0b015276a33c92f653d579ef9ee6869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b015276a33c92f653d579ef9ee6869">&#9670;&nbsp;</a></span>PrintData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Kratos::SparseMatrixMultiplicationUtility::PrintData </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>rOStream</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print object's data. </p>

</div>
</div>
<a id="a5c5e4d9d4b249e344572ca99434327a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c5e4d9d4b249e344572ca99434327a7">&#9670;&nbsp;</a></span>PrintInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Kratos::SparseMatrixMultiplicationUtility::PrintInfo </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>rOStream</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Print information about this object. </p>

</div>
</div>
<a id="ad4899cec4c05220c78dcc8a2f50e01b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4899cec4c05220c78dcc8a2f50e01b2">&#9670;&nbsp;</a></span>SortRows()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TSize , typename Col , typename TIndexType , typename ValueType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::SortRows </td>
          <td>(</td>
          <td class="paramtype">const TIndexType *&#160;</td>
          <td class="paramname"><em>CPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TSize&#160;</td>
          <td class="paramname"><em>NRows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TSize&#160;</td>
          <td class="paramname"><em>NCols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Col *&#160;</td>
          <td class="paramname"><em>Columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ValueType *&#160;</td>
          <td class="paramname"><em>Values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is designed to reorder the rows by columns. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">NRows</td><td>The number of rows of the matrix </td></tr>
    <tr><td class="paramname">NCols</td><td>The number of columns of the matrix </td></tr>
    <tr><td class="paramname">CPtr</td><td>The indexes that indicate the number of nonzero values in each column </td></tr>
    <tr><td class="paramname">Columns</td><td>The columns of the problem </td></tr>
    <tr><td class="paramname">Values</td><td>The values (to be ordered with the rows) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a24c94326fd67e9b3c52ef5ac0ef54a0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24c94326fd67e9b3c52ef5ac0ef54a0c">&#9670;&nbsp;</a></span>TransposeMatrix()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AMatrix , class BMatrix &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void Kratos::SparseMatrixMultiplicationUtility::TransposeMatrix </td>
          <td>(</td>
          <td class="paramtype">AMatrix &amp;&#160;</td>
          <td class="paramname"><em>rA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BMatrix &amp;&#160;</td>
          <td class="paramname"><em>rB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../db/d66/namespace_kratos.html#ac77084a57869cbecf89d3ee2c819c5d3">double</a>&#160;</td>
          <td class="paramname"><em>Factor</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method computes of the transpose matrix of a given matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rA</td><td>The resulting matrix </td></tr>
    <tr><td class="paramname">rB</td><td>The second matrix to transpose </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/Documentation/Documentation/master/kratos/utilities/<a class="el" href="../../d5/d4e/sparse__matrix__multiplication__utility_8h_source.html">sparse_matrix_multiplication_utility.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 27 2024 03:41:36 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
