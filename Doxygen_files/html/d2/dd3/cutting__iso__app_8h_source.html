<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KratosMultiphysics: /home/runner/work/Documentation/Documentation/master/applications/MeshingApplication/custom_utilities/cutting_iso_app.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../kratos_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KratosMultiphysics
   </div>
   <div id="projectbrief">KRATOS Multiphysics (Kratos) is a framework for building parallel, multi-disciplinary simulation software, aiming at modularity, extensibility, and high performance. Kratos is written in C++, and counts with an extensive Python interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_a6e4fee11f07c3b70486e88fe92cbbdc.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_f9ce0647f038f5bdd0f06592e0001204.html">MeshingApplication</a></li><li class="navelem"><a class="el" href="../../dir_de161d549278e31e8d5a5cab77ebed10.html">custom_utilities</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cutting_iso_app.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d2/dd3/cutting__iso__app_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// KRATOS  __  __ _____ ____  _   _ ___ _   _  ____</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//        |  \/  | ____/ ___|| | | |_ _| \ | |/ ___|</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//        | |\/| |  _| \___ \| |_| || ||  \| | |  _</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//        | |  | | |___ ___) |  _  || || |\  | |_| |</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//        |_|  |_|_____|____/|_| |_|___|_| \_|\____| APPLICATION</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//  License:         BSD License</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//                       license: MeshingApplication/license.txt</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//  Main authors:    jirazabal</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#if !defined(KRATOS_CUTTING_ISOSURFACE_APPLICATION)</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#define  KRATOS_CUTTING_ISOSURFACE_APPLICATION</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// External excludes</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// System includes</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/* Project includes */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d67/define_8h.html">includes/define.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dd/dfe/model__part_8h.html">includes/model_part.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dca/variables_8h.html">includes/variables.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d68/find__nodal__neighbours__process_8h.html">processes/find_nodal_neighbours_process.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d88/math__utils_8h.html">utilities/math_utils.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d0/d9c/split__tetrahedra_8h.html">utilities/split_tetrahedra.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d98/split__triangle_8h.html">utilities/split_triangle.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d60/tetrahedra__3d__4_8h.html">geometries/tetrahedra_3d_4.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d9/def/triangle__3d__3_8h.html">geometries/triangle_3d_3.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/d8f/spatial__containers_8h.html">spatial_containers/spatial_containers.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace </span><a class="code" href="../../db/d66/namespace_kratos.html">Kratos</a></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html">   52</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html">Cutting_Isosurface_Application</a></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">   58</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aaa333c3cf58397b76565318e30248e87">ModelPart::NodesContainerType</a> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">NodesArrayType</a>;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">   59</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a38ea8c8a7a801055130282bb5697a014">ModelPart::ElementsContainerType</a> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2d6c95d1995110ae59c14d7c03d58c51">   60</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a0960956dac2688d5d72cdb874c450e1d">ModelPart::ConditionsContainerType</a> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2d6c95d1995110ae59c14d7c03d58c51">ConditionsArrayType</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#aad62b42f465cb2508901c9d18601d976">   61</a></span>&#160;    <span class="keyword">typedef</span> boost::numeric::ublas::vector&lt;Matrix&gt; <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#aad62b42f465cb2508901c9d18601d976">Matrix_Order_Tensor</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae0d144c2c81c3efd516e9c9afa323008">   62</a></span>&#160;    <span class="keyword">typedef</span> boost::numeric::ublas::vector&lt;Vector&gt; <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae0d144c2c81c3efd516e9c9afa323008">Vector_Order_Tensor</a>;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a7d3251816b1ed3e6b6f93655c410363f">   63</a></span>&#160;    <span class="keyword">typedef</span> boost::numeric::ublas::vector&lt;Vector_Order_Tensor&gt; <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a7d3251816b1ed3e6b6f93655c410363f">Node_Vector_Order_Tensor</a>;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a079b6104f78476d701a12c728f662559">   64</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="../../d5/ddd/class_kratos_1_1_node.html">Node</a> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a079b6104f78476d701a12c728f662559">PointType</a>;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a1c0f3c7413a284869a5c66137d21342c">   65</a></span>&#160;    <span class="keyword">typedef</span> Node ::Pointer <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a1c0f3c7413a284869a5c66137d21342c">PointPointerType</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#abcfba4977af9b9fbab2447acf5f911ca">   66</a></span>&#160;    <span class="keyword">typedef</span> std::vector&lt;PointType::Pointer&gt; <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#abcfba4977af9b9fbab2447acf5f911ca">PointVector</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a71fa8a00fd01dfe2f71525b849956067">   73</a></span>&#160;    <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a71fa8a00fd01dfe2f71525b849956067">Cutting_Isosurface_Application</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#adbc3f6e309548bcb63065b4348b0b5c3">   76</a></span>&#160;    <span class="keyword">virtual</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#adbc3f6e309548bcb63065b4348b0b5c3">~Cutting_Isosurface_Application</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> TDataType&gt;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae8c09487c6548d175c3a53c63024e0e4">   92</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae8c09487c6548d175c3a53c63024e0e4">GenerateVariableCut</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_new_model_part, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable&lt;TDataType&gt;</a>&amp; variable, <span class="keywordtype">double</span> isovalue, <span class="keywordtype">int</span> isosurface_number, <span class="keywordtype">float</span> tolerance)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Generating Isosurface with the following data:&quot;</span>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(variable);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(isovalue);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        boost::numeric::ublas::vector&lt;array_1d&lt;int, 2 &gt; &gt; Position_Node;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        boost::numeric::ublas::vector&lt;int&gt; List_New_Nodes;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        compressed_matrix&lt;int&gt; Coord;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part = mr_model_part;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part = mr_new_model_part;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        vector&lt;double&gt; Value_Nodes(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>().size());                 <span class="comment">//value of the variable in each node</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        vector&lt;int&gt;  Elems_In_Isosurface( this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>().size());          <span class="comment">//our (int) vector, where we write 1 when the element is cut by the isosurface, when it is 2, it means we have 2 triangles (4 cutting points)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">int</span> number_of_triangles = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">//finished creating the variables and vector/matrix needed. now we have to call the subroutines.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a6bb0e71a15665cdbe10f9bc24294278f">CSR_Row_Matrix_Mod</a>(this_model_part, Coord);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a5c32bddb7c13a9c76df9c26722ece2cf">FirstLoop</a>(this_model_part, Coord, variable, isovalue, number_of_triangles, Elems_In_Isosurface, tolerance);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2ca92ded31f362c0a8cfd641d1126b48">Create_List_Of_New_Nodes_Mod</a>(this_model_part,  new_model_part, Coord, List_New_Nodes, Position_Node);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a98a3380b634031a5e1addeb63003122b">Calculate_Coordinate_And_Insert_New_Nodes_Mod</a>(this_model_part, new_model_part, Position_Node, List_New_Nodes, variable, isovalue, tolerance);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acaec87dd22b1590d7e9ee75adaa7416c">GenerateElements</a> (this_model_part, new_model_part, Position_Node, Elems_In_Isosurface, Coord, variable, isosurface_number);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Finished generating isosurface&quot;</span>)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9b2c5b2a02c3fd58a2dc7df27c28a327">  136</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9b2c5b2a02c3fd58a2dc7df27c28a327">AddModelPartElements</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_new_model_part, <span class="keywordtype">int</span> number )</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part = mr_model_part;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        NodesArrayType::iterator it_begin_node_old = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().ptr_begin();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part = mr_new_model_part;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Adding Skin Conditions to the new model part, added in layer:&quot;</span>)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        vector&lt;int&gt;  Element_Nodes( this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size());          <span class="comment">//our (int) vector, where we write -1 when the node is part of the condition faces</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordtype">int</span> number_of_tetrahedras = 0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">int</span> number_of_nodes = 0; <span class="comment">//same as above</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordtype">int</span> number_of_previous_nodes = 0; <span class="comment">// nodes from the previous conditions (planes) created</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size()!=0) <span class="comment">//it means this is not the first plane that has to be created</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">NodesArrayType</a>&amp; rNodes_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();        <span class="comment">//i need the model part just to check the id of the new nodes.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            NodesArrayType::iterator it_end_node_new = rNodes_new.ptr_end();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            NodesArrayType::iterator it_begin_node_new = rNodes_new.ptr_begin();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            number_of_previous_nodes=(it_end_node_new-it_begin_node_new);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_previous_nodes)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">else</span> <span class="comment">//nothing. number of triangles and nodes already set to 0</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Plane&quot;</span>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">//we loop all the nodes in the old model part and copy the ones used by conditions to the new model part:</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0 ; index != this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size() ; ++index)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            ++number_of_nodes; <span class="comment">//one new node!</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            Element_Nodes[index] = number_of_nodes + number_of_previous_nodes; <span class="comment">//we give this node consecutives ids. now we create the new node</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            ModelPart::NodesContainerType::iterator it_node = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().begin()+index;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            Node ::Pointer pnode = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">CreateNewNode</a>(number_of_nodes+number_of_previous_nodes, it_node-&gt;X(), it_node-&gt;Y(), it_node-&gt;Z());  <span class="comment">//recordar que es el nueevo model part!!</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            pnode-&gt;SetBufferSize(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>()-&gt;GetBufferSize());</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            pnode-&gt;GetValue(FATHER_NODES).resize(0);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node.base() ) );       <span class="comment">// we keep the same size despite we only need one. to have everyhing with the same size</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node.base() ) );</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            pnode-&gt; <a class="code" href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">GetValue</a>(WEIGHT_FATHER_NODES) = 1.0;  <span class="comment">//lo anterior no anduvo... creo q es así entonces. o hace falta el GetValue?</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            pnode-&gt;X0() = it_node-&gt;X0();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            pnode-&gt;Y0() = it_node-&gt;Y0();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            pnode-&gt;Z0() = it_node-&gt;Z0();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }<span class="comment">//finished the list of nodes to be added.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">//now to the conditions!</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        vector&lt;int&gt;  tetrahedra_nodes(4); <span class="comment">//here we&#39;ll save the nodes&#39; ids with the new node names</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="../../d5/dd4/class_kratos_1_1_element.html">Element</a> <span class="keyword">const</span>&amp; rReferenceElement = <a class="code" href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">KratosComponents&lt;Element&gt;::Get</a>(<span class="stringliteral">&quot;Fluid3D&quot;</span>);         <span class="comment">//element type</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        Properties::Pointer properties = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">GetMesh</a>().<a class="code" href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">pGetProperties</a>(number);        <span class="comment">//this will allow us later to turn this layer on/off in GID</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">for</span>(ModelPart::ElementsContainerType::iterator i_element = rElements.begin() ; i_element != rElements.end() ; i_element++) <span class="comment">//looping all the elements</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = i_element-&gt;GetGeometry(); <span class="comment">//current element(nodes, etc)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; i_element-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)         <span class="comment">//looping the nodes</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordtype">int</span> position = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Id()) - it_begin_node_old;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="comment">//int position = (geom[i].Id()) - 1; //the id of the node minus one is the position in the Condition_Node array (position0 = node1)</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                tetrahedra_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]=Element_Nodes[position]; <span class="comment">// saving the i nodeId</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            } <span class="comment">//nodes id saved. now we have to create the element.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="../../df/df1/class_kratos_1_1_tetrahedra3_d4.html">Tetrahedra3D4&lt;Node &gt;</a> geometry(</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(tetrahedra_nodes[0]),  <span class="comment">//condition to be added</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(tetrahedra_nodes[1]),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(tetrahedra_nodes[2]),</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(tetrahedra_nodes[3])</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            );</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            Element::Pointer p_element = rReferenceElement.<a class="code" href="../../d5/dd4/class_kratos_1_1_element.html#a9d3fcc73aa43b460715466d283803b61">Create</a>(number_of_tetrahedras+1, geometry, properties);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>().push_back(p_element);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            ++number_of_tetrahedras;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_tetrahedras)</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Finished copying elements&quot;</span>)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a383eeeaa6198818fe8e86986be49357b">  226</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a383eeeaa6198818fe8e86986be49357b">AddSkinConditions</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; mr_new_model_part, <span class="keywordtype">int</span> number )</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part = mr_model_part;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part = mr_new_model_part;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Adding Skin Conditions to the new model part, added in layer:&quot;</span>)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        vector&lt;int&gt;  Condition_Nodes( this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size());          <span class="comment">//our (int) vector, where we write -1 when the node is part of the condition faces</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordtype">int</span> number_of_triangles = 0; <span class="comment">//we set it to zero to start</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordtype">int</span> number_of_nodes = 0; <span class="comment">//same as above</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordtype">int</span> number_of_previous_nodes = 0; <span class="comment">// nodes from the previous conditions (planes) created</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>() = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(FATHER_NODES);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(WEIGHT_FATHER_NODES);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2d6c95d1995110ae59c14d7c03d58c51">ConditionsArrayType</a>&amp; rConditions = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">//ConditionsArrayType::iterator cond_it_begin = rConditions.ptr_begin();</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">//ConditionsArrayType::iterator cond_it_end = rConditions.ptr_end();</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2d6c95d1995110ae59c14d7c03d58c51">ConditionsArrayType</a>&amp; rConditions_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        ConditionsArrayType::iterator cond_it_end_new = rConditions_new.ptr_end();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        ConditionsArrayType::iterator cond_it_begin_new = rConditions_new.ptr_begin();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size()!=0) <span class="comment">//it means this is not the first plane that has to be created</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">NodesArrayType</a>&amp; rNodes_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();        <span class="comment">//i need the model part just to check the id of the new nodes.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            NodesArrayType::iterator it_end_node_new = rNodes_new.ptr_end();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            NodesArrayType::iterator it_begin_node_new = rNodes_new.ptr_begin();</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            number_of_previous_nodes=(it_end_node_new-it_begin_node_new);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            number_of_triangles=cond_it_end_new - cond_it_begin_new ;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_triangles)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_previous_nodes)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">//KRATOS_CATCH(&quot;&quot;)</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">else</span> <span class="comment">//nothing. number of triangles and nodes already set to 0</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Plane&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0 ; index != this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size() ; ++index) Condition_Nodes[index]=0; <span class="comment">//initializing in zero the whole vector (meaning no useful nodes for the condition layer)</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">for</span>(ModelPart::ConditionsContainerType::iterator i_condition = rConditions.begin() ; i_condition != rConditions.end() ; i_condition++)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = i_condition-&gt;GetGeometry();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; i_condition-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordtype">int</span> position = (geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>()) - 1; <span class="comment">//the id of the node minus one is the position in the Condition_Node array (position0 = node1)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                Condition_Nodes[position] =  -1 ; <span class="comment">//a -1 means we need this node!</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }<span class="comment">//done. now we know all the nodes that will have to be added to the new model part.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="comment">//we loop all the nodes in the old model part and copy the ones used by conditions to the new model part:</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0 ; index != this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size() ; ++index)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">if</span> (Condition_Nodes[index]==-1)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                ++number_of_nodes; <span class="comment">//one new node!</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                Condition_Nodes[index] = number_of_nodes + number_of_previous_nodes; <span class="comment">//we give this node consecutives ids. now we create the new node</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                ModelPart::NodesContainerType::iterator it_node = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().begin()+index;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                Node ::Pointer pnode = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">CreateNewNode</a>(number_of_nodes+number_of_previous_nodes, it_node-&gt;X(), it_node-&gt;Y(), it_node-&gt;Z());  <span class="comment">//recordar que es el nueevo model part!!</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                pnode-&gt;SetBufferSize(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>()-&gt;GetBufferSize());</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).resize(0);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node.base() ) );       <span class="comment">// we keep the same size despite we only need one. to have everyhing with the same size</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node.base() ) );</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                pnode-&gt; <a class="code" href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">GetValue</a>(WEIGHT_FATHER_NODES) = 1.0;  <span class="comment">//lo anterior no anduvo... creo q es así entonces. o hace falta el GetValue?</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                pnode-&gt;X0() = it_node-&gt;X0();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                pnode-&gt;Y0() = it_node-&gt;Y0();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                pnode-&gt;Z0() = it_node-&gt;Z0();</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        }<span class="comment">//finished the list of nodes to be added.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">//now to the conditions!</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        vector&lt;int&gt;  triangle_nodes(3); <span class="comment">//here we&#39;ll save the nodes&#39; ids with the new node names</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html">Condition</a> <span class="keyword">const</span>&amp; rReferenceCondition = <a class="code" href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">KratosComponents&lt;Condition&gt;::Get</a>(<span class="stringliteral">&quot;SurfaceCondition3D3N&quot;</span>);         <span class="comment">//condition type</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        Properties::Pointer properties = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">GetMesh</a>().<a class="code" href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">pGetProperties</a>(number);      <span class="comment">//this will allow us later to turn this layer on/off in GID</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">for</span>(ModelPart::ConditionsContainerType::iterator i_condition = rConditions.begin() ; i_condition != rConditions.end() ; i_condition++) <span class="comment">//looping all the conditions</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = i_condition-&gt;GetGeometry(); <span class="comment">//current condition(nodes, etc)</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; i_condition-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)         <span class="comment">//looping the nodes</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                <span class="keywordtype">int</span> position = (geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>()) - 1; <span class="comment">//the id of the node minus one is the position in the Condition_Node array (position0 = node1)</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                triangle_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]=Condition_Nodes[position]; <span class="comment">// saving the i nodeId</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            } <span class="comment">//nodes id saved. now we have to create the element.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geometry(</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(triangle_nodes[0]),  <span class="comment">//condition to be added</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(triangle_nodes[1]),</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(triangle_nodes[2])</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            );</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1, geometry, properties); <span class="comment">//está bien? acá la verdad ni idea. sobre todo number_of_triangles (la posición). o debe ser un puntero de elemento en vez de un entero?</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            ++number_of_triangles;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Finished copying conditions surfaces&quot;</span>)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a>(<span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a6bb0e71a15665cdbe10f9bc24294278f">  331</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a6bb0e71a15665cdbe10f9bc24294278f">CSR_Row_Matrix_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, compressed_matrix&lt;int&gt;&amp; Coord)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">NodesArrayType</a>&amp; pNodes = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        Coord.resize(pNodes.size(), pNodes.size());</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        NodesArrayType::iterator i_begin = pNodes.ptr_begin();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        NodesArrayType::iterator i_end = pNodes.ptr_end();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        std::vector&lt;unsigned int&gt; aux(10000);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">ModelPart::NodeIterator</a> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = i_begin; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> != i_end; ++<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <span class="keywordtype">int</span> index_i = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>-&gt;Id() - 1;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">GlobalPointersVector&lt; Node &gt;</a>&amp; neighb_nodes = <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>-&gt;GetValue(NEIGHBOUR_NODES);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            Coord.push_back(index_i, index_i, -1);        <span class="comment">//only modification added, now the diagonal is filled with -1 too.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a> = 0;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a04db5b3969fe3a11463c561a3cae856a">GlobalPointersVector&lt; Node &gt;::iterator</a> inode = neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a599125ad0e25d62480de5e84477b5f20">begin</a>(); inode != neighb_nodes.<a class="code" href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#aecf3bbe94f6105274d86e19e7bbe3631">end</a>(); inode++)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordtype">int</span> index_j = inode-&gt;Id() - 1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordflow">if</span> (index_j &gt; index_i)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    aux[<a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>] = index_j;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>++;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            std::sort(aux.begin(), aux.begin() + <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a> &lt; <a class="code" href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">active</a>; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>++)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                Coord.push_back(index_i, aux[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>], -1);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a5c32bddb7c13a9c76df9c26722ece2cf">  367</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a5c32bddb7c13a9c76df9c26722ece2cf">FirstLoop</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, compressed_matrix&lt;int&gt;&amp; Coord, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable&lt;double&gt;</a>&amp; variable, <span class="keywordtype">double</span> isovalue, <span class="keywordtype">int</span> number_of_triangles, vector&lt;int&gt;&amp;  Elems_In_Isosurface, <span class="keywordtype">float</span> tolerance)<span class="comment">//</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="comment">//varible is the variable that defines the isosurface</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">//isovalue is the value of the variable that defines the isosurface</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        ElementsArrayType::iterator it_begin = rElements.ptr_begin();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        ElementsArrayType::iterator it_end = rElements.ptr_end();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> node_value;                     <span class="comment">// value of the variable in the node</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> neigh_value;                    <span class="comment">// value of the variable in thr other node of the edge</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> diff_node_value;                <span class="comment">// difference between the imposed value of the variable and its value in the node</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> diff_neigh_value;               <span class="comment">// difference beween the variable value on other node of the edge (neighbour) and the imposed value</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;unsigned int, 4 &gt;</a> list_matching_nodes;      <span class="comment">//used to save the new nodes that match exactly old nodes (very unlikely, but might be 4 for very plane elements)</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> exact_nodes=0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        number_of_triangles = 0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordtype">int</span> current_element= 0; <span class="comment">//current element. it&#39;s a position. NOT ID!</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordtype">int</span> number_of_cuts= 0; <span class="comment">//this is the counter explained in the following lines</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">for</span> (ElementsArrayType::iterator it = it_begin; it != it_end; ++it) <span class="comment">//looping all the elements</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            ++current_element;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            number_of_cuts = 0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            exact_nodes = 0 ;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//geometry of the element</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="comment">//when we have a triangle inside a thetraedra, its edges (or nodes) must be cut 3 times by the plane. if we loop all 2 times we can have a counter. when it&#39;s = 6 then we have a triangle. when tetrahedras are cutted 8 times then we have 2 triangles (or a cuatrilateral, the same)</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                diff_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = isovalue - node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)          <span class="comment">//  looping on the neighbours</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> != <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>)  <span class="comment">//(cant link node with itself)</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        diff_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = isovalue - neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>];</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <span class="keywordtype">bool</span> isovernode=<span class="keyword">false</span>;   <span class="comment">// if true, then it can&#39;t be between the nodes</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        <span class="keywordflow">if</span> (fabs(diff_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]) &lt; (tolerance)) <span class="comment">//then our node is part of the plane (this should have been done before the loop on neighbours, but this way it is easier to read .</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() -1 ; <span class="comment">// i node id</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                            Coord(index_i, index_i) = -2;                 <span class="comment">//saving a -2 in the diagonal</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                            isovernode=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            number_of_cuts += 2; <span class="comment">//since its neighbour wont take this case as a cut, we must save 2 cuts instead of one. (to reach number_of_cuts=6),</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                            ++exact_nodes;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            list_matching_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]= geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                        }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        <span class="comment">//check this last condition, used to avoid talking points that belong to other node. might cause some problems when the plane is almost paralel to an edge. to be improved! (it seems to be working correcly even when the edge is part of the plane.)</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        <span class="keywordflow">if</span> ((diff_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]*diff_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>]) &lt; 0.0 &amp;&amp; isovernode==<span class="keyword">false</span> &amp;&amp; fabs(diff_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>]) &gt; tolerance) <span class="comment">// this means one has a bigger value than the imposed values and the other smaller, no need to do more checks, between there is a point that should match the value!</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                        {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                            <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//j node id</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                            <span class="keywordflow">if</span> (index_j &gt; index_i)  Coord(index_i, index_j) = -2;    <span class="comment">//saving a -2 in the upper side of the matrix</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                            <span class="keywordflow">else</span> Coord(index_j, index_i) = -2;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                            number_of_cuts += 1;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    } <span class="comment">//closing the i!=j if</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                } <span class="comment">//closing the neighbour loop</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            } <span class="comment">//closing the nodes loop</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span> (tolerance &gt; (diff_node_value[0]) &amp;&amp; tolerance &gt; (diff_node_value[1]) &amp;&amp; tolerance &gt; (diff_node_value[2]) &amp;&amp; tolerance &gt; (diff_node_value[3])) <span class="comment">//if all the nodes have the same the same value as the isovalue we do not take into account the triangles</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                    number_of_cuts -= 2;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    --exact_nodes;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="comment">//now we have to save the data. we should get a list with the elements that will genereate triangles and the total number of triangles</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            Elems_In_Isosurface[current_element-1] = 0 ; <span class="comment">//we initialize as 0</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <span class="keywordflow">if</span> (number_of_cuts == 6)     <span class="comment">//it can be 8, in that case we have 2 triangles (the cut generates a square)</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                number_of_triangles +=1;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                Elems_In_Isosurface[current_element-1] = 1 ; <span class="comment">//i still don&#39;t know the number of the node so i&#39;ll have to do another loop later to assign to define node id&#39;s of each triangular element</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (number_of_cuts == 8 ) <span class="comment">// 2 triangles in the element!</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                number_of_triangles +=2;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                Elems_In_Isosurface[ current_element-1] = 2 ;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        } <span class="comment">//closing the elem loop</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_triangles);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    } <span class="comment">//closing &quot;FirstLoop&quot;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae62da93cee3398ae22506f92bcd9a25d">  461</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae62da93cee3398ae22506f92bcd9a25d">FirstLoop</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, compressed_matrix&lt;int&gt;&amp; Coord, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable</a> &lt; <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double,3&gt;</a> &gt;&amp; variable, <span class="keywordtype">double</span> isovalue, <span class="keywordtype">int</span> number_of_triangles, vector&lt;int&gt;&amp;  Elems_In_Isosurface, <span class="keywordtype">float</span> tolerance)<span class="comment">//</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">//varible is the variable that defines the isosurface</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">//isovalue is the value of the variable that defines the isosurface</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        ElementsArrayType::iterator it_begin = rElements.ptr_begin();</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        ElementsArrayType::iterator it_end = rElements.ptr_end();</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt; array_1d&lt;double,3&gt;</a>, 4 &gt; vector_node_value;  <span class="comment">// value of the variable in the node</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt; array_1d&lt;double,3&gt;</a>, 4 &gt; vector_neigh_value; <span class="comment">// value of the variable in the other node of the edge</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;long double, 4 &gt;</a> squared_node_value;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;long double, 4 &gt;</a> squared_neigh_value;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="keywordtype">double</span> squared_isovalue = isovalue * isovalue;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordtype">double</span> aux_value;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordtype">double</span> weight1;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordtype">double</span> weight2;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> node_value;                      <span class="comment">// module of the variable in the node</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> neigh_value;                     <span class="comment">// module of the variable in the other node of the edge</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> diff_node_value;                 <span class="comment">// difference between the imposed value of the variable and its value in the node</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> diff_neigh_value;                <span class="comment">// difference beween the variable value on other node of the edge (neighbour) and the imposed value</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;unsigned int, 4 &gt;</a> list_matching_nodes;      <span class="comment">//used to save the new nodes that match exactly old nodes (very unlikely, but might be 4 for very plane elements)</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> exact_nodes=0;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        number_of_triangles = 0;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordtype">int</span> current_element= 0; <span class="comment">//current element. it&#39;s a position. NOT ID!</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordtype">int</span> number_of_cuts= 0; <span class="comment">//this is the counter explained in the following lines</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">for</span> (ElementsArrayType::iterator it = it_begin; it != it_end; ++it) <span class="comment">//looping all the elements</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            ++current_element;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            number_of_cuts = 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            exact_nodes = 0 ;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//geometry of the element</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <span class="comment">//when we have a triangle inside a thetraedra, its edges (or nodes) must be cut 3 times by the plane. if we loop all 2 times we can have a counter. when it&#39;s = 6 then we have a triangle. when tetrahedras are cutted 8 times then we have 2 triangles (or a cuatrilateral, the same)</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                squared_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0]) + (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1]) + (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2]);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = sqrt(squared_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                diff_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = isovalue - node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>];</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)          <span class="comment">//  looping on the neighbours</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> != <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>)  <span class="comment">//(cant link node with itself)</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                        squared_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = (vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][0] * vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][0]) + (vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][1] * vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][1]) + (vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][2] * vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][2]);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                        neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = sqrt(squared_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>]);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                        diff_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = isovalue - neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        aux_value = (vector_node_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][0] * vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][0]) + (vector_node_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][1] * vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][1]) + (vector_node_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][2] * vector_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>][2]);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                        <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> = squared_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] + squared_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] - (2 * aux_value);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = 2 * (aux_value - squared_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = squared_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] - squared_isovalue;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        <span class="keywordtype">float</span> <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a> = 0.000001;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>) &lt; <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>)</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                        {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> &gt; 0) <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> &lt; 0) <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> = -<a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>) &lt; <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>) <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> &gt; 0) <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> &lt; 0) <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = -<a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                        }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>) &lt; <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>) <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                        {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> &gt; 0) <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> &lt; 0) <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = -<a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                        }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                        weight1 = (-<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> + sqrt((<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> * <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>) - (4 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> * <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>))) / (2 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                        weight2 = (-<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> - sqrt((<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> * <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>) - (4 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> * <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>))) / (2 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <span class="keywordtype">bool</span> isovernode=<span class="keyword">false</span>;   <span class="comment">// if true, then it can&#39;t be between the nodes</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        <span class="keywordflow">if</span> (fabs(diff_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]) &lt;= (tolerance)) <span class="comment">//then our node is part of the plane (this should have been done before the loop on neighbours, but this way it is easier to read .</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                        {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() -1 ; <span class="comment">// i node id</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                            Coord(index_i, index_i) = -2;                 <span class="comment">//saving a -2 in the diagonal</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                            isovernode=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                            number_of_cuts += 2; <span class="comment">//since its neighbour wont take this case as a cut, we must save 2 cuts instead of one. (to reach number_of_cuts=6),</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                            ++exact_nodes;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                            list_matching_nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>]= geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                        <span class="comment">//check this last condition, used to avoid talking points that belong to other node. might cause some problems when the plane is almost paralel to an edge. to be improved! (it seems to be working correcly even when the edge is part of the plane.)</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                        <span class="keywordflow">if</span> (weight1 &gt; 0.0 &amp;&amp; weight1 &lt; 1.0 &amp;&amp; fabs(diff_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>]) &gt; tolerance  &amp;&amp; isovernode==<span class="keyword">false</span>) <span class="comment">// this means one has a bigger value than the imposed values and the other smaller, no need to do more checks, between there is a point that should match the value!</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                        {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                            <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//j node id</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                            <span class="keywordflow">if</span> (index_j &gt; index_i)  Coord(index_i, index_j) = -2;    <span class="comment">//saving a -2 in the upper side of the matrix</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                            <span class="keywordflow">else</span> Coord(index_j, index_i) = -2;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                            isovernode=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                            number_of_cuts += 1;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                        }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                        <span class="keywordflow">if</span> (weight2 &gt; 0.0 &amp;&amp; weight2 &lt; 1.0 &amp;&amp; fabs(diff_neigh_value[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>]) &gt; tolerance  &amp;&amp; isovernode==<span class="keyword">false</span>)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                        {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                            <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                            <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//j node id</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                            <span class="keywordflow">if</span> (index_j &gt; index_i)  Coord(index_i, index_j) = -2;    <span class="comment">//saving a -2 in the upper side of the matrix</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                            <span class="keywordflow">else</span> Coord(index_j, index_i) = -2;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                            number_of_cuts += 1;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                        }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    } <span class="comment">//closing the i!=j if</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                } <span class="comment">//closing the neighbour loop</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            } <span class="comment">//closing the nodes loop</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">if</span> (tolerance &gt; (diff_node_value[0]) &amp;&amp; tolerance &gt; (diff_node_value[1]) &amp;&amp; tolerance &gt; (diff_node_value[2]) &amp;&amp; tolerance &gt; (diff_node_value[3])) <span class="comment">//if all the nodes have the same the same value as the isovalue we do not take into account the triangles</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                    number_of_cuts -= 2;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    --exact_nodes;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">//now we have to save the data. we should get a list with the elements that will genereate triangles and the total number of triangles</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            Elems_In_Isosurface[current_element-1] = 0 ; <span class="comment">//we initialize as 0</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keywordflow">if</span> (number_of_cuts == 6)     <span class="comment">//it can be 8, in that case we have 2 triangles (the cut generates a square)</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                number_of_triangles +=1;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                Elems_In_Isosurface[current_element-1] = 1 ; <span class="comment">//i still don&#39;t know the number of the node so i&#39;ll have to do another loop later to assign to define node id&#39;s of each triangular element</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (number_of_cuts == 8 ) <span class="comment">// 2 triangles in the element!</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                number_of_triangles +=2;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                Elems_In_Isosurface[ current_element-1] = 2 ;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        } <span class="comment">//closing the elem loop</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(number_of_triangles);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    } <span class="comment">//closing &quot;FirstLoop&quot;</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2ca92ded31f362c0a8cfd641d1126b48">  610</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2ca92ded31f362c0a8cfd641d1126b48">Create_List_Of_New_Nodes_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, compressed_matrix&lt;int&gt;&amp; Coord, boost::numeric::ublas::vector&lt;int&gt; &amp;List_New_Nodes, boost::numeric::ublas::vector&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 2 &gt;</a> &gt;&amp; Position_Node) <span class="comment">//surface number = 1 -- inf (but the first one should be always one!</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> number_of_new_nodes = 0;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">//NodesArrayType&amp; pNodes = this_model_part.Nodes();</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keyword">typedef</span> compressed_matrix&lt;int&gt;::iterator1 i1_t;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keyword">typedef</span> compressed_matrix&lt;int&gt;::iterator2 i2_t;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">for</span> (i1_t i1 = Coord.begin1(); i1 != Coord.end1(); ++i1)</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">for</span> (i2_t i2 = i1.begin(); i2 != i1.end(); ++i2)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                <span class="keywordflow">if</span> (Coord(i2.index1(), i2.index2()) == -2)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    number_of_new_nodes++;                          <span class="comment">//this should work without any change</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">if</span> (number_of_new_nodes != 0)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            List_New_Nodes.resize(number_of_new_nodes);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="comment">//int total_node = pNodes.size();</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">if</span> (new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().size()!=0) <span class="comment">//it means this is not the first surface that has to be created</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">NodesArrayType</a>&amp; rNodes_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>();        <span class="comment">//i need the model part just to check the id of the new nodes.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                NodesArrayType::iterator it_end_node_new = rNodes_new.ptr_end();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                NodesArrayType::iterator it_begin_node_new = rNodes_new.ptr_begin();</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                List_New_Nodes[0]=(it_end_node_new-it_begin_node_new)+1;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;New Cutting Surface&quot;</span>)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                first_cutting_surface = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                List_New_Nodes[0]=1;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Surface&quot;</span>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                first_cutting_surface = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 1; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; number_of_new_nodes; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                List_New_Nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = List_New_Nodes[0] + <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>;      <span class="comment">//just a list. necessary because other cutting surfaces might have been generated before</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            Position_Node.resize(number_of_new_nodes);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">for</span> (i1_t i1 = Coord.begin1(); i1 != Coord.end1(); ++i1)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="keywordflow">for</span> (i2_t i2 = i1.begin(); i2 != i1.end(); ++i2)</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <span class="keywordflow">if</span> (Coord(i2.index1(), i2.index2()) == -2)</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                    {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                        Coord(i2.index1(), i2.index2()) = List_New_Nodes[index];</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                        Position_Node[index][0] = i2.index1() + 1;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                        Position_Node[index][1] = i2.index2() + 1;                     <span class="comment">//in the diagonal terms both indexes should point to the same node but still should work i guess</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                        index++;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                    }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a98a3380b634031a5e1addeb63003122b">  676</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a98a3380b634031a5e1addeb63003122b">Calculate_Coordinate_And_Insert_New_Nodes_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <span class="keyword">const</span> boost::numeric::ublas::vector&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 2 &gt;</a> &gt;&amp; Position_Node, <span class="keyword">const</span> boost::numeric::ublas::vector&lt;int&gt; &amp;List_New_Nodes, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable&lt;double&gt;</a>&amp; variable, <span class="keywordtype">double</span> isovalue, <span class="keywordtype">float</span> tolerance)<span class="comment">//,</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_1;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_2;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_dist;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_distance;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordtype">double</span> node_value;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordtype">double</span> neigh_value;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordtype">double</span> diff_node_value;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordtype">double</span> diff_neigh_value;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordtype">double</span> diff_neigh_node_value;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordtype">double</span> weight;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        boost::numeric::ublas::vector&lt; array_1d&lt;double, 3 &gt; &gt; Coordinate_New_Node;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        Coordinate_New_Node.<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html#a460da1efd1801dc00e9844418fbc6d58">resize</a>(Position_Node.size());</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>() = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>();</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(FATHER_NODES);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(WEIGHT_FATHER_NODES);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; Position_Node.size(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++) <span class="comment">//looping the new nodes</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; node_i = Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0];</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; node_j = Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1];</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            ModelPart::NodesContainerType::iterator it_node1 = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(node_i);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(Coord_Node_1) = it_node1-&gt;Coordinates();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            ModelPart::NodesContainerType::iterator it_node2 = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(node_j);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(Coord_Node_2) = it_node2-&gt;Coordinates();</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="comment">//ok, now we have both coordinates. now we must define a weight coefficient based on the distance.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="comment">//this coeff will be =node_plane_distance/node_neigh_distance (linear interpolation)</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            node_value = it_node1-&gt;FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            neigh_value = it_node2-&gt;FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            diff_node_value = isovalue - node_value;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            diff_neigh_value = isovalue - neigh_value;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            diff_neigh_node_value = neigh_value - node_value;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            vector_distance = Coord_Node_2 - Coord_Node_1;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            <span class="keywordflow">if</span> (fabs(diff_node_value) &lt;  tolerance) weight = 0.0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fabs(diff_neigh_value) &lt;  tolerance) weight = 1.0;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            <span class="keywordflow">else</span> weight = diff_node_value / diff_neigh_node_value;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="keywordflow">if</span> (weight &gt; 1.00005) <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;**** something&#39;s wrong! weight higher than 1! ****&quot;</span>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0; index!=3; ++index) <span class="comment">//we loop the 3 coordinates)</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="keywordflow">if</span> (Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0]!=Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1])  Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][index] = Coord_Node_1[index] + vector_distance[index] * weight;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="keywordflow">else</span>   Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][index] = Coord_Node_1[index]; <span class="comment">//when both nodes are the same it doesnt make any sense to interpolate</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                Node ::Pointer pnode = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">CreateNewNode</a>(List_New_Nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2]);  <span class="comment">//remember that is the new model part!!</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                pnode-&gt;SetBufferSize(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>()-&gt;GetBufferSize());</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).resize(0);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node1.base() ) );       <span class="comment">//saving data about fathers in the model part</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node2.base() ) );</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                pnode-&gt; <a class="code" href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">GetValue</a>(WEIGHT_FATHER_NODES) = weight;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                pnode-&gt;X0() = (1.0 - weight) * (it_node1-&gt;X0())  +  weight * it_node2-&gt;X0();</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                pnode-&gt;Y0() = (1.0 - weight) * (it_node1-&gt;Y0())  +  weight * it_node2-&gt;Y0();</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                pnode-&gt;Z0() = (1.0 - weight) * (it_node1-&gt;Z0())  +  weight * it_node2-&gt;Z0();</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acf08d1646f23d79c629dd7699edb0e30">  743</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acf08d1646f23d79c629dd7699edb0e30">Calculate_Coordinate_And_Insert_New_Nodes_Mod</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <span class="keyword">const</span> boost::numeric::ublas::vector&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 2 &gt;</a> &gt;&amp; Position_Node, <span class="keyword">const</span> boost::numeric::ublas::vector&lt;int&gt; &amp;List_New_Nodes, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable</a>&lt; <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt; double, 3&gt;</a> &gt;&amp; variable, <span class="keywordtype">double</span> isovalue, <span class="keywordtype">float</span> tolerance)<span class="comment">//,</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_1;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_2;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_dist;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_distance;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_node_value;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_neigh_value;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordtype">double</span> squared_node_value;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keywordtype">double</span> squared_neigh_value;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordtype">double</span> node_value;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordtype">double</span> neigh_value;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordtype">double</span> aux_value;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordtype">double</span> squared_isovalue;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">double</span> diff_node_value;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordtype">double</span> diff_neigh_value;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordtype">double</span> weight;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordtype">double</span> weight1;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keywordtype">double</span> weight2;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        boost::numeric::ublas::vector&lt; array_1d&lt;double, 3 &gt; &gt; Coordinate_New_Node;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        Coordinate_New_Node.resize(Position_Node.size());</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>() = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">GetNodalSolutionStepVariablesList</a>();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(FATHER_NODES);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">AddNodalSolutionStepVariable</a>(WEIGHT_FATHER_NODES);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; Position_Node.size(); <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++) <span class="comment">//looping the new nodes</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; node_i = Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0];</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; node_j = Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1];</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            ModelPart::NodesContainerType::iterator it_node1 = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(node_i);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(Coord_Node_1) = it_node1-&gt;Coordinates();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            ModelPart::NodesContainerType::iterator it_node2 = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(node_j);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(Coord_Node_2) = it_node2-&gt;Coordinates();</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">//ok, now we have both coordinates. now we must define a weight coefficient based on the distance.</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="comment">//this coeff will be =node_plane_distance/node_neigh_distance (linear interpolation)</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            vector_node_value = it_node1-&gt;FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            squared_node_value = (vector_node_value[0] * vector_node_value[0]) + (vector_node_value[1] * vector_node_value[1]) + (vector_node_value[2] * vector_node_value[2]);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            node_value = sqrt(squared_node_value);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            vector_neigh_value = it_node2-&gt;FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            squared_neigh_value = (vector_neigh_value[0] * vector_neigh_value[0]) + (vector_neigh_value[1] * vector_neigh_value[1]) + (vector_neigh_value[2] * vector_neigh_value[2]);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            neigh_value = sqrt(squared_neigh_value);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            aux_value = (vector_node_value[0] * vector_neigh_value[0]) + (vector_node_value[1] * vector_neigh_value[1]) + (vector_node_value[2] * vector_neigh_value[2]);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            squared_isovalue = isovalue * isovalue;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> = squared_node_value + squared_neigh_value - (2 * aux_value);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = 2 * (aux_value - squared_node_value);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = squared_node_value - squared_isovalue;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordtype">float</span> <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a> = 0.000001;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>) &lt; <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> &gt; 0) <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> &lt; 0) <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> = -<a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>) &lt; <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>) <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> &gt; 0) <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> &lt; 0) <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> = -<a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="keywordflow">if</span> (fabs(<a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>) &lt; <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>) <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> &gt; 0) <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = <a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> &lt; 0) <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a> = -<a class="code" href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">tol</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            diff_node_value = isovalue - node_value;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            diff_neigh_value = isovalue - neigh_value;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            vector_distance = Coord_Node_2 - Coord_Node_1;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordflow">if</span> (fabs(diff_node_value) &lt;  tolerance) weight = 0.0;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fabs(diff_neigh_value) &lt;  tolerance) weight = 1.0;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                weight1 = (-<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> + sqrt((<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> * <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>) - (4 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> * <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>))) / (2 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                weight2 = (-<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> - sqrt((<a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a> * <a class="code" href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">b</a>) - (4 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a> * <a class="code" href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">c</a>))) / (2 * <a class="code" href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">a</a>);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <span class="keywordflow">if</span> (weight1 &lt; 1.0 &amp;&amp; weight1 &gt; 0.0) weight = weight1;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (weight2 &lt; 1.0 &amp;&amp; weight2 &gt; 0.0) weight = weight2;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="keywordflow">if</span> (weight &gt; 1.00005) <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;**** something&#39;s wrong! weight higher than 1! ****&quot;</span>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index=0; index!=3; ++index) <span class="comment">//we loop the 3 coordinates)</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                <span class="keywordflow">if</span> (Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0]!=Position_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1])  Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][index] = Coord_Node_1[index] + vector_distance[index] * weight;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="keywordflow">else</span>   Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][index] = Coord_Node_1[index]; <span class="comment">//when both nodes are the same it doesnt make any sense to interpolate</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                Node ::Pointer pnode = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">CreateNewNode</a>(List_New_Nodes[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1], Coordinate_New_Node[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2]);  <span class="comment">//remember that is the new model part!!</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                pnode-&gt;SetBufferSize(this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>()-&gt;GetBufferSize());</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).resize(0);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node1.base() ) );       <span class="comment">//saving data about fathers in the model part</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                pnode-&gt;GetValue(FATHER_NODES).push_back( Node::WeakPointer( *it_node2.base() ) );</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                pnode-&gt; <a class="code" href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">GetValue</a>(WEIGHT_FATHER_NODES) = weight;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                pnode-&gt;X0() = (1.0 - weight) * (it_node1-&gt;X0())  +  weight * it_node2-&gt;X0();</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                pnode-&gt;Y0() = (1.0 - weight) * (it_node1-&gt;Y0())  +  weight * it_node2-&gt;Y0();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                pnode-&gt;Z0() = (1.0 - weight) * (it_node1-&gt;Z0())  +  weight * it_node2-&gt;Z0();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            weight = 0;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            weight1 = 0;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            weight2 = 0;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acaec87dd22b1590d7e9ee75adaa7416c">  861</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acaec87dd22b1590d7e9ee75adaa7416c">GenerateElements</a> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <span class="keyword">const</span> boost::numeric::ublas::vector&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 4 &gt;</a> &gt;&amp; Position_Node, vector&lt;int&gt; Elems_In_Isosurface, compressed_matrix&lt;int&gt;&amp; Coord, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable&lt;double&gt;</a>&amp; variable, <span class="keywordtype">int</span> surface_number)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector1;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector2;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector3;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector4;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector5;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_1;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_2;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_3;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_4;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_max;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_min;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_normal;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordtype">double</span> dist2; <span class="comment">//to be used when there are 2 triangles in the tetrahedra</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordtype">double</span> dist3;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="../../dd/d7b/namespacecontrol.html">control</a>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 6 &gt;</a> nodes_for_2triang; <span class="comment">//to be used when there are 2 triangles</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> node_value;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> temp_int;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> first_element=0;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements_old = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        ElementsArrayType::iterator it_begin_old = rElements_old.ptr_begin();</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        ElementsArrayType::iterator it_end_old = rElements_old.ptr_end();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        ElementsArrayType::iterator it_begin_new = rElements_new.ptr_begin();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        ElementsArrayType::iterator it_end_new = rElements_new.ptr_end();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        boost::numeric::ublas::vector&lt; array_1d&lt;double, 3 &gt; &gt; Coordinate_New_Node;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        Coordinate_New_Node.resize(Position_Node.size());</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">if</span> (first_cutting_surface == <span class="keyword">false</span>) <span class="comment">//it means this is not the first surface that has to be created</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            first_element=(it_end_new-it_begin_new);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;New Cutting Surface&quot;</span>)</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(first_element)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            first_element=0;                      <span class="comment">//or we&#39;re creating the first elements of the model part</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Surface&quot;</span>);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html">Condition</a> <span class="keyword">const</span>&amp; rReferenceCondition = <a class="code" href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">KratosComponents&lt;Condition&gt;::Get</a>(<span class="stringliteral">&quot;SurfaceCondition3D3N&quot;</span>);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        Properties::Pointer properties = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">GetMesh</a>().<a class="code" href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">pGetProperties</a>(surface_number);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <span class="keywordtype">int</span> number_of_triangles =  0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordtype">int</span> current_element= 0;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triangle_nodes= 0;  <span class="comment">// number of nodes already saved (of the current element)</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordtype">bool</span> new_node = false ; <span class="comment">//used to check whether the current node has been saved or not</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 4 &gt;</a> TriangleNodesArray; <span class="comment">//nodes of the element to be generated. 4 in case they&#39;re 2 triangles</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>=0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>!=4; ++<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            TriangleNodesArray[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>] = -1;   <span class="comment">//initializing in -1, meaning we have no nodes yet</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">for</span> (ElementsArrayType::iterator it = it_begin_old; it != it_end_old; ++it)</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            ++current_element;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            triangle_nodes = 0; <span class="comment">//starting, no nodes yet</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="comment"></span>            <span class="keywordflow">if</span> (Elems_In_Isosurface[current_element-1] == 1 ) <span class="comment">//do not forget than can be both 1 or 2 triangles per tetrahedra. this is the simplest case. no need to check anything, we just create an element with the 3 nodes</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="comment">//checking element conectivities</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//i node of the element</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++) <span class="comment">//j node of the element</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                        new_node= <span class="keyword">true</span>; <span class="comment">//by default it&#39;s a new node</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                        <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                        <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>=0; <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>!=3; ++<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>)</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                        {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                            <span class="keywordflow">if</span>(TriangleNodesArray[<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>]==Coord(index_i, index_j) || Coord(index_i, index_j) &lt;1 ) new_node=<span class="keyword">false</span>; <span class="comment">//if we have already saved this node or it has not been cutted, then we have no new node to add (coord(i,j)=-1)</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                        }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                        <span class="comment">//if it&#39;s a new node and the indexes are correct:</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                        <span class="keywordflow">if</span> (new_node &amp;&amp; index_i&lt;=index_j)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                        {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                            TriangleNodesArray[triangle_nodes]=Coord(index_i, index_j) ;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                            triangle_nodes++;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                        }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                        <span class="keywordflow">if</span> (triangle_nodes ==3) <span class="keywordflow">break</span>;               <span class="comment">//if we have already found 3 nodes then we can exit</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    } <span class="comment">//closing j node loop</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                    <span class="keywordflow">if</span> (triangle_nodes ==3) <span class="keywordflow">break</span>;               <span class="comment">//egal</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                } <span class="comment">//closing i node loop</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <span class="comment">//now we have to check that the normal of the element is in the direction of the gradient of the scalar field. To do this the value of the variable in all the nodes of the element of the old model part is evaluated. With the biggest and the smallest values a vector between those coordinates is calculated. The inner product of that vector and the normal vector of the element should be positive.</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                    node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    Coord_Node[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    Coord_Node[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    Coord_Node[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 0)</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                        Coord_Node_1 = Coord_Node;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 1)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                    {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                        Coord_Node_2 = Coord_Node;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                    }</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 2)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                    {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                        Coord_Node_3 = Coord_Node;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                    }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 3)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                    {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                        Coord_Node_4 = Coord_Node;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                    }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &gt;= node_value[1] &amp;&amp; node_value[0] &gt;= node_value[2] &amp;&amp; node_value[0] &gt;= node_value[3]) vector_max=Coord_Node_1;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &gt; node_value[0] &amp;&amp; node_value[1] &gt; node_value[2] &amp;&amp; node_value[1] &gt; node_value[3]) vector_max=Coord_Node_2;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &gt; node_value[0] &amp;&amp; node_value[2] &gt; node_value[1] &amp;&amp; node_value[2] &gt; node_value[3]) vector_max=Coord_Node_3;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &gt; node_value[0] &amp;&amp; node_value[3] &gt; node_value[1] &amp;&amp; node_value[3] &gt; node_value[2]) vector_max=Coord_Node_4;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &lt; node_value[1] &amp;&amp; node_value[0] &lt; node_value[2] &amp;&amp; node_value[0] &lt; node_value[3]) vector_min=Coord_Node_1;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &lt; node_value[0] &amp;&amp; node_value[1] &lt; node_value[2] &amp;&amp; node_value[1] &lt; node_value[3]) vector_min=Coord_Node_2;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &lt; node_value[0] &amp;&amp; node_value[2] &lt; node_value[1] &amp;&amp; node_value[2] &lt; node_value[3]) vector_min=Coord_Node_3;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &lt;= node_value[0] &amp;&amp; node_value[3] &lt;= node_value[1] &amp;&amp; node_value[3] &lt;= node_value[2]) vector_min=Coord_Node_4;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                vector_normal = vector_max - vector_min;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                ModelPart::NodesContainerType::iterator new_it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[0]);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = new_it_node1-&gt;Coordinates(); <span class="comment">//node 1</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                ModelPart::NodesContainerType::iterator new_it_node2 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[1]);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = new_it_node2-&gt;Coordinates(); <span class="comment">//node 2</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                ModelPart::NodesContainerType::iterator new_it_node3 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[2]);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = new_it_node3-&gt;Coordinates(); <span class="comment">//nodo 3</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                temp_vector3 -=temp_vector1; <span class="comment">//first edge</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                temp_vector2 -=temp_vector1; <span class="comment">//second edge</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160; </div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, temp_vector2 , temp_vector3) ; <span class="comment">//multiplying the 2 edges gives us a normal vector to the element</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector4,vector_normal)&lt;0.0) <span class="comment">//if the signs do not match then they have opposite directions</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    temp_int= TriangleNodesArray[2];</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    TriangleNodesArray[2] =  TriangleNodesArray[1];</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                    TriangleNodesArray[1] =  temp_int;              <span class="comment">//we switch 2 nodes and ready</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160; </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                <span class="comment">//generate new Elements</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geom(</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[0]),</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[1]),</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[2])</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                );</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1+first_element, geom, properties); <span class="comment">//creating the element using the reference element. notice we are using the first element to avoid overriting nodes created by other cutting planes</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                ++number_of_triangles;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=4; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>) TriangleNodesArray[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=3; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>)</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                    Coord_Node_1[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    Coord_Node_2[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    Coord_Node_3[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                    Coord_Node_4[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                    vector_max[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                    vector_min[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                    vector_normal[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            }<span class="comment">//closing if elems_in_plane==6 (1 triangle)</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="keywordflow">if</span> (Elems_In_Isosurface[current_element-1] == 2)  <span class="comment">//now we have 2 elements. we cant just create 2 elements with a random node order because they might overlap and not cover the whole area defined by the trapezoid</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                <span class="comment">//to fix this we&#39;ll first create a plane. see below</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                <span class="comment">//checking conectivities to find nodes</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++) <span class="comment">//node i</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++) <span class="comment">//node j</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        new_node= <span class="keyword">true</span>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                        <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>=0; <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>!=3; ++<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                        {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                            <span class="keywordflow">if</span>(TriangleNodesArray[<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>]==Coord(index_i, index_j) || Coord(index_i, index_j) &lt; 1 )  <span class="comment">//same as the part with only one triangle (look above)</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                            {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                                new_node=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                            }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        <span class="keywordflow">if</span> (new_node &amp;&amp; index_i&lt;index_j)</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                            TriangleNodesArray[triangle_nodes]=Coord(index_i, index_j) ;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                            triangle_nodes++;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                        }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                        <span class="keywordflow">if</span> (triangle_nodes ==4) <span class="keywordflow">break</span>;               <span class="comment">//once we&#39;ve found the 4 nodes we can exit</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                    } <span class="comment">//closing i loop</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                    <span class="keywordflow">if</span> (triangle_nodes ==4) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                <span class="comment">//now we have to start checking the angles. the easiest way (i think) is creating a new plane using the original plane and a segment created by 2 nodes</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="comment">// using crossproduct we get a perpendicular plane. (either point can be used as origin).</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                <span class="comment">//since the cuadrilateral is created by the cut of teatraedra,</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="comment">//none of its internal angles can exceed 180 degrees and hence our new plane divides the cuadrilateral into 2 triangles if the distances to the other points have different signs (one on top and the other on the bottom of this new plane)</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <span class="comment">//otherwise this edge is just an edge of the cuadrilateral and we have to look for another.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                <span class="comment">//so let&#39;s begin! (we&#39;ll keep an origin node and we&#39;ll loop different nodes as the end of the segment till we find one that satisfies our criteria)</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                    node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    Coord_Node[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    Coord_Node[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    Coord_Node[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 0) Coord_Node_1 = Coord_Node;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 1) Coord_Node_2 = Coord_Node;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 2) Coord_Node_3 = Coord_Node;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 3) Coord_Node_4 = Coord_Node;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &gt;= node_value[1] &amp;&amp; node_value[0] &gt;= node_value[2] &amp;&amp; node_value[0] &gt;= node_value[3]) vector_max=Coord_Node_1;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &gt; node_value[0] &amp;&amp; node_value[1] &gt; node_value[2] &amp;&amp; node_value[1] &gt; node_value[3]) vector_max=Coord_Node_2;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &gt; node_value[0] &amp;&amp; node_value[2] &gt; node_value[1] &amp;&amp; node_value[2] &gt; node_value[3]) vector_max=Coord_Node_3;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &gt; node_value[0] &amp;&amp; node_value[3] &gt; node_value[1] &amp;&amp; node_value[3] &gt; node_value[2]) vector_max=Coord_Node_4;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &lt; node_value[1] &amp;&amp; node_value[0] &lt; node_value[2] &amp;&amp; node_value[0] &lt; node_value[3]) vector_min=Coord_Node_1;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &lt; node_value[0] &amp;&amp; node_value[1] &lt; node_value[2] &amp;&amp; node_value[1] &lt; node_value[3]) vector_min=Coord_Node_2;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &lt; node_value[0] &amp;&amp; node_value[2] &lt; node_value[1] &amp;&amp; node_value[2] &lt; node_value[3]) vector_min=Coord_Node_3;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &lt;= node_value[0] &amp;&amp; node_value[3] &lt;= node_value[1] &amp;&amp; node_value[3] &lt;= node_value[2]) vector_min=Coord_Node_4;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                vector_normal = vector_max - vector_min;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                ModelPart::NodesContainerType::iterator it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[0]);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = it_node1-&gt;Coordinates(); <span class="comment">//nodo 1 (origin)</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                <span class="keywordtype">int</span> jjj;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                <span class="keywordtype">int</span> kkk;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iii=1; iii!=4; ++iii)    <span class="comment">//end node of the segment that will be used to create the plane (will be contained too)</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                    it_node1=new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[iii]); <span class="comment">//i node. we always keep node 0 as origin</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = it_node1-&gt;Coordinates(); <span class="comment">//node2 (end)</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = temp_vector2 - temp_vector1; <span class="comment">//segment 1-2</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    <span class="comment">//now i have to create the new plane</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, vector_normal , temp_vector3); <span class="comment">//done. now temp_vector4 is the (normal to the) new plane, perpendicular to the one containing the triangles</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                    <span class="comment">//the origin of the plane is temp_vector1 (temp_vector2 could also be used)</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                    <span class="comment">//now we need to check distances to the other nodes (i+2 (let&#39;s call them jjj and i+3=kkk since we can&#39;t go futher than i=3)</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                    <span class="keywordflow">if</span> (iii==1)</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                    {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                        jjj=2;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                        kkk=3;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                    }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iii==2)</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    {</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                        jjj=3;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                        kkk=1;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                        jjj=2;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                        kkk=1;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    it_node1=new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[jjj]);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = it_node1-&gt;Coordinates(); <span class="comment">//one of the remaining nodes;</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                    it_node1=new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[kkk]);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = it_node1-&gt;Coordinates(); <span class="comment">//the other remaining node;</span></div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160; </div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) -=temp_vector1;   <span class="comment">// minus origin point of the plane</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) -=temp_vector1;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                    dist2= <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector2,temp_vector4);  <span class="comment">// dot product</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                    dist3= <a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector3,temp_vector4);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                    <a class="code" href="../../dd/d7b/namespacecontrol.html">control</a>=dist2*dist3;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                    <span class="comment">//and that&#39;s it. we now have to check if the distance have different signs. to do so we multiply :</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d7b/namespacecontrol.html">control</a>&lt;0.0) <span class="comment">//we have the right one! one node on each side of the plane generated by nodes 0 and iii</span></div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                    {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                        nodes_for_2triang[0] = TriangleNodesArray[0] ;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                        nodes_for_2triang[1] = TriangleNodesArray[jjj];</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                        nodes_for_2triang[2] = TriangleNodesArray[iii]; <span class="comment">//finish first triangle</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                        nodes_for_2triang[3] = TriangleNodesArray[iii];</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                        nodes_for_2triang[4] = TriangleNodesArray[kkk];</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        nodes_for_2triang[5] = TriangleNodesArray[0]; <span class="comment">//finish 2nd triangle</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        <span class="keywordflow">break</span>; <span class="comment">//no need to keep looking, we can exit the loop</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                    } <span class="comment">//closing the if</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                }<span class="comment">//by the time this finishes i should already have TriangleNodesArray</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                <span class="comment">//checking if the normal to our element is oriented correctly, just as we did when we had only 1 triangle (not commented here)</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> index=0 ; index !=2 ; ++index) <span class="comment">//for triangle 1 and 2</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                    ModelPart::NodesContainerType::iterator new_it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+0]);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = new_it_node1-&gt;Coordinates(); <span class="comment">//node 1</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                    ModelPart::NodesContainerType::iterator new_it_node2 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+1]);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = new_it_node2-&gt;Coordinates(); <span class="comment">//node 2</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                    ModelPart::NodesContainerType::iterator new_it_node3 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+2]);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = new_it_node3-&gt;Coordinates(); <span class="comment">//nodo 3</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                    temp_vector3 -=temp_vector1;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                    temp_vector2 -=temp_vector1;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                    <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, temp_vector2 , temp_vector3) ;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector4,vector_normal)&lt;0.0)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                    {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                        temp_int= nodes_for_2triang[index*3+2];</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                        nodes_for_2triang[index*3+2] =  nodes_for_2triang[index*3+1];</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                        nodes_for_2triang[index*3+1] =  temp_int;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                    }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                    <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geom(</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+0]),</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+1]),</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+2])</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                    );</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1+first_element, geom, properties);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160; </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    ++number_of_triangles;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> !=4; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>) TriangleNodesArray[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a> !=3; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                        Coord_Node_1[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                        Coord_Node_2[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                        Coord_Node_3[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                        Coord_Node_4[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                        vector_max[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                        vector_min[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        vector_normal[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                    }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                    <span class="comment">//for (int counter_2=0; counter_2 !=6; ++counter_2) nodes_for_2triang[counter_2]=0;//resetting, just in case</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;                }<span class="comment">//cierro el index</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            }<span class="comment">//closing if elems_in_surface=2</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        }<span class="comment">//closing element loops</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#adf3bc581f95e07da664f6c3dcc24f2d0"> 1207</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#adf3bc581f95e07da664f6c3dcc24f2d0">GenerateElements</a> (<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; this_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <span class="keyword">const</span> boost::numeric::ublas::vector&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 4 &gt;</a> &gt;&amp; Position_Node, vector&lt;int&gt; Elems_In_Isosurface, compressed_matrix&lt;int&gt;&amp; Coord, <a class="code" href="../../d1/d66/class_kratos_1_1_variable.html">Variable</a>&lt;<a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> &gt;&amp; variable, <span class="keywordtype">int</span> surface_number)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector1;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector2;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector3;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector4;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> temp_vector5;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_1;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_2;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_3;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node_4;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_max;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_min;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> vector_normal;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 6 &gt;</a> nodes_for_2triang; <span class="comment">//to be used when there are 2 triangles</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt; array_1d &lt;double, 3 &gt;</a>, 4 &gt; vector_node_value;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 4 &gt;</a> node_value;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> temp_int;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> first_element=0;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements_old = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        ElementsArrayType::iterator it_begin_old = rElements_old.ptr_begin();</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        ElementsArrayType::iterator it_end_old = rElements_old.ptr_end();</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">ElementsArrayType</a>&amp; rElements_new = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>();</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        ElementsArrayType::iterator it_begin_new = rElements_new.ptr_begin();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        ElementsArrayType::iterator it_end_new = rElements_new.ptr_end();</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        boost::numeric::ublas::vector&lt; array_1d&lt;double, 3 &gt; &gt; Coordinate_New_Node;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        Coordinate_New_Node.resize(Position_Node.size());</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160; </div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">if</span> (first_cutting_surface == <span class="keyword">false</span>)  <span class="comment">//it means this is not the first surface that has to be created</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            first_element=(it_end_new-it_begin_new);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;New Cutting Surface&quot;</span>)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(first_element)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            first_element=0;                      <span class="comment">//or we&#39;re creating the first elements of the model part</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;First Cutting Surface&quot;</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html">Condition</a> <span class="keyword">const</span>&amp; rReferenceCondition = <a class="code" href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">KratosComponents&lt;Condition&gt;::Get</a>(<span class="stringliteral">&quot;SurfaceCondition3D3N&quot;</span>);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        Properties::Pointer properties = this_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">GetMesh</a>().<a class="code" href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">pGetProperties</a>(surface_number);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordtype">int</span> number_of_triangles =  0;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordtype">int</span> current_element= 0;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> triangle_nodes= 0;  <span class="comment">// number of nodes already saved (of the current element)</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordtype">bool</span> new_node = false ; <span class="comment">//used to check whether the current node has been saved or not</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;int, 4 &gt;</a> TriangleNodesArray; <span class="comment">//nodes of the element to be generated. 4 in case they&#39;re 2 triangles</span></div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>=0; <a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>!=4; ++<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>) TriangleNodesArray[<a class="code" href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">k</a>] = -1; <span class="comment">//initializing in -1, meaning we have no nodes yet</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">for</span> (ElementsArrayType::iterator it = it_begin_old; it != it_end_old; ++it)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            ++current_element;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;            triangle_nodes = 0; <span class="comment">//starting, no nodes yet</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keywordflow">if</span> (Elems_In_Isosurface[current_element-1] == 1 ) <span class="comment">//do not forget than can be both 1 or 2 triangles per tetrahedra. this is the simplest case. no need to check anything, we just create an element with the 3 nodes</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                <span class="comment">//checking element conectivities</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                {</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry(); <span class="comment">//i node of the element</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++) <span class="comment">//j node of the element</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                    {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                        new_node= <span class="keyword">true</span>; <span class="comment">//by default it&#39;s a new node</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                        <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;     <span class="comment">//i node id</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                        <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>=0; <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>!=3; ++<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>)</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                        {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                            <span class="keywordflow">if</span>(TriangleNodesArray[<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>]==Coord(index_i, index_j) || Coord(index_i, index_j) &lt;1 ) new_node=<span class="keyword">false</span>; <span class="comment">//if we have already saved this node or it has not been cutted, then we have no new node to add (coord(i,j)=-1)</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                        }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                        <span class="keywordflow">if</span> (new_node &amp;&amp; index_i&lt;=index_j)  <span class="comment">//if it&#39;s a new node and the indexes are correct:</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                        {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                            TriangleNodesArray[triangle_nodes]=Coord(index_i, index_j) ;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                            triangle_nodes++;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                        }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                        <span class="keywordflow">if</span> (triangle_nodes ==3) <span class="keywordflow">break</span>;               <span class="comment">//if we have already found 3 nodes then we can exit</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                    } <span class="comment">//closing j node loop</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                    <span class="keywordflow">if</span> (triangle_nodes ==3) <span class="keywordflow">break</span>;               <span class="comment">//egal</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                } <span class="comment">//closing i node loop</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                <span class="comment">//now we have to check that the normal of the element is in the direction of the gradient of the scalar field. To do this the value of the variable in all the nodes of the element of the old model part is evaluated. With the biggest and the smallest values a vector between those coordinates is calculated. The inner product of that vector and the normal vector of the element should be positive.</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                    vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                    node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = sqrt((vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0]) + (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1]) + (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2]));</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                    Coord_Node[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                    Coord_Node[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                    Coord_Node[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 0)</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                    {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                        Coord_Node_1 = Coord_Node;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                    }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 1)</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                    {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                        Coord_Node_2 = Coord_Node;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                    }</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 2)</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                    {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                        Coord_Node_3 = Coord_Node;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                    }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 3)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                    {</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                        Coord_Node_4 = Coord_Node;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                    }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &gt;= node_value[1] &amp;&amp; node_value[0] &gt;= node_value[2] &amp;&amp; node_value[0] &gt;= node_value[3]) vector_max=Coord_Node_1;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &gt; node_value[0] &amp;&amp; node_value[1] &gt; node_value[2] &amp;&amp; node_value[1] &gt; node_value[3]) vector_max=Coord_Node_2;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &gt; node_value[0] &amp;&amp; node_value[2] &gt; node_value[1] &amp;&amp; node_value[2] &gt; node_value[3]) vector_max=Coord_Node_3;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &gt; node_value[0] &amp;&amp; node_value[3] &gt; node_value[1] &amp;&amp; node_value[3] &gt; node_value[2]) vector_max=Coord_Node_4;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &lt; node_value[1] &amp;&amp; node_value[0] &lt; node_value[2] &amp;&amp; node_value[0] &lt; node_value[3]) vector_min=Coord_Node_1;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &lt; node_value[0] &amp;&amp; node_value[1] &lt; node_value[2] &amp;&amp; node_value[1] &lt; node_value[3]) vector_min=Coord_Node_2;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &lt; node_value[0] &amp;&amp; node_value[2] &lt; node_value[1] &amp;&amp; node_value[2] &lt; node_value[3]) vector_min=Coord_Node_3;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &lt;= node_value[0] &amp;&amp; node_value[3] &lt;= node_value[1] &amp;&amp; node_value[3] &lt;= node_value[2]) vector_min=Coord_Node_4;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                vector_normal = vector_max - vector_min;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                ModelPart::NodesContainerType::iterator new_it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[0]);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = new_it_node1-&gt;Coordinates(); <span class="comment">//node 1</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                ModelPart::NodesContainerType::iterator new_it_node2 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[1]);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = new_it_node2-&gt;Coordinates(); <span class="comment">//node 2</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                ModelPart::NodesContainerType::iterator new_it_node3 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(TriangleNodesArray[2]);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = new_it_node3-&gt;Coordinates(); <span class="comment">//nodo 3</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                temp_vector3 -=temp_vector1; <span class="comment">//first edge</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                temp_vector2 -=temp_vector1; <span class="comment">//second edge</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, temp_vector2 , temp_vector3) ; <span class="comment">//multiplying the 2 edges gives us a normal vector to the element</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector4,vector_normal)&lt;0.0) <span class="comment">//if the signs do not match then they have opposite directions</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                    temp_int= TriangleNodesArray[2];</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                    TriangleNodesArray[2] =  TriangleNodesArray[1];</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                    TriangleNodesArray[1] =  temp_int;              <span class="comment">//we switch 2 nodes and ready</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                <span class="comment">//generate new Elements</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geom(</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[0]),</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[1]),</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(TriangleNodesArray[2])</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                );</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1+first_element, geom, properties); <span class="comment">//creating the element using the reference element. notice we are using the first element to avoid overriting nodes created by other cutting planes</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                ++number_of_triangles;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=4; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>) TriangleNodesArray[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=3; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>)</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                    Coord_Node_1[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                    Coord_Node_2[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                    Coord_Node_3[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                    Coord_Node_4[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                    vector_max[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                    vector_min[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                    vector_normal[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            }<span class="comment">//closing if elems_in_plane==6 (1 triangle)</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            <span class="keywordflow">if</span> (Elems_In_Isosurface[current_element-1] == 2)  <span class="comment">//now we have 2 elements. we cant just create 2 elements with a random node order because they might overlap and not cover the whole area defined by the trapezoid</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                <span class="comment">//to fix this we&#39;ll first create a plane. see below</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                <span class="comment">//checking conectivities to find nodes</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++) <span class="comment">//node i</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> = 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++) <span class="comment">//node j</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                    {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                        new_node= <span class="keyword">true</span>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                        <span class="keywordtype">int</span> index_i = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                        <span class="keywordtype">int</span> index_j = geom[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>].<a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Id</a>() - 1;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>=0; <a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>!=3; ++<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>)</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                        {</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                            <span class="keywordflow">if</span>(TriangleNodesArray[<a class="code" href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">l</a>]==Coord(index_i, index_j) || Coord(index_i, index_j) &lt; 1 ) new_node=<span class="keyword">false</span>; <span class="comment">//same as the part with only one triangle (look above)</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                        }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                        <span class="keywordflow">if</span> (new_node &amp;&amp; index_i&lt;index_j)</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                        {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                            TriangleNodesArray[triangle_nodes]=Coord(index_i, index_j) ;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                            triangle_nodes++;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                        }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        <span class="keywordflow">if</span> (triangle_nodes ==4) <span class="keywordflow">break</span>;               <span class="comment">//once we&#39;ve found the 4 nodes we can exit</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                    } <span class="comment">//closing i loop</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                    <span class="keywordflow">if</span> (triangle_nodes ==4) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                <span class="comment">//now we have to start checking the angles. the easiest way (i think) is creating a new plane using the original plane and a segment created by 2 nodes</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                <span class="comment">// using crossproduct we get a perpendicular plane. (either point can be used as origin).</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                <span class="comment">//since the cuadrilateral is created by the cut of teatraedra,</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                <span class="comment">//none of its internal angles can exceed 180 degrees and hence our new plane divides the cuadrilateral into 2 triangles if the distances to the other points have different signs (one on top and the other on the bottom of this new plane)</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                <span class="comment">//otherwise this edge is just an edge of the cuadrilateral and we have to look for another.</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                <span class="comment">//so let&#39;s begin! (we&#39;ll keep an origin node and we&#39;ll loop different nodes as the end of the segment till we find one that satisfies our criteria)</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                <span class="keywordtype">int</span> jjj;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                <span class="keywordtype">int</span> kkk;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iii=1; iii!=4; ++iii)    <span class="comment">//end node of the segment that will be used to create the plane (will be contained too)</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                {</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                    <span class="keywordflow">if</span> (iii==1)</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                    {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                        jjj=2;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                        kkk=3;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iii==2)</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                    {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                        jjj=3;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                        kkk=1;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                    }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    {</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                        jjj=2;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                        kkk=1;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                    nodes_for_2triang[0] = TriangleNodesArray[0] ;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                    nodes_for_2triang[1] = TriangleNodesArray[jjj];</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                    nodes_for_2triang[2] = TriangleNodesArray[iii]; <span class="comment">//finish first triangle</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                    nodes_for_2triang[3] = TriangleNodesArray[iii];</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                    nodes_for_2triang[4] = TriangleNodesArray[kkk];</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                    nodes_for_2triang[5] = TriangleNodesArray[0]; <span class="comment">//finish 2nd triangle</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                }<span class="comment">//by the time this finishes i should already have TriangleNodesArray</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> = 0; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> &lt; it-&gt;GetGeometry().size() ; <a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>++)          <span class="comment">//size = 4 ; nodes per element. NOTICE WE&#39;LL BE LOOPING THE EDGES TWICE. THIS IS A WASTE OF TIME BUT MAKES IT EASIER TO IDENTITY ELEMENTS. LOOK BELOW.</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                    <a class="code" href="../../dc/dea/class_kratos_1_1_geometry.html">Geometry&lt;Node &gt;</a>&amp;geom = it-&gt;GetGeometry();</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                    vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].FastGetSolutionStepValue(variable);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                    node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>] = sqrt((vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][0]) + (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][1]) + (vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2] * vector_node_value[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>][2]));</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160; </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                    Coord_Node[0] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].X();</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;                    Coord_Node[1] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Y();</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                    Coord_Node[2] = geom[<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a>].Z();</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 0) Coord_Node_1 = Coord_Node;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 1) Coord_Node_2 = Coord_Node;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 2) Coord_Node_3 = Coord_Node;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">i</a> == 3) Coord_Node_4 = Coord_Node;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &gt;= node_value[1] &amp;&amp; node_value[0] &gt;= node_value[2] &amp;&amp; node_value[0] &gt;= node_value[3]) vector_max=Coord_Node_1;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &gt; node_value[0] &amp;&amp; node_value[1] &gt; node_value[2] &amp;&amp; node_value[1] &gt; node_value[3]) vector_max=Coord_Node_2;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &gt; node_value[0] &amp;&amp; node_value[2] &gt; node_value[1] &amp;&amp; node_value[2] &gt; node_value[3]) vector_max=Coord_Node_3;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &gt; node_value[0] &amp;&amp; node_value[3] &gt; node_value[1] &amp;&amp; node_value[3] &gt; node_value[2]) vector_max=Coord_Node_4;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160; </div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                <span class="keywordflow">if</span> (node_value[0] &lt; node_value[1] &amp;&amp; node_value[0] &lt; node_value[2] &amp;&amp; node_value[0] &lt; node_value[3]) vector_min=Coord_Node_1;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                <span class="keywordflow">if</span> (node_value[1] &lt; node_value[0] &amp;&amp; node_value[1] &lt; node_value[2] &amp;&amp; node_value[1] &lt; node_value[3]) vector_min=Coord_Node_2;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                <span class="keywordflow">if</span> (node_value[2] &lt; node_value[0] &amp;&amp; node_value[2] &lt; node_value[1] &amp;&amp; node_value[2] &lt; node_value[3]) vector_min=Coord_Node_3;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                <span class="keywordflow">if</span> (node_value[3] &lt;= node_value[0] &amp;&amp; node_value[3] &lt;= node_value[1] &amp;&amp; node_value[3] &lt;= node_value[2]) vector_min=Coord_Node_4;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                vector_normal = vector_max - vector_min;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                <span class="comment">//checking if the normal to our element is oriented correctly, just as we did when we had only 1 triangle (not commented here)</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> index=0 ; index !=2 ; ++index) <span class="comment">//for triangle 1 and 2</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                    ModelPart::NodesContainerType::iterator new_it_node1 =  new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+0]);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector1) = new_it_node1-&gt;Coordinates(); <span class="comment">//node 1</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                    ModelPart::NodesContainerType::iterator new_it_node2 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+1]);</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector2) = new_it_node2-&gt;Coordinates(); <span class="comment">//node 2</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                    ModelPart::NodesContainerType::iterator new_it_node3 = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().find(nodes_for_2triang[index*3+2]);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                    <a class="code" href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">noalias</a>(temp_vector3) = new_it_node3-&gt;Coordinates(); <span class="comment">//nodo 3</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                    temp_vector3 -=temp_vector1;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                    temp_vector2 -=temp_vector1;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                    <a class="code" href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">MathUtils&lt;double&gt;::CrossProduct</a>(temp_vector4, temp_vector2 , temp_vector3) ;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">inner_prod</a>(temp_vector4,vector_normal)&lt;0.0)</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;                    {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                        temp_int= nodes_for_2triang[index*3+2];</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                        nodes_for_2triang[index*3+2] =  nodes_for_2triang[index*3+1];</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                        nodes_for_2triang[index*3+1] =  temp_int;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                    }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                    <a class="code" href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Triangle3D3&lt;Node &gt;</a> geom(</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+0]),</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+1]),</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;                        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>()(nodes_for_2triang[index*3+2])</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                    );</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                    Condition::Pointer p_condition = rReferenceCondition.<a class="code" href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Create</a>(number_of_triangles+1+first_element, geom, properties);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                    new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().push_back(p_condition);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                    ++number_of_triangles;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=4; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>) TriangleNodesArray[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>=0; <a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>!=3; ++<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                        Coord_Node_1[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                        Coord_Node_2[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                        Coord_Node_3[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                        Coord_Node_4[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                        vector_max[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                        vector_min[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                        vector_normal[<a class="code" href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">counter</a>]=0;<span class="comment">//resetting, just in case</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                    }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                    <span class="comment">//for (int counter_2=0; counter_2!=6; ++counter_2) nodes_for_2triang[counter_2]=0;//resetting, just in case</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                }<span class="comment">//cierro el index</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            }<span class="comment">//closing if elems_in_surface=2</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        }<span class="comment">//closing element loops</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    }</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#aec676120ba91dad9f5418ec9da72c3d3"> 1527</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#aec676120ba91dad9f5418ec9da72c3d3">UpdateCutData</a>( <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part, <a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; old_model_part)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Updating Cut Data&quot;</span>);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="keywordtype">int</span> step_data_size = old_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a23d16a9ecf3f68f5f7bcdc1c50146b36">GetNodalSolutionStepDataSize</a>();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        <a class="code" href="../../d4/ddc/class_kratos_1_1array__1d.html">array_1d&lt;double, 3 &gt;</a> Coord_Node;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="comment">//looping the nodes, no data is assigned to elements</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        <span class="keywordflow">for</span> (ModelPart::NodesContainerType::iterator it = new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">NodesBegin</a>(); it != new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#adddcc5bbc4b0acc4aeb81953d900c42a">NodesEnd</a>(); it++)</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordtype">double</span>* node0_data = it-&gt;GetValue(FATHER_NODES)[0].SolutionStepData().Data(0); <span class="comment">//current step only, (since we&#39;ll call this every timestep</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <span class="keywordtype">double</span>* node1_data = it-&gt;GetValue(FATHER_NODES)[1].SolutionStepData().Data(0);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <span class="keywordtype">double</span>    weight   = it-&gt;GetValue(WEIGHT_FATHER_NODES);</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="keywordtype">double</span>* step_data = (it)-&gt;SolutionStepData().Data(0);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="comment">//now we only have to copy the information from node_data to step_data</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>= 0; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>&lt; step_data_size; <a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>++)  <span class="comment">//looping all the variables and interpolating using weight</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                step_data[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] = (1.0-weight)*node0_data[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>] + weight*node1_data[<a class="code" href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">j</a>];</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        }<span class="comment">//closing node loop</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    }<span class="comment">//closing subroutine</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"><a class="line" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ab8eec4240bb1049bb9624b0a161baa3f"> 1556</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ab8eec4240bb1049bb9624b0a161baa3f">DeleteCutData</a>(<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html">ModelPart</a>&amp; new_model_part)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <a class="code" href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a>(<span class="stringliteral">&quot;Deleting Cut Data&quot;</span>);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Nodes</a>().clear();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Conditions</a>().clear();</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        new_model_part.<a class="code" href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Elements</a>().clear();</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordtype">bool</span> first_cutting_surface; <span class="comment">// to avoid checking again if we&#39;re working on the new cutting surface or if some have already been created</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;};</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;}</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclass_kratos_1_1_condition_html"><div class="ttname"><a href="../../d1/d6e/class_kratos_1_1_condition.html">Kratos::Condition</a></div><div class="ttdoc">Base class for all Conditions.</div><div class="ttdef"><b>Definition:</b> condition.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_condition_html_a0c821c1542b62403c675b4dd16cc74c9"><div class="ttname"><a href="../../d1/d6e/class_kratos_1_1_condition.html#a0c821c1542b62403c675b4dd16cc74c9">Kratos::Condition::Create</a></div><div class="ttdeci">virtual Pointer Create(IndexType NewId, NodesArrayType const &amp;ThisNodes, PropertiesType::Pointer pProperties) const</div><div class="ttdoc">It creates a new condition pointer.</div><div class="ttdef"><b>Definition:</b> condition.h:205</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html">Kratos::Cutting_Isosurface_Application</a></div><div class="ttdoc">CUTTING ISOSURFACE APPLICATION.</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:53</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a079b6104f78476d701a12c728f662559"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a079b6104f78476d701a12c728f662559">Kratos::Cutting_Isosurface_Application::PointType</a></div><div class="ttdeci">Node PointType</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:64</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a1c0f3c7413a284869a5c66137d21342c"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a1c0f3c7413a284869a5c66137d21342c">Kratos::Cutting_Isosurface_Application::PointPointerType</a></div><div class="ttdeci">Node ::Pointer PointPointerType</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:65</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a2ca92ded31f362c0a8cfd641d1126b48"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2ca92ded31f362c0a8cfd641d1126b48">Kratos::Cutting_Isosurface_Application::Create_List_Of_New_Nodes_Mod</a></div><div class="ttdeci">void Create_List_Of_New_Nodes_Mod(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, compressed_matrix&lt; int &gt; &amp;Coord, boost::numeric::ublas::vector&lt; int &gt; &amp;List_New_Nodes, boost::numeric::ublas::vector&lt; array_1d&lt; int, 2 &gt; &gt; &amp;Position_Node)</div><div class="ttdoc">‍************************************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:610</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a2d6c95d1995110ae59c14d7c03d58c51"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a2d6c95d1995110ae59c14d7c03d58c51">Kratos::Cutting_Isosurface_Application::ConditionsArrayType</a></div><div class="ttdeci">ModelPart::ConditionsContainerType ConditionsArrayType</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:60</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a383eeeaa6198818fe8e86986be49357b"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a383eeeaa6198818fe8e86986be49357b">Kratos::Cutting_Isosurface_Application::AddSkinConditions</a></div><div class="ttdeci">void AddSkinConditions(ModelPart &amp;mr_model_part, ModelPart &amp;mr_new_model_part, int number)</div><div class="ttdoc">ADDSKINCONDITIONS: THIS FUNCTION ADDS TO THE NEW MODEL PART THE DATA OF THE CONDITIONS BELONGING TO T...</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:226</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a3d777b63a5567e97399a2e798f9b32a3"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a3d777b63a5567e97399a2e798f9b32a3">Kratos::Cutting_Isosurface_Application::NodesArrayType</a></div><div class="ttdeci">ModelPart::NodesContainerType NodesArrayType</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:58</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a5c32bddb7c13a9c76df9c26722ece2cf"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a5c32bddb7c13a9c76df9c26722ece2cf">Kratos::Cutting_Isosurface_Application::FirstLoop</a></div><div class="ttdeci">void FirstLoop(ModelPart &amp;this_model_part, compressed_matrix&lt; int &gt; &amp;Coord, Variable&lt; double &gt; &amp;variable, double isovalue, int number_of_triangles, vector&lt; int &gt; &amp;Elems_In_Isosurface, float tolerance)</div><div class="ttdoc">‍************************************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:367</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a6bb0e71a15665cdbe10f9bc24294278f"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a6bb0e71a15665cdbe10f9bc24294278f">Kratos::Cutting_Isosurface_Application::CSR_Row_Matrix_Mod</a></div><div class="ttdeci">void CSR_Row_Matrix_Mod(ModelPart &amp;this_model_part, compressed_matrix&lt; int &gt; &amp;Coord)</div><div class="ttdoc">LIST OF SUBROUTINES.</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:331</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a71fa8a00fd01dfe2f71525b849956067"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a71fa8a00fd01dfe2f71525b849956067">Kratos::Cutting_Isosurface_Application::Cutting_Isosurface_Application</a></div><div class="ttdeci">Cutting_Isosurface_Application()=default</div><div class="ttdoc">Default constructor.</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a7d3251816b1ed3e6b6f93655c410363f"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a7d3251816b1ed3e6b6f93655c410363f">Kratos::Cutting_Isosurface_Application::Node_Vector_Order_Tensor</a></div><div class="ttdeci">boost::numeric::ublas::vector&lt; Vector_Order_Tensor &gt; Node_Vector_Order_Tensor</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:63</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a98a3380b634031a5e1addeb63003122b"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a98a3380b634031a5e1addeb63003122b">Kratos::Cutting_Isosurface_Application::Calculate_Coordinate_And_Insert_New_Nodes_Mod</a></div><div class="ttdeci">void Calculate_Coordinate_And_Insert_New_Nodes_Mod(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, const boost::numeric::ublas::vector&lt; array_1d&lt; int, 2 &gt; &gt; &amp;Position_Node, const boost::numeric::ublas::vector&lt; int &gt; &amp;List_New_Nodes, Variable&lt; double &gt; &amp;variable, double isovalue, float tolerance)</div><div class="ttdoc">‍************************************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:676</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a9ac5e1262d1e0e4735713c442095816a"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9ac5e1262d1e0e4735713c442095816a">Kratos::Cutting_Isosurface_Application::ElementsArrayType</a></div><div class="ttdeci">ModelPart::ElementsContainerType ElementsArrayType</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_a9b2c5b2a02c3fd58a2dc7df27c28a327"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#a9b2c5b2a02c3fd58a2dc7df27c28a327">Kratos::Cutting_Isosurface_Application::AddModelPartElements</a></div><div class="ttdeci">void AddModelPartElements(ModelPart &amp;mr_model_part, ModelPart &amp;mr_new_model_part, int number)</div><div class="ttdoc">ADDMODELPARTELEMENTS: THIS FUNCTION ADDS TO THE NEW MODEL PART THE DATA BELONGING TO THE OLD MODEL PA...</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:136</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_aad62b42f465cb2508901c9d18601d976"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#aad62b42f465cb2508901c9d18601d976">Kratos::Cutting_Isosurface_Application::Matrix_Order_Tensor</a></div><div class="ttdeci">boost::numeric::ublas::vector&lt; Matrix &gt; Matrix_Order_Tensor</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:61</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_ab8eec4240bb1049bb9624b0a161baa3f"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ab8eec4240bb1049bb9624b0a161baa3f">Kratos::Cutting_Isosurface_Application::DeleteCutData</a></div><div class="ttdeci">void DeleteCutData(ModelPart &amp;new_model_part)</div><div class="ttdoc">DELETECUTDATA: THIS FUNCTION DELETES THE MESH FROM THE PREVIOUS TIME STEP.</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:1556</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_abcfba4977af9b9fbab2447acf5f911ca"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#abcfba4977af9b9fbab2447acf5f911ca">Kratos::Cutting_Isosurface_Application::PointVector</a></div><div class="ttdeci">std::vector&lt; PointType::Pointer &gt; PointVector</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:66</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_acaec87dd22b1590d7e9ee75adaa7416c"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acaec87dd22b1590d7e9ee75adaa7416c">Kratos::Cutting_Isosurface_Application::GenerateElements</a></div><div class="ttdeci">void GenerateElements(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, const boost::numeric::ublas::vector&lt; array_1d&lt; int, 4 &gt; &gt; &amp;Position_Node, vector&lt; int &gt; Elems_In_Isosurface, compressed_matrix&lt; int &gt; &amp;Coord, Variable&lt; double &gt; &amp;variable, int surface_number)</div><div class="ttdoc">‍************************************************************************************************</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:861</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_acf08d1646f23d79c629dd7699edb0e30"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#acf08d1646f23d79c629dd7699edb0e30">Kratos::Cutting_Isosurface_Application::Calculate_Coordinate_And_Insert_New_Nodes_Mod</a></div><div class="ttdeci">void Calculate_Coordinate_And_Insert_New_Nodes_Mod(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, const boost::numeric::ublas::vector&lt; array_1d&lt; int, 2 &gt; &gt; &amp;Position_Node, const boost::numeric::ublas::vector&lt; int &gt; &amp;List_New_Nodes, Variable&lt; array_1d&lt; double, 3 &gt; &gt; &amp;variable, double isovalue, float tolerance)</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:743</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_adbc3f6e309548bcb63065b4348b0b5c3"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#adbc3f6e309548bcb63065b4348b0b5c3">Kratos::Cutting_Isosurface_Application::~Cutting_Isosurface_Application</a></div><div class="ttdeci">virtual ~Cutting_Isosurface_Application()=default</div><div class="ttdoc">Destructor.</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_adf3bc581f95e07da664f6c3dcc24f2d0"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#adf3bc581f95e07da664f6c3dcc24f2d0">Kratos::Cutting_Isosurface_Application::GenerateElements</a></div><div class="ttdeci">void GenerateElements(ModelPart &amp;this_model_part, ModelPart &amp;new_model_part, const boost::numeric::ublas::vector&lt; array_1d&lt; int, 4 &gt; &gt; &amp;Position_Node, vector&lt; int &gt; Elems_In_Isosurface, compressed_matrix&lt; int &gt; &amp;Coord, Variable&lt; array_1d&lt; double, 3 &gt; &gt; &amp;variable, int surface_number)</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:1207</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_ae0d144c2c81c3efd516e9c9afa323008"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae0d144c2c81c3efd516e9c9afa323008">Kratos::Cutting_Isosurface_Application::Vector_Order_Tensor</a></div><div class="ttdeci">boost::numeric::ublas::vector&lt; Vector &gt; Vector_Order_Tensor</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:62</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_ae62da93cee3398ae22506f92bcd9a25d"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae62da93cee3398ae22506f92bcd9a25d">Kratos::Cutting_Isosurface_Application::FirstLoop</a></div><div class="ttdeci">void FirstLoop(ModelPart &amp;this_model_part, compressed_matrix&lt; int &gt; &amp;Coord, Variable&lt; array_1d&lt; double, 3 &gt; &gt; &amp;variable, double isovalue, int number_of_triangles, vector&lt; int &gt; &amp;Elems_In_Isosurface, float tolerance)</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:461</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_ae8c09487c6548d175c3a53c63024e0e4"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#ae8c09487c6548d175c3a53c63024e0e4">Kratos::Cutting_Isosurface_Application::GenerateVariableCut</a></div><div class="ttdeci">void GenerateVariableCut(ModelPart &amp;mr_model_part, ModelPart &amp;mr_new_model_part, Variable&lt; TDataType &gt; &amp;variable, double isovalue, int isosurface_number, float tolerance)</div><div class="ttdoc">This function Creates cutting isosurfaces by creating nodes and conditions (to define the conectiviti...</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:92</div></div>
<div class="ttc" id="aclass_kratos_1_1_cutting___isosurface___application_html_aec676120ba91dad9f5418ec9da72c3d3"><div class="ttname"><a href="../../d5/d41/class_kratos_1_1_cutting___isosurface___application.html#aec676120ba91dad9f5418ec9da72c3d3">Kratos::Cutting_Isosurface_Application::UpdateCutData</a></div><div class="ttdeci">void UpdateCutData(ModelPart &amp;new_model_part, ModelPart &amp;old_model_part)</div><div class="ttdoc">UPDATECUTDATA: THIS FUNCTION UPDATES THE DATA OF THE NEW MODEL PART READING FROM THE DATA OF THE FATH...</div><div class="ttdef"><b>Definition:</b> cutting_iso_app.h:1527</div></div>
<div class="ttc" id="aclass_kratos_1_1_element_html"><div class="ttname"><a href="../../d5/dd4/class_kratos_1_1_element.html">Kratos::Element</a></div><div class="ttdoc">Base class for all Elements.</div><div class="ttdef"><b>Definition:</b> element.h:60</div></div>
<div class="ttc" id="aclass_kratos_1_1_element_html_a9d3fcc73aa43b460715466d283803b61"><div class="ttname"><a href="../../d5/dd4/class_kratos_1_1_element.html#a9d3fcc73aa43b460715466d283803b61">Kratos::Element::Create</a></div><div class="ttdeci">virtual Pointer Create(IndexType NewId, NodesArrayType const &amp;ThisNodes, PropertiesType::Pointer pProperties) const</div><div class="ttdoc">It creates a new element pointer.</div><div class="ttdef"><b>Definition:</b> element.h:202</div></div>
<div class="ttc" id="aclass_kratos_1_1_geometry_html"><div class="ttname"><a href="../../dc/dea/class_kratos_1_1_geometry.html">Kratos::Geometry&lt; Node &gt;</a></div></div>
<div class="ttc" id="aclass_kratos_1_1_geometry_html_a6a78c4a94b491bfa7e9b79795ad8e42b"><div class="ttname"><a href="../../dc/dea/class_kratos_1_1_geometry.html#a6a78c4a94b491bfa7e9b79795ad8e42b">Kratos::Geometry::Id</a></div><div class="ttdeci">IndexType const  &amp; Id() const</div><div class="ttdoc">Id of this Geometry.</div><div class="ttdef"><b>Definition:</b> geometry.h:964</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html">Kratos::GlobalPointersVector</a></div><div class="ttdoc">This class is a vector which stores global pointers.</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:61</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_a04db5b3969fe3a11463c561a3cae856a"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a04db5b3969fe3a11463c561a3cae856a">Kratos::GlobalPointersVector::iterator</a></div><div class="ttdeci">boost::indirect_iterator&lt; typename TContainerType::iterator &gt; iterator</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:79</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_a599125ad0e25d62480de5e84477b5f20"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#a599125ad0e25d62480de5e84477b5f20">Kratos::GlobalPointersVector::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:221</div></div>
<div class="ttc" id="aclass_kratos_1_1_global_pointers_vector_html_aecf3bbe94f6105274d86e19e7bbe3631"><div class="ttname"><a href="../../d4/dc2/class_kratos_1_1_global_pointers_vector.html#aecf3bbe94f6105274d86e19e7bbe3631">Kratos::GlobalPointersVector::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> global_pointers_vector.h:229</div></div>
<div class="ttc" id="aclass_kratos_1_1_kratos_components_html_adfcf332737a38d483a5e234ac4691390"><div class="ttname"><a href="../../de/d8b/class_kratos_1_1_kratos_components.html#adfcf332737a38d483a5e234ac4691390">Kratos::KratosComponents::Get</a></div><div class="ttdeci">static const TComponentType &amp; Get(const std::string &amp;rName)</div><div class="ttdoc">Retrieves a component with the specified name.</div><div class="ttdef"><b>Definition:</b> kratos_components.h:114</div></div>
<div class="ttc" id="aclass_kratos_1_1_math_utils_html_a3f3809a3e2d5bbf26534499077572992"><div class="ttname"><a href="../../d2/df1/class_kratos_1_1_math_utils.html#a3f3809a3e2d5bbf26534499077572992">Kratos::MathUtils::CrossProduct</a></div><div class="ttdeci">static T CrossProduct(const T &amp;a, const T &amp;b)</div><div class="ttdoc">Performs the vector product of the two input vectors a,b.</div><div class="ttdef"><b>Definition:</b> math_utils.h:807</div></div>
<div class="ttc" id="aclass_kratos_1_1_mesh_html_aac143337e8147241402a40934847e1f5"><div class="ttname"><a href="../../d8/d28/class_kratos_1_1_mesh.html#aac143337e8147241402a40934847e1f5">Kratos::Mesh::pGetProperties</a></div><div class="ttdeci">PropertiesType::Pointer pGetProperties(IndexType PropertiesId)</div><div class="ttdef"><b>Definition:</b> mesh.h:394</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html">Kratos::ModelPart</a></div><div class="ttdoc">This class aims to manage meshes for multi-physics simulations.</div><div class="ttdef"><b>Definition:</b> model_part.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a0960956dac2688d5d72cdb874c450e1d"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a0960956dac2688d5d72cdb874c450e1d">Kratos::ModelPart::ConditionsContainerType</a></div><div class="ttdeci">MeshType::ConditionsContainerType ConditionsContainerType</div><div class="ttdoc">Condintions container. A vector set of Conditions with their Id's as key.</div><div class="ttdef"><b>Definition:</b> model_part.h:183</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a1b106932da453f761af9799eb3b2ae22"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a1b106932da453f761af9799eb3b2ae22">Kratos::ModelPart::CreateNewNode</a></div><div class="ttdeci">NodeType::Pointer CreateNewNode(int Id, double x, double y, double z, VariablesList::Pointer pNewVariablesList, IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.cpp:270</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a23d16a9ecf3f68f5f7bcdc1c50146b36"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a23d16a9ecf3f68f5f7bcdc1c50146b36">Kratos::ModelPart::GetNodalSolutionStepDataSize</a></div><div class="ttdeci">SizeType GetNodalSolutionStepDataSize()</div><div class="ttdef"><b>Definition:</b> model_part.h:571</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a38ea8c8a7a801055130282bb5697a014"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a38ea8c8a7a801055130282bb5697a014">Kratos::ModelPart::ElementsContainerType</a></div><div class="ttdeci">MeshType::ElementsContainerType ElementsContainerType</div><div class="ttdoc">Element container. A vector set of Elements with their Id's as key.</div><div class="ttdef"><b>Definition:</b> model_part.h:168</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a59e727cef5f608c3006f87356bd9bdcd"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a59e727cef5f608c3006f87356bd9bdcd">Kratos::ModelPart::NodesBegin</a></div><div class="ttdeci">NodeIterator NodesBegin(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:487</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a6754ddb1e657c4efba0705a341de0294"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a6754ddb1e657c4efba0705a341de0294">Kratos::ModelPart::Conditions</a></div><div class="ttdeci">ConditionsContainerType &amp; Conditions(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1381</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a71ce386b94d94c11741419d9ca34e87f"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a71ce386b94d94c11741419d9ca34e87f">Kratos::ModelPart::AddNodalSolutionStepVariable</a></div><div class="ttdeci">void AddNodalSolutionStepVariable(VariableData const &amp;ThisVariable)</div><div class="ttdef"><b>Definition:</b> model_part.h:532</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a885a2e1a9dd829e9cc23dad49e8ad72e"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a885a2e1a9dd829e9cc23dad49e8ad72e">Kratos::ModelPart::NodeIterator</a></div><div class="ttdeci">MeshType::NodeIterator NodeIterator</div><div class="ttdef"><b>Definition:</b> model_part.h:134</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_a94dfb23c46340061bd57e9b9c4e317c8"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#a94dfb23c46340061bd57e9b9c4e317c8">Kratos::ModelPart::Elements</a></div><div class="ttdeci">ElementsContainerType &amp; Elements(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1189</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aaa333c3cf58397b76565318e30248e87"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aaa333c3cf58397b76565318e30248e87">Kratos::ModelPart::NodesContainerType</a></div><div class="ttdeci">MeshType::NodesContainerType NodesContainerType</div><div class="ttdoc">Nodes container. Which is a vector set of nodes with their Id's as key.</div><div class="ttdef"><b>Definition:</b> model_part.h:128</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_adddcc5bbc4b0acc4aeb81953d900c42a"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#adddcc5bbc4b0acc4aeb81953d900c42a">Kratos::ModelPart::NodesEnd</a></div><div class="ttdeci">NodeIterator NodesEnd(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:497</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aea4c0a93255ea7669a0c10e185386dc3"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aea4c0a93255ea7669a0c10e185386dc3">Kratos::ModelPart::GetMesh</a></div><div class="ttdeci">MeshType &amp; GetMesh(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:1791</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_aeeaebc841dc1351f20b650c6497d6323"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#aeeaebc841dc1351f20b650c6497d6323">Kratos::ModelPart::Nodes</a></div><div class="ttdeci">NodesContainerType &amp; Nodes(IndexType ThisIndex=0)</div><div class="ttdef"><b>Definition:</b> model_part.h:507</div></div>
<div class="ttc" id="aclass_kratos_1_1_model_part_html_af32f65f012a53e237a2c1aa6b074b5b1"><div class="ttname"><a href="../../d1/d79/class_kratos_1_1_model_part.html#af32f65f012a53e237a2c1aa6b074b5b1">Kratos::ModelPart::GetNodalSolutionStepVariablesList</a></div><div class="ttdeci">VariablesList &amp; GetNodalSolutionStepVariablesList()</div><div class="ttdef"><b>Definition:</b> model_part.h:549</div></div>
<div class="ttc" id="aclass_kratos_1_1_node_html"><div class="ttname"><a href="../../d5/ddd/class_kratos_1_1_node.html">Kratos::Node</a></div><div class="ttdoc">This class defines the node.</div><div class="ttdef"><b>Definition:</b> node.h:65</div></div>
<div class="ttc" id="aclass_kratos_1_1_tetrahedra3_d4_html"><div class="ttname"><a href="../../df/df1/class_kratos_1_1_tetrahedra3_d4.html">Kratos::Tetrahedra3D4</a></div><div class="ttdoc">A four node tetrahedra geometry with linear shape functions.</div><div class="ttdef"><b>Definition:</b> tetrahedra_3d_4.h:59</div></div>
<div class="ttc" id="aclass_kratos_1_1_triangle3_d3_html"><div class="ttname"><a href="../../de/d3e/class_kratos_1_1_triangle3_d3.html">Kratos::Triangle3D3</a></div><div class="ttdoc">A three node 3D triangle geometry with linear shape functions.</div><div class="ttdef"><b>Definition:</b> triangle_3d_3.h:77</div></div>
<div class="ttc" id="aclass_kratos_1_1_variable_html"><div class="ttname"><a href="../../d1/d66/class_kratos_1_1_variable.html">Kratos::Variable</a></div><div class="ttdoc">Variable class contains all information needed to store and retrive data from a data container.</div><div class="ttdef"><b>Definition:</b> variable.h:63</div></div>
<div class="ttc" id="aclass_kratos_1_1array__1d_html"><div class="ttname"><a href="../../d4/ddc/class_kratos_1_1array__1d.html">Kratos::array_1d&lt; double, 4 &gt;</a></div></div>
<div class="ttc" id="aclass_kratos_1_1array__1d_html_a460da1efd1801dc00e9844418fbc6d58"><div class="ttname"><a href="../../d4/ddc/class_kratos_1_1array__1d.html#a460da1efd1801dc00e9844418fbc6d58">Kratos::array_1d::resize</a></div><div class="ttdeci">BOOST_UBLAS_INLINE void resize(size_type array_size, bool preserve=true)</div><div class="ttdef"><b>Definition:</b> array_1d.h:242</div></div>
<div class="ttc" id="adefine_8h_html"><div class="ttname"><a href="../../df/d67/define_8h.html">define.h</a></div></div>
<div class="ttc" id="adefine_8h_html_a5eac541f5e39bf0360a12f51f0248513"><div class="ttname"><a href="../../df/d67/define_8h.html#a5eac541f5e39bf0360a12f51f0248513">KRATOS_CATCH</a></div><div class="ttdeci">#define KRATOS_CATCH(MoreInfo)</div><div class="ttdef"><b>Definition:</b> define.h:110</div></div>
<div class="ttc" id="adefine_8h_html_a6135b00508a42f0e8f91d1369644cbc1"><div class="ttname"><a href="../../df/d67/define_8h.html#a6135b00508a42f0e8f91d1369644cbc1">KRATOS_WATCH</a></div><div class="ttdeci">#define KRATOS_WATCH(variable)</div><div class="ttdef"><b>Definition:</b> define.h:836</div></div>
<div class="ttc" id="adefine_8h_html_ab9c29d6a0d19ff26bbc4e45e3181fb3f"><div class="ttname"><a href="../../df/d67/define_8h.html#ab9c29d6a0d19ff26bbc4e45e3181fb3f">KRATOS_TRY</a></div><div class="ttdeci">#define KRATOS_TRY</div><div class="ttdef"><b>Definition:</b> define.h:109</div></div>
<div class="ttc" id="afind__nodal__neighbours__process_8h_html"><div class="ttname"><a href="../../db/d68/find__nodal__neighbours__process_8h.html">find_nodal_neighbours_process.h</a></div></div>
<div class="ttc" id="amath__utils_8h_html"><div class="ttname"><a href="../../d8/d88/math__utils_8h.html">math_utils.h</a></div></div>
<div class="ttc" id="amodel__part_8h_html"><div class="ttname"><a href="../../dd/dfe/model__part_8h.html">model_part.h</a></div></div>
<div class="ttc" id="anamespace_kratos_1_1_python_html_afdd2f70c75c8e7c828cbab4a370a6d35"><div class="ttname"><a href="../../da/d07/namespace_kratos_1_1_python.html#afdd2f70c75c8e7c828cbab4a370a6d35">Kratos::Python::GetValue</a></div><div class="ttdeci">Parameters GetValue(Parameters &amp;rParameters, const std::string &amp;rEntry)</div><div class="ttdef"><b>Definition:</b> add_kratos_parameters_to_python.cpp:53</div></div>
<div class="ttc" id="anamespace_kratos_html"><div class="ttname"><a href="../../db/d66/namespace_kratos.html">Kratos</a></div><div class="ttdoc">REF: G. R. Cowper, GAUSSIAN QUADRATURE FORMULAS FOR TRIANGLES.</div><div class="ttdef"><b>Definition:</b> mesh_condition.cpp:21</div></div>
<div class="ttc" id="anamespace_kratos_html_a656fecfa2a6cca4ac7b95d43ee8ef0b2"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#a656fecfa2a6cca4ac7b95d43ee8ef0b2">Kratos::inner_prod</a></div><div class="ttdeci">TExpression1Type::data_type inner_prod(AMatrix::MatrixExpression&lt; TExpression1Type, TCategory1 &gt; const &amp;First, AMatrix::MatrixExpression&lt; TExpression2Type, TCategory2 &gt; const &amp;Second)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:592</div></div>
<div class="ttc" id="anamespace_kratos_html_aaff3672cc52b90ee3d84713de272e1b5"><div class="ttname"><a href="../../db/d66/namespace_kratos.html#aaff3672cc52b90ee3d84713de272e1b5">Kratos::noalias</a></div><div class="ttdeci">T &amp; noalias(T &amp;TheMatrix)</div><div class="ttdef"><b>Definition:</b> amatrix_interface.h:484</div></div>
<div class="ttc" id="anamespacecontrol_html"><div class="ttname"><a href="../../dd/d7b/namespacecontrol.html">control</a></div><div class="ttdef"><b>Definition:</b> control.py:1</div></div>
<div class="ttc" id="anamespacegenerate__frictionless__components__mortar__condition_html_ace75554ee1af2aeb69b2a0fc4fb6f8e2"><div class="ttname"><a href="../../d3/d2a/namespacegenerate__frictionless__components__mortar__condition.html#ace75554ee1af2aeb69b2a0fc4fb6f8e2">generate_frictionless_components_mortar_condition.active</a></div><div class="ttdeci">active</div><div class="ttdef"><b>Definition:</b> generate_frictionless_components_mortar_condition.py:175</div></div>
<div class="ttc" id="anamespacegenerate__stokes__twofluid__element_html_abf359962d3066decbbcfdf1ee2b8c1ae"><div class="ttname"><a href="../../d9/d7e/namespacegenerate__stokes__twofluid__element.html#abf359962d3066decbbcfdf1ee2b8c1ae">generate_stokes_twofluid_element.a</a></div><div class="ttdeci">a</div><div class="ttdef"><b>Definition:</b> generate_stokes_twofluid_element.py:77</div></div>
<div class="ttc" id="anamespacegenerate__total__lagrangian__mixed__volumetric__strain__element_html_aa9be8bca3cd4b9f0c16093a9dda89988"><div class="ttname"><a href="../../d7/d33/namespacegenerate__total__lagrangian__mixed__volumetric__strain__element.html#aa9be8bca3cd4b9f0c16093a9dda89988">generate_total_lagrangian_mixed_volumetric_strain_element.b</a></div><div class="ttdeci">b</div><div class="ttdef"><b>Definition:</b> generate_total_lagrangian_mixed_volumetric_strain_element.py:31</div></div>
<div class="ttc" id="anamespacegenerate__weakly__compressible__navier__stokes__element_html_a23c7942c22f11dfd6e96d8df72217656"><div class="ttname"><a href="../../d7/d2b/namespacegenerate__weakly__compressible__navier__stokes__element.html#a23c7942c22f11dfd6e96d8df72217656">generate_weakly_compressible_navier_stokes_element.c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> generate_weakly_compressible_navier_stokes_element.py:108</div></div>
<div class="ttc" id="anamespacehinsberg__optimization_html_a7bc0db444ce9f1806a325d9f1f0ebf08"><div class="ttname"><a href="../../d6/d93/namespacehinsberg__optimization.html#a7bc0db444ce9f1806a325d9f1f0ebf08">hinsberg_optimization.tol</a></div><div class="ttdeci">int tol</div><div class="ttdef"><b>Definition:</b> hinsberg_optimization.py:138</div></div>
<div class="ttc" id="anamespacequadrature_html_a56123f01f0d1e776d9a6d85aa0f27caa"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#a56123f01f0d1e776d9a6d85aa0f27caa">quadrature.k</a></div><div class="ttdeci">int k</div><div class="ttdef"><b>Definition:</b> quadrature.py:595</div></div>
<div class="ttc" id="anamespacequadrature_html_aae897447319c4634b1dcef7634fe5876"><div class="ttname"><a href="../../d7/d2b/namespacequadrature.html#aae897447319c4634b1dcef7634fe5876">quadrature.j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> quadrature.py:648</div></div>
<div class="ttc" id="anamespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t_html_a37fe67255f2e1d30f90f0f02ceb60616"><div class="ttname"><a href="../../d0/daa/namespacescript___t_h_e_r_m_a_l___c_o_r_r_e_c_t.html#a37fe67255f2e1d30f90f0f02ceb60616">script_THERMAL_CORRECT.counter</a></div><div class="ttdeci">int counter</div><div class="ttdef"><b>Definition:</b> script_THERMAL_CORRECT.py:218</div></div>
<div class="ttc" id="anamespacetensors_html_a15a1da80aa773e2015eba781cababe05"><div class="ttname"><a href="../../d2/db8/namespacetensors.html#a15a1da80aa773e2015eba781cababe05">tensors::i</a></div><div class="ttdeci">integer i</div><div class="ttdef"><b>Definition:</b> TensorModule.f:17</div></div>
<div class="ttc" id="anamespacetensors_html_a77b97b9c700f4d4697e0e623ce693eeb"><div class="ttname"><a href="../../d2/db8/namespacetensors.html#a77b97b9c700f4d4697e0e623ce693eeb">tensors::l</a></div><div class="ttdeci">integer l</div><div class="ttdef"><b>Definition:</b> TensorModule.f:17</div></div>
<div class="ttc" id="aspatial__containers_8h_html"><div class="ttname"><a href="../../db/d8f/spatial__containers_8h.html">spatial_containers.h</a></div></div>
<div class="ttc" id="asplit__tetrahedra_8h_html"><div class="ttname"><a href="../../d0/d9c/split__tetrahedra_8h.html">split_tetrahedra.h</a></div></div>
<div class="ttc" id="asplit__triangle_8h_html"><div class="ttname"><a href="../../df/d98/split__triangle_8h.html">split_triangle.h</a></div></div>
<div class="ttc" id="atetrahedra__3d__4_8h_html"><div class="ttname"><a href="../../da/d60/tetrahedra__3d__4_8h.html">tetrahedra_3d_4.h</a></div></div>
<div class="ttc" id="atriangle__3d__3_8h_html"><div class="ttname"><a href="../../d9/def/triangle__3d__3_8h.html">triangle_3d_3.h</a></div></div>
<div class="ttc" id="avariables_8h_html"><div class="ttname"><a href="../../de/dca/variables_8h.html">variables.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 21 2024 02:27:08 for KratosMultiphysics by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
